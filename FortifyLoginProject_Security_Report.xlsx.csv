À§Çèµµ,Æú´õ,´ëºĞ·ù,Ãë¾àÁ¡,À§ÇèÀÎÀÚ ÁøÀÔ ÆÄÀÏ°æ·Î,À§ÇèÀÎÀÚ ÁøÀÔ ÆÄÀÏ¸í,À§ÇèÀÎÀÚ ÁøÀÔ ¶óÀÎ³Ñ¹ö,À§ÇèÀÎÀÚ ÁøÀÔ ¼Ò½ºÁ¶°¢,À§ÇèÀÎÀÚ ÁøÀÔ ÇÔ¼ö,Ãë¾àÁ¡ Å½Áö ÆÄÀÏ°æ·Î,Ãë¾àÁ¡ Å½Áö ÆÄÀÏ¸í,Ãë¾àÁ¡ Å½Áö ¶óÀÎ³Ñ¹ö,Ãë¾àÁ¡ Å½Áö ¼Ò½ºÁ¶°¢,Ãë¾àÁ¡ Å½Áö ÇÔ¼ö,Ãë¾àÁ¡ ÀÌ½´ °³¿ä,Ãë¾àÁ¡ °³¿ä,Ãë¾àÁ¡ ¼³¸í,Ãë¾àÁ¡ Á¶Ä¡ ±Ç°í³»¿ë,Ãë¾àÁ¡ Á¶Ä¡ tip,Ãë¾àÁ¡ ÀÌ½´ °íÀ¯Å°,Ãë¾àÁ¡ rule °íÀ¯Å°,auditor ÅÂ±×,auditor ¾ÆÀÌµğ,auditor ÀÇ°ß,scan ÀÏÀÚ,
High,High,Security Features,Privacy Violation: Autocomplete,,,,,,register.html,register.html,,    <span>å­??·: <input onmouseout = "SnoCheck()"  id="Sno"  type="text" name="Sno" /><p id="1"></p><br/><br/></span>
    <span>è´??·: <input onmouseout = "UserCheck()" id="User" type="text" name="LoginUser" ></input><p id="2"></p><br/><br/></span>
    <span>å¯†ç : <input onmouseout = "PassCheck()" id="Pass" type="password" name="LoginPass" ></input><br/><br/><p id="3"></p></span>
    <span style="margin-left: 218px;">ç¡?è®¤å¯†? : <input onmouseout = "PassTwoCheck()" id = "PassTwo" type="password" name="PassTwo" ></input><br/><br/><p id="4"></p></span>
   <br/><br/><br/> ,,register.htmlÀÇ Çü½ÄÀº 39 ÁÙÀÇ ÀÚµ¿ ¿Ï¼ºÀ» »ç¿ëÇÏ¸é ÀÏºÎ ºê¶ó¿ìÀúÀÇ ±â·Ï¿¡ ¹Î°¨ÇÑ Á¤º¸¸¦ º¸À¯ÇÒ ¼ö ÀÖ½À´Ï´Ù.,login.htmlÀÇ Çü½ÄÀº 19 ÁÙÀÇ ÀÚµ¿ ¿Ï¼ºÀ» »ç¿ëÇÏ¸é ÀÏºÎ ºê¶ó¿ìÀúÀÇ ±â·Ï¿¡ ¹Î°¨ÇÑ Á¤º¸¸¦ º¸À¯ÇÒ ¼ö ÀÖ½À´Ï´Ù.,ÀÚµ¿ ¿Ï¼ºÀÌ È°¼ºÈ­µÈ °æ¿ì, ÀÏºÎ ºê¶ó¿ìÀú¿¡ ¼¼¼Ç¿¡ ´ëÇÑ »ç¿ëÀÚ ÀÔ·ÂÀÌ À¯ÁöµÇ¸é ÃÊ±â »ç¿ëÀÚ ÀÌÈÄ¿¡ ÄÄÇ»ÅÍ¸¦ »ç¿ëÇÏ´Â »ç¶÷Àº ÀÌÀü¿¡ Àü¼ÛµÈ Á¤º¸¸¦ º¼ ¼ö ÀÖ½À´Ï´Ù.,Æû ¶Ç´Â ¹Î°¨ÇÑ ÀÔ·Â¿¡ ´ëÇÑ ÀÚµ¿ ¿Ï¼ºÀ» ¸í½ÃÀûÀ¸·Î ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À. ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ¸é ÀÔ·Â ½Ã ÀÌÀü¿¡ ÀÔ·ÂÇÑ Á¤º¸´Â »ç¿ëÀÚ¿¡°Ô ´Ù½Ã ³ªÅ¸³ªÁö ¾Ê½À´Ï´Ù. ¶ÇÇÑ ´ëºÎºĞÀÇ ÁÖ¿ä ºê¶ó¿ìÀúÀÇ "³» ¾ÏÈ£ ÀúÀå" ±â´ÉÀÌ ºñÈ°¼ºÈ­µË´Ï´Ù.

¿¹Á¦ 1: HTML Æû¿¡¼­ form ÅÂ±×ÀÇ autocomplete ¼Ó¼º °ªÀ» off·Î ¼³Á¤ÇÏ¿© ¸ğµç ÀÔ·Â ÇÊµåÀÇ ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À.


  <form method="post" autocomplete="off">
        Address: <input name="address" />
        Password: <input name="password" type="password" />
  </form>


¿¹Á¦ 2: ¶Ç´Â ÇØ´ç ÅÂ±×ÀÇ autocomplete ¼Ó¼º °ªÀ» off·Î ¼³Á¤ÇÏ¿© Æ¯Á¤ ÀÔ·Â ÇÊµåÀÇ ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À.


  <form method="post">
        Address: <input name="address" />
        Password: <input name="password" type="password" autocomplete="off"/>
  </form>


autocomplete ¼Ó¼ºÀÇ ±âº»°ªÀÌ onÀÎÁö È®ÀÎÇÏ½Ê½Ã¿À. µû¶ó¼­ ¹Î°¨ÇÑ ÀÔ·ÂÀ» ´Ù·ê °æ¿ì, ¼Ó¼ºÀ» »ı·«ÇÏÁö ¸¶½Ê½Ã¿À.,,CA9E64516D6FCAE0C54C2ED7EF6704A2,2FC7D1FF-11E4-468E-B7AB-F127828F4016,,,,2024-02-13,
High,High,Security Features,Privacy Violation: Autocomplete,,,,,,register.html,register.html,,    <span>è´??·: <input onmouseout = "UserCheck()" id="User" type="text" name="LoginUser" ></input><p id="2"></p><br/><br/></span>
    <span>å¯†ç : <input onmouseout = "PassCheck()" id="Pass" type="password" name="LoginPass" ></input><br/><br/><p id="3"></p></span>
    <span style="margin-left: 218px;">ç¡?è®¤å¯†? : <input onmouseout = "PassTwoCheck()" id = "PassTwo" type="password" name="PassTwo" ></input><br/><br/><p id="4"></p></span>
   <br/><br/><br/> 
    <span><input id = "submit" disabled style="width: 452px;color: #fff;background: #999;" type="submit" value="ç«‹å³æ³¨å†Œ"/></span>,,register.htmlÀÇ Çü½ÄÀº 40 ÁÙÀÇ ÀÚµ¿ ¿Ï¼ºÀ» »ç¿ëÇÏ¸é ÀÏºÎ ºê¶ó¿ìÀúÀÇ ±â·Ï¿¡ ¹Î°¨ÇÑ Á¤º¸¸¦ º¸À¯ÇÒ ¼ö ÀÖ½À´Ï´Ù.,login.htmlÀÇ Çü½ÄÀº 19 ÁÙÀÇ ÀÚµ¿ ¿Ï¼ºÀ» »ç¿ëÇÏ¸é ÀÏºÎ ºê¶ó¿ìÀúÀÇ ±â·Ï¿¡ ¹Î°¨ÇÑ Á¤º¸¸¦ º¸À¯ÇÒ ¼ö ÀÖ½À´Ï´Ù.,ÀÚµ¿ ¿Ï¼ºÀÌ È°¼ºÈ­µÈ °æ¿ì, ÀÏºÎ ºê¶ó¿ìÀú¿¡ ¼¼¼Ç¿¡ ´ëÇÑ »ç¿ëÀÚ ÀÔ·ÂÀÌ À¯ÁöµÇ¸é ÃÊ±â »ç¿ëÀÚ ÀÌÈÄ¿¡ ÄÄÇ»ÅÍ¸¦ »ç¿ëÇÏ´Â »ç¶÷Àº ÀÌÀü¿¡ Àü¼ÛµÈ Á¤º¸¸¦ º¼ ¼ö ÀÖ½À´Ï´Ù.,Æû ¶Ç´Â ¹Î°¨ÇÑ ÀÔ·Â¿¡ ´ëÇÑ ÀÚµ¿ ¿Ï¼ºÀ» ¸í½ÃÀûÀ¸·Î ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À. ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ¸é ÀÔ·Â ½Ã ÀÌÀü¿¡ ÀÔ·ÂÇÑ Á¤º¸´Â »ç¿ëÀÚ¿¡°Ô ´Ù½Ã ³ªÅ¸³ªÁö ¾Ê½À´Ï´Ù. ¶ÇÇÑ ´ëºÎºĞÀÇ ÁÖ¿ä ºê¶ó¿ìÀúÀÇ "³» ¾ÏÈ£ ÀúÀå" ±â´ÉÀÌ ºñÈ°¼ºÈ­µË´Ï´Ù.

¿¹Á¦ 1: HTML Æû¿¡¼­ form ÅÂ±×ÀÇ autocomplete ¼Ó¼º °ªÀ» off·Î ¼³Á¤ÇÏ¿© ¸ğµç ÀÔ·Â ÇÊµåÀÇ ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À.


  <form method="post" autocomplete="off">
        Address: <input name="address" />
        Password: <input name="password" type="password" />
  </form>


¿¹Á¦ 2: ¶Ç´Â ÇØ´ç ÅÂ±×ÀÇ autocomplete ¼Ó¼º °ªÀ» off·Î ¼³Á¤ÇÏ¿© Æ¯Á¤ ÀÔ·Â ÇÊµåÀÇ ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À.


  <form method="post">
        Address: <input name="address" />
        Password: <input name="password" type="password" autocomplete="off"/>
  </form>


autocomplete ¼Ó¼ºÀÇ ±âº»°ªÀÌ onÀÎÁö È®ÀÎÇÏ½Ê½Ã¿À. µû¶ó¼­ ¹Î°¨ÇÑ ÀÔ·ÂÀ» ´Ù·ê °æ¿ì, ¼Ó¼ºÀ» »ı·«ÇÏÁö ¸¶½Ê½Ã¿À.,,CA9E64516D6FCAE0C54C2ED7EF6704A3,2FC7D1FF-11E4-468E-B7AB-F127828F4016,,,,2024-02-13,
High,High,Security Features,Privacy Violation: Autocomplete,,,,,,login.html,login.html,,        <center>?”¨?ˆ·?™»å½?</center><br/><br/>
        USER: <br/> <input type="text" name="user"></input><br/><br/>
        PASS: <br/><input type="password" name="pass"></input>
        <br/>
        <br/>,,login.htmlÀÇ Çü½ÄÀº 19 ÁÙÀÇ ÀÚµ¿ ¿Ï¼ºÀ» »ç¿ëÇÏ¸é ÀÏºÎ ºê¶ó¿ìÀúÀÇ ±â·Ï¿¡ ¹Î°¨ÇÑ Á¤º¸¸¦ º¸À¯ÇÒ ¼ö ÀÖ½À´Ï´Ù.,login.htmlÀÇ Çü½ÄÀº 19 ÁÙÀÇ ÀÚµ¿ ¿Ï¼ºÀ» »ç¿ëÇÏ¸é ÀÏºÎ ºê¶ó¿ìÀúÀÇ ±â·Ï¿¡ ¹Î°¨ÇÑ Á¤º¸¸¦ º¸À¯ÇÒ ¼ö ÀÖ½À´Ï´Ù.,ÀÚµ¿ ¿Ï¼ºÀÌ È°¼ºÈ­µÈ °æ¿ì, ÀÏºÎ ºê¶ó¿ìÀú¿¡ ¼¼¼Ç¿¡ ´ëÇÑ »ç¿ëÀÚ ÀÔ·ÂÀÌ À¯ÁöµÇ¸é ÃÊ±â »ç¿ëÀÚ ÀÌÈÄ¿¡ ÄÄÇ»ÅÍ¸¦ »ç¿ëÇÏ´Â »ç¶÷Àº ÀÌÀü¿¡ Àü¼ÛµÈ Á¤º¸¸¦ º¼ ¼ö ÀÖ½À´Ï´Ù.,Æû ¶Ç´Â ¹Î°¨ÇÑ ÀÔ·Â¿¡ ´ëÇÑ ÀÚµ¿ ¿Ï¼ºÀ» ¸í½ÃÀûÀ¸·Î ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À. ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ¸é ÀÔ·Â ½Ã ÀÌÀü¿¡ ÀÔ·ÂÇÑ Á¤º¸´Â »ç¿ëÀÚ¿¡°Ô ´Ù½Ã ³ªÅ¸³ªÁö ¾Ê½À´Ï´Ù. ¶ÇÇÑ ´ëºÎºĞÀÇ ÁÖ¿ä ºê¶ó¿ìÀúÀÇ "³» ¾ÏÈ£ ÀúÀå" ±â´ÉÀÌ ºñÈ°¼ºÈ­µË´Ï´Ù.

¿¹Á¦ 1: HTML Æû¿¡¼­ form ÅÂ±×ÀÇ autocomplete ¼Ó¼º °ªÀ» off·Î ¼³Á¤ÇÏ¿© ¸ğµç ÀÔ·Â ÇÊµåÀÇ ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À.


  <form method="post" autocomplete="off">
        Address: <input name="address" />
        Password: <input name="password" type="password" />
  </form>


¿¹Á¦ 2: ¶Ç´Â ÇØ´ç ÅÂ±×ÀÇ autocomplete ¼Ó¼º °ªÀ» off·Î ¼³Á¤ÇÏ¿© Æ¯Á¤ ÀÔ·Â ÇÊµåÀÇ ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À.


  <form method="post">
        Address: <input name="address" />
        Password: <input name="password" type="password" autocomplete="off"/>
  </form>


autocomplete ¼Ó¼ºÀÇ ±âº»°ªÀÌ onÀÎÁö È®ÀÎÇÏ½Ê½Ã¿À. µû¶ó¼­ ¹Î°¨ÇÑ ÀÔ·ÂÀ» ´Ù·ê °æ¿ì, ¼Ó¼ºÀ» »ı·«ÇÏÁö ¸¶½Ê½Ã¿À.,,DA87A9C902D54BAADFCA48C96419F2F2,2FC7D1FF-11E4-468E-B7AB-F127828F4016,,,,2024-02-13,
High,High,Security Features,Privacy Violation: Autocomplete,,,,,,login.jsp,login.jsp,,    		<center>??¡§©¡?¡¤????¨ö?</center><br/><br/>
    		USER: <br/> <input type="text" name="user"></input><br/><br/>
    		PASS: <br/><input type="password" name="pass"></input>
    		<br/>
    		<br/>,,login.jspÀÇ Çü½ÄÀº 28 ÁÙÀÇ ÀÚµ¿ ¿Ï¼ºÀ» »ç¿ëÇÏ¸é ÀÏºÎ ºê¶ó¿ìÀúÀÇ ±â·Ï¿¡ ¹Î°¨ÇÑ Á¤º¸¸¦ º¸À¯ÇÒ ¼ö ÀÖ½À´Ï´Ù.,login.htmlÀÇ Çü½ÄÀº 19 ÁÙÀÇ ÀÚµ¿ ¿Ï¼ºÀ» »ç¿ëÇÏ¸é ÀÏºÎ ºê¶ó¿ìÀúÀÇ ±â·Ï¿¡ ¹Î°¨ÇÑ Á¤º¸¸¦ º¸À¯ÇÒ ¼ö ÀÖ½À´Ï´Ù.,ÀÚµ¿ ¿Ï¼ºÀÌ È°¼ºÈ­µÈ °æ¿ì, ÀÏºÎ ºê¶ó¿ìÀú¿¡ ¼¼¼Ç¿¡ ´ëÇÑ »ç¿ëÀÚ ÀÔ·ÂÀÌ À¯ÁöµÇ¸é ÃÊ±â »ç¿ëÀÚ ÀÌÈÄ¿¡ ÄÄÇ»ÅÍ¸¦ »ç¿ëÇÏ´Â »ç¶÷Àº ÀÌÀü¿¡ Àü¼ÛµÈ Á¤º¸¸¦ º¼ ¼ö ÀÖ½À´Ï´Ù.,Æû ¶Ç´Â ¹Î°¨ÇÑ ÀÔ·Â¿¡ ´ëÇÑ ÀÚµ¿ ¿Ï¼ºÀ» ¸í½ÃÀûÀ¸·Î ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À. ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ¸é ÀÔ·Â ½Ã ÀÌÀü¿¡ ÀÔ·ÂÇÑ Á¤º¸´Â »ç¿ëÀÚ¿¡°Ô ´Ù½Ã ³ªÅ¸³ªÁö ¾Ê½À´Ï´Ù. ¶ÇÇÑ ´ëºÎºĞÀÇ ÁÖ¿ä ºê¶ó¿ìÀúÀÇ "³» ¾ÏÈ£ ÀúÀå" ±â´ÉÀÌ ºñÈ°¼ºÈ­µË´Ï´Ù.

¿¹Á¦ 1: HTML Æû¿¡¼­ form ÅÂ±×ÀÇ autocomplete ¼Ó¼º °ªÀ» off·Î ¼³Á¤ÇÏ¿© ¸ğµç ÀÔ·Â ÇÊµåÀÇ ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À.


  <form method="post" autocomplete="off">
        Address: <input name="address" />
        Password: <input name="password" type="password" />
  </form>


¿¹Á¦ 2: ¶Ç´Â ÇØ´ç ÅÂ±×ÀÇ autocomplete ¼Ó¼º °ªÀ» off·Î ¼³Á¤ÇÏ¿© Æ¯Á¤ ÀÔ·Â ÇÊµåÀÇ ÀÚµ¿ ¿Ï¼ºÀ» ºñÈ°¼ºÈ­ÇÏ½Ê½Ã¿À.


  <form method="post">
        Address: <input name="address" />
        Password: <input name="password" type="password" autocomplete="off"/>
  </form>


autocomplete ¼Ó¼ºÀÇ ±âº»°ªÀÌ onÀÎÁö È®ÀÎÇÏ½Ê½Ã¿À. µû¶ó¼­ ¹Î°¨ÇÑ ÀÔ·ÂÀ» ´Ù·ê °æ¿ì, ¼Ó¼ºÀ» »ı·«ÇÏÁö ¸¶½Ê½Ã¿À.,,62722A3F75BE81ECDF3ACB69E695990A,2FC7D1FF-11E4-468E-B7AB-F127828F4016,,,,2024-02-13,
Critical,Critical,Input Validation and Representation,SQL Injection,src/adrui/registerServlet.java,registerServlet.java,,		// TODO Auto-generated method stub
		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");,javax.servlet.ServletRequest.getParameter(),src/adrui/registerServlet.java,registerServlet.java,,				System.out.println("f = true");
				sql = "insert into user values('" + sno + "', '" + user + "', '" + pass + "')";
				state.executeUpdate(sql);		
				
			},java.sql.Statement.executeUpdate(),registerServlet.javaÀÇ 64 ÁÙ¿¡¼­ doPost() ¸Ş¼­µå´Â ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ ³ª¿Â ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ¸¸µé¾îÁø SQL Äõ¸®¸¦ È£ÃâÇÕ´Ï´Ù. ÀÌ È£ÃâÀ» »ç¿ëÇÏ¿© °ø°İÀÚ´Â ÇØ´ç ¹®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ°Å³ª ÀÓÀÇÀÇ SQL ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.,LoginModel.javaÀÇ 9 ÁÙ¿¡¼­ check() ¸Ş¼­µå´Â ÀáÀçÀûÀ¸·Î ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ ³ª¿Â ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ¸¸µé¾îÁø SQL Äõ¸®¸¦ È£ÃâÇÕ´Ï´Ù. ÀÌ È£ÃâÀ» »ç¿ëÇÏ¿© °ø°İÀÚ´Â ÇØ´ç ¹®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ°Å³ª ÀÓÀÇÀÇ SQL ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.,SQL injection ¿À·ù´Â ´ÙÀ½ °æ¿ì¿¡ ¹ß»ıÇÕ´Ï´Ù.

1. ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ µ¥ÀÌÅÍ°¡ ÇÁ·Î±×·¥¿¡ ÀÔ·ÂµË´Ï´Ù.

ÀÌ·± °æ¿ì, Fortify Static Code Analyzer´Â µ¥ÀÌÅÍ ¼Ò½º¸¦ ½Å·ÚÇÒ ¼ö ÀÖ´Â °ÍÀ¸·Î ÆÇ´ÜÇÏÁö ¾Ê½À´Ï´Ù.

2. µ¥ÀÌÅÍ¸¦ »ç¿ëÇÏ¿© SQL Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÕ´Ï´Ù.



¿¹Á¦ 1: ´ÙÀ½ ÄÚµå´Â ÁöÁ¤µÈ ÀÌ¸§°ú ÀÏÄ¡ÇÏ´Â Ç×¸ñÀ» °Ë»öÇÏ´Â SQL Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÏ°í ½ÇÇàÇÕ´Ï´Ù. Äõ¸®´Â Ç¥½ÃµÇ´Â Ç×¸ñÀ» Ç×¸ñ ¼ÒÀ¯ÀÚ°¡ ÇöÀç ÀÎÁõµÈ »ç¿ëÀÚÀÇ ÀÌ¸§°ú ÀÏÄ¡ÇÏ´Â Ç×¸ñÀ¸·Î Á¦ÇÑÇÕ´Ï´Ù.


...
	String userName = ctx.getAuthenticatedUserName();
	String itemName = request.getParameter("itemName");
	String query = "SELECT * FROM items WHERE owner = '"
				+ userName + "' AND itemname = '"
				+ itemName + "'";
	ResultSet rs = stmt.execute(query);
...


Äõ¸®´Â ´ÙÀ½ ÄÚµå¸¦ ½ÇÇàÇÏ·Á°í ÇÕ´Ï´Ù.


	SELECT * FROM items
	WHERE owner = <userName>
	AND itemname = <itemName>;


ÇÏÁö¸¸ »ó¼öÀÎ ±âº» Äõ¸® ¹®ÀÚ¿­°ú »ç¿ëÀÚ ÀÔ·Â ¹®ÀÚ¿­À» ¿¬°áÇÏ¿© Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÏ±â ¶§¹®¿¡, Äõ¸®´Â itemName¿¡ ÀÛÀºµû¿ÈÇ¥°¡ µé¾î ÀÖÁö ¾ÊÀº °æ¿ì¿¡¸¸ Á¤È®ÇÏ°Ô µ¿ÀÛÇÕ´Ï´Ù. »ç¿ëÀÚ ÀÌ¸§ÀÌ wileyÀÎ °ø°İÀÚ°¡ itemName¿¡ ¹®ÀÚ¿­ "name' OR 'a'='a"¸¦ ÀÔ·ÂÇÏ¸é Äõ¸®´Â ´ÙÀ½°ú °°ÀÌ »ı¼ºµË´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name' OR 'a'='a';


OR 'a'='a' Á¶°ÇÀ» Ãß°¡ÇÏ¸é where ÀıÀÌ Ç×»ó true·Î Æò°¡ÇÏ±â ¶§¹®¿¡ Äõ¸®´Â ÈÎ¾À °£´ÜÇÑ ´ÙÀ½ Äõ¸®¿Í ³í¸®ÀûÀ¸·Î µ¿ÀÏÇÏ°Ô µË´Ï´Ù.


	SELECT * FROM items;


°ø°İÀÚ´Â ÀÌ·¸°Ô Äõ¸®¸¦ ´Ü¼øÈ­ÇÏ¿© Äõ¸®°¡ ÀÎÁõµÈ »ç¿ëÀÚ°¡ ¼ÒÀ¯ÇÑ Ç×¸ñ¸¸ ¹İÈ¯ÇØ¾ß ÇÑ´Ù´Â ¿ä±¸ »çÇ×À» ¹«½ÃÇÒ ¼ö ÀÖ½À´Ï´Ù. ÀÌÁ¦ Äõ¸®´Â ÁöÁ¤µÈ ¼ÒÀ¯ÀÚ¿Í °ü°è¾øÀÌ items Å×ÀÌºí¿¡ ÀúÀåµÈ ¸ğµç Ç×¸ñÀ» ¹İÈ¯ÇÕ´Ï´Ù.

¿¹Á¦ 2: ÀÌ ¿¹Á¦´Â Example 1¿¡¼­ »ı¼ºÇÏ¿© ¼öÇàÇÑ Äõ¸®¿¡ ¶Ç ´Ù¸¥ ¾Ç¼º °ªÀÌ Àü´ŞµÉ ¶§ÀÇ °á°ú¸¦ °ËÅäÇÕ´Ï´Ù. »ç¿ëÀÚ ÀÌ¸§ÀÌ wileyÀÎ °ø°İÀÚ°¡ itemName¿¡ ¹®ÀÚ¿­ "name'; DELETE FROM items; --"¸¦ ÀÔ·ÂÇÏ¸é Äõ¸®´Â ´ÙÀ½°ú °°Àº µÎ °³ÀÇ Äõ¸®°¡ µË´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name';

	DELETE FROM items;

	--'


Microsoft(R) SQL Server 2000À» Æ÷ÇÔÇÑ ¸¹Àº µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­ ¿©·¯ SQL ¹®À» ¼¼¹ÌÄİ·ĞÀ¸·Î ±¸ºĞÇÏ¿© ÇÑ²¨¹ø¿¡ ½ÇÇàÇÏ´Â °ÍÀ» Çã¿ëÇÕ´Ï´Ù. ÀÌ °ø°İ ¹®ÀÚ¿­Àº ¼¼¹ÌÄİ·ĞÀ¸·Î ±¸ºĞÇÑ ¹®¿¡ ´ëÇÑ ÀÏ°ı ½ÇÇàÀ» Çã¿ëÇÏÁö ¾Ê´Â Oracle ¹× ±âÅ¸ µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­´Â ¿À·ù¸¦ ÀÏÀ¸Å°Áö¸¸ ÀÏ°ı ½ÇÇàÀ» Çã¿ëÇÏ´Â µ¥ÀÌÅÍº£ÀÌ½º¿¡¼­´Â °ø°İÀÚ°¡ ÀÌ·± Á¾·ùÀÇ °ø°İÀ¸·Î µ¥ÀÌÅÍº£ÀÌ½º¿¡ ´ëÇØ ÀÓÀÇÀÇ ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.

¸¶Áö¸·ÀÇ ÇÏÀÌÇÂ ½Ö(--)À» º¸°Ú½À´Ï´Ù. ÀÌ´Â ´ëºÎºĞÀÇ µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­ ÇØ´ç ¹®¿¡ ´ëÇÑ ³ª¸ÓÁö ºÎºĞÀ» ÁÖ¼®À¸·Î Ã³¸®ÇÏ¿© ½ÇÇàÇÏÁö ¸»¶ó´Â ÀÇ¹Ì·Î ÇØ¼®µË´Ï´Ù[4]. ÀÌ °æ¿ì, ÀÌ ÁÖ¼® ¹®ÀÚ´Â ¼öÁ¤µÈ Äõ¸®¿¡¼­ ¸¶Áö¸·ÀÇ ÀÛÀºµû¿ÈÇ¥ ÇÑÂÊÀ» Á¦°ÅÇÏ´Â ¿ªÇÒÀ» ÇÕ´Ï´Ù. ÁÖ¼®À» ÀÌ·± ½ÄÀ¸·Î »ç¿ëÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍº£ÀÌ½º¿¡¼­µµ Example 1¿¡¼­ »ç¿ëµÈ °Í°ú À¯»çÇÑ ¼ÓÀÓ¼ö¸¦ »ç¿ëÇÏ¸é ´ëºÎºĞÀÇ °ø°İÀÌ È¿°ú¸¦ °ÅµÑ ¼ö ÀÖ½À´Ï´Ù. °ø°İÀÚ°¡ ¹®ÀÚ¿­ "name'); DELETE FROM items; SELECT * FROM items WHERE 'a'='a"¸¦ ÀÔ·ÂÇÏ¿© ´ÙÀ½ ¼¼ °¡Áö À¯È¿ÇÑ ¹®À» ¸¸µå´Â °æ¿ìÀÔ´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name';

	DELETE FROM items;

	SELECT * FROM items WHERE 'a'='a';


¸ğ¹ÙÀÏ È¯°æ¿¡¼­´Â SQL Injection°ú °°Àº ÀüÇüÀûÀÎ À¥ ÀÀ¿ë ÇÁ·Î±×·¥ Ãë¾à¼ºÀÌ ¹ß»ıÇÏÁö ¾Ê´Â´Ù°í »ı°¢ÇÏ´Â »ç¿ëÀÚµµ ÀÖ½À´Ï´Ù. ÀÚ±â ÀÚ½ÅÀ» °ø°İÇÏ´Â »ç¿ëÀÚ´Â ¾øÀ» °ÍÀÌ¶ó ¿©±â±â ¶§¹®ÀÔ´Ï´Ù. ±×·¯³ª ¸ğ¹ÙÀÏ ÇÃ·§ÆûÀÇ ÇÙ½É ¿ä¼Ò´Â ´Ù¾çÇÑ ¼Ò½º¿¡¼­ ´Ù¿î·ÎµåµÇ¾î °°Àº ÀåÄ¡¿¡¼­ ÇÔ²² ½ÇÇàµÇ´Â ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ¶ó´Â Á¡À» À¯³äÇØ¾ß ÇÕ´Ï´Ù. Áï ±İÀ¶ ÀÀ¿ë ÇÁ·Î±×·¥°ú ¸È¿ş¾î¸¦ ÇÔ²² ½ÇÇàÇÒ °¡´É¼ºÀÌ ³ôÀ¸¹Ç·Î ÇÁ·Î¼¼½º °£ Åë½ÅÀ» Æ÷ÇÔÇÏµµ·Ï ¸ğ¹ÙÀÏ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ °ø°İ Ç¥¸éÀ» È®ÀåÇØ¾ß ÇÕ´Ï´Ù.

¿¹Á¦ 3: ´ÙÀ½ ÄÚµå´Â Example 1À» Android ÇÃ·§Æû¿¡ ¸Â°Ô Á¶Á¤ÇÕ´Ï´Ù.


...
        PasswordAuthentication pa = authenticator.getPasswordAuthentication();
        String userName = pa.getUserName();
        String itemName = this.getIntent().getExtras().getString("itemName");
        String query = "SELECT * FROM items WHERE owner = '"
                                + userName + "' AND itemname = '"
                                + itemName + "'";
        SQLiteDatabase db = this.openOrCreateDatabase("DB", MODE_PRIVATE, null);
        Cursor c = db.rawQuery(query, null);
...


SQL Injection °ø°İÀ» ¹æÁöÇÏ´Â ÇÑ °¡Áö ±âÁ¸ÀÇ Á¢±Ù ¹æ½ÄÀº °ø°İÀ» ÀÔ·Â°ª °ËÁõ ¹®Á¦·Î Ã³¸®ÇÏ°í ¾ÈÀüÇÑ °ª ¸ñ·Ï(Çã¿ë ¸ñ·Ï)ÀÇ ¹®ÀÚ¸¸ ¹Ş°Å³ª ¾ÇÀÇÀûÀÏ °¡´É¼ºÀÌ ÀÖ´Â °ª ¸ñ·Ï(°ÅºÎ ¸ñ·Ï)À» ½Äº°ÇÏ¿© ÀÌ½ºÄÉÀÌÇÁ Ã³¸®ÇÏ´Â °ÍÀÔ´Ï´Ù. Çã¿ë ¸ñ·Ï °Ë»ç´Â ¾ö°İÇÑ ÀÔ·Â°ª °ËÁõ ±ÔÄ¢À» ÀÌÇàÇÏ´Â ¸Å¿ì È¿À²ÀûÀÎ ¼ö´ÜÀÌ µÇ±âµµ ÇÏÁö¸¸, ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº À¯Áö °ü¸®°¡ ½±°í º¸´Ù °­·ÂÇÑ º¸¾ÈÀ» Á¦°øÇÒ ¼ö ÀÖ½À´Ï´Ù. ´ëºÎºĞÀÇ °æ¿ì °ÅºÎ ¸ñ·Ï ±¸ÇöÀº SQL Injection °ø°İ ¹æÁöÀÇ È¿°ú¸¦ ¶³¾î¶ß¸®´Â ÇãÁ¡ÀÌ ¾ÆÁÖ ¸¹½À´Ï´Ù. ¿¹¸¦ µé¾î, °ø°İÀÚ´Â ´ÙÀ½°ú °°ÀÌ ÇÒ ¼ö ÀÖ½À´Ï´Ù.

- µû¿ÈÇ¥·Î ¹­Áö ¾ÊÀº ÇÊµå¸¦ ³ë¸³´Ï´Ù.
- ÀÌ½ºÄÉÀÌÇÁ Ã³¸®µÈ ¸ŞÅ¸ ¹®ÀÚ¸¦ »ç¿ëÇÒ ÇÊ¿ä°¡ ¾ø´Â ¹æ¹ıÀ» Ã£½À´Ï´Ù.
- ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)¸¦ »ç¿ëÇÏ¿© »ğÀÔµÈ ¸ŞÅ¸ ¹®ÀÚ¸¦ ¼û±é´Ï´Ù.

SQL Äõ¸®¿¡ ÀÔ·ÂÇÒ ¶§ ¼öµ¿À¸·Î ¹®ÀÚ¸¦ ÀÌ½ºÄÉÀÌÇÁ Ã³¸®ÇÏ´Â ¹æ¹ıµµ ÀÖÁö¸¸ ÀÌ°ÍÀ¸·Î SQL injection °ø°İÀ¸·ÎºÎÅÍ ÀÀ¿ë ÇÁ·Î±×·¥À» º¸È£ÇÒ ¼ö´Â ¾ø½À´Ï´Ù.

SQL injection °ø°İÀ» ´Ù·ç´Â µ¥ ÁÖ·Î Á¦½ÃµÇ´Â ´Ù¸¥ ¼Ö·ç¼ÇÀº ÀúÀå ÇÁ·Î½ÃÀú(stored procedure)¸¦ »ç¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏºÎ À¯ÇüÀÇ SQL injection °ø°İÀº ¸·À» ¼ö ÀÖÁö¸¸ ´Ù¸¥ ¸¹Àº À¯ÇüÀº ¸·Áö ¸øÇÕ´Ï´Ù. ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏ¹İÀûÀ¸·Î ¸Å°³ º¯¼ö¿¡ Àü´ŞµÇ´Â SQL ¹®ÀÇ À¯ÇüÀ» Á¦ÇÑÇÏ¿© SQL injection °ø°İÀ» ¸·½À´Ï´Ù. ÇÏÁö¸¸ ÀÌ Á¦¾àÀ» ÇÇÇÒ ¼ö ÀÖ´Â ¸¹Àº ¹æ¹ıÀÌ ÀÖ¾î ¼ö¸¹Àº ºñÁ¤»óÀûÀÎ ¹®À» ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)¿¡ Àü´ŞÇÒ ¼ö ÀÖ½À´Ï´Ù. µÇÇ®ÀÌÇÏÁö¸¸, ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏºÎ ÀÍ½ºÇÃ·ÎÀÌÆ®´Â ¸·À» ¼ö ÀÖÁö¸¸ ÀÀ¿ë ÇÁ·Î±×·¥À» SQL injection °ø°İ¿¡ ´ëÇØ ¾ÈÀüÇÏ°Ô º¸È£ÇÒ ¼ö´Â ¾ø½À´Ï´Ù.,SQL injection Ãë¾àÁ¡ÀÇ ¿øÀÎÀº °ø°İÀÚ°¡ SQL Äõ¸®ÀÇ ÄÁÅØ½ºÆ®¸¦ º¯°æÇÏ¿© ÇÁ·Î±×·¡¸Ó°¡ µ¥ÀÌÅÍ·Î ÇØ¼®µÇ±â¸¦ ¹Ù¶ó´Â °ªÀ» ¸í·ÉÀ¸·Î ÇØ¼®µÇµµ·Ï ¸¸µé ¼ö ÀÖ´Ù´Â Á¡ÀÔ´Ï´Ù. SQL Äõ¸®¸¦ »ı¼ºÇÒ ¶§, ÇÁ·Î±×·¡¸Ó´Â ¹«¾ùÀÌ ¸í·ÉÀ¸·Î ÇØ¼®µÇ¾î¾ß ÇÏ°í ¹«¾ùÀÌ µ¥ÀÌÅÍ·Î ÇØ¼®µÇ¾î¾ß ÇÏ´ÂÁö ¾Ë°í ÀÖ½À´Ï´Ù. ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº µ¥ÀÌÅÍ À§ÁÖÀÇ ÄÁÅØ½ºÆ® º¯°æÀ» Çã¿ëÇÏÁö ¾Ê°í °ÅÀÇ ¸ğµç SQL injection °ø°İÀ» ¹æÁöÇÏ¿© ÀÌ¸¦ ÀÌÇàÇÕ´Ï´Ù. ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº ÀÏ¹İ SQL ¹®ÀÚ¿­À» »ç¿ëÇÏ¿© »ı¼ºµÇÁö¸¸, »ç¿ëÀÚ°¡ Á¦°øÇÏ´Â µ¥ÀÌÅÍ¸¦ Æ÷ÇÔÇØ¾ß ÇÏ´Â °æ¿ì¿¡ ÀÌÈÄ¿¡ »ğÀÔµÇ´Â µ¥ÀÌÅÍÀÇ ÀÚ¸® Ç¥½ÃÀÚÀÎ ¹ÙÀÎµù ¸Å°³ º¯¼ö¸¦ »ı¼ºÇÕ´Ï´Ù. ¹ÙÀÎµù ¸Å°³ º¯¼ö¸¦ »ç¿ëÇÏ¸é ÇÁ·Î±×·¥ÀÌ ¸í·ÉÀ¸·Î Ã³¸®ÇØ¾ß ÇÒ °Í°ú µ¥ÀÌÅÍ·Î Ã³¸®ÇØ¾ß ÇÒ °ÍÀ» µ¥ÀÌÅÍº£ÀÌ½º¿¡ ¸í½ÃÀûÀ¸·Î ÁöÁ¤ÇÒ ¼ö ÀÖ½À´Ï´Ù. ÇÁ·Î±×·¥ÀÌ ¹®À» ½ÇÇàÇÒ ÁØºñ°¡ µÇ¸é °¢ ¹ÙÀÎµù ¸Å°³ º¯¼ö¿¡ »ç¿ëÇÒ ·±Å¸ÀÓ °ªÀ» µ¥ÀÌÅÍº£ÀÌ½º¿¡ ÁöÁ¤ÇÏ¿© µ¥ÀÌÅÍ°¡ ¸í·ÉÀ¸·Î ÇØ¼®µÉ À§ÇèÀ» ÇÇÇÒ ¼ö ÀÖ½À´Ï´Ù. 

»ç¿ëÀÚ°¡ Á¦°øÇÏ´Â ¹®ÀÚ¿­À» ¿¬°áÇÏ´Â ´ë½Å ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏµµ·Ï ´ÙÀ½°ú °°ÀÌ ¿¹Á¦ 1À» ´Ù½Ã ÀÛ¼ºÇÒ ¼ö ÀÖ½À´Ï´Ù.


...
	String userName = ctx.getAuthenticatedUserName();
	String itemName = request.getParameter("itemName");
	String query =
        	"SELECT * FROM items WHERE itemname=? AND owner=?";
	PreparedStatement stmt = conn.prepareStatement(query);
	stmt.setString(1, itemName);
	stmt.setString(2, userName);
	ResultSet results = stmt.execute();
...


Android¿¡ ÇØ´çÇÏ´Â ÄÚµå´Â ´ÙÀ½°ú °°½À´Ï´Ù.


...
	PasswordAuthentication pa = authenticator.getPasswordAuthentication();
	String userName = pa.getUserName();
	String itemName = this.getIntent().getExtras().getString("itemName");
	String query = "SELECT * FROM items WHERE itemname=? AND owner=?";
	SQLiteDatabase db = this.openOrCreateDatabase("DB", MODE_PRIVATE, null);
	Cursor c = db.rawQuery(query, new Object[]{itemName, userName});
...


ÈçÈ÷ º¸°í¼­ »ı¼º ÄÚµå¿¡¼­ º¼ ¼ö ÀÖ´Â º¹ÀâÇÑ ½Ã³ª¸®¿À¿¡¼­´Â WHERE ÀıÀÇ µ¿Àû Á¦¾à Á¶°Ç Ãß°¡¿Í °°ÀÌ, SQL ¹®ÀÇ ¸í·É ±¸Á¶°¡ °áÁ¤µÇ´Â »ç¿ëÀÚ ÀÔ·ÂÀÌ ÇÊ¿äÇÕ´Ï´Ù. ±×·¸´Ù°í ÀÌ ¿ä±¸ »çÇ×ÀÌ »ç¿ëÀÚ ÀÔ·ÂÀ» ¿¬°áÇÏ¿© Äõ¸® ¹®ÀÚ¿­À» ¸¸µå´Â °ÍÀ» Á¤´çÈ­ÇÒ ¼ö´Â ¾ø½À´Ï´Ù. »ç¿ëÀÚ ÀÔ·ÂÀ» SQL ¹® ¸í·É ±¸Á¶¿¡ Àû¿ëÇØ¾ß ÇÏ´Â °æ¿ì °£Á¢ ÂüÁ¶¸¦ »ç¿ëÇÏ¿© SQL injection °ø°İÀ» ¿¹¹æÇÕ´Ï´Ù. Áï, SQL ¹®¿¡ Æ÷ÇÔ½ÃÅ³ ¿©·¯ ¿ä¼Ò¿¡ ÇØ´çÇÏ´Â À¯È¿ÇÑ ¹®ÀÚ¿­ ÁıÇÕÀ» ¸¸µì´Ï´Ù. ¹®À» ¸¸µé ¶§ »ç¿ëÀÚ ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ÀÌ ÀÀ¿ë ÇÁ·Î±×·¥ Á¦¾î °ª ÁıÇÕ¿¡¼­ °ªÀ» ¼±ÅÃÇÕ´Ï´Ù.,1. ÀÌ ¶§, ÈçÈ÷ ÀúÁö¸£´Â ½Ç¼ö´Â »ç¿ëÀÚ°¡ Á¦¾îÇÏ´Â ¹®ÀÚ¿­À» ¿¬°áÇÏ¿© »ı¼ºÇÑ, ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. ¹°·Ğ ÀÌ·¸°Ô ÇÏ¸é ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏ´Â ¸ñÀûÀÌ ¹«»êµË´Ï´Ù. SQL ¹®À» Çü¼ºÇÏ´Â ¹®ÀÚ¿­ÀÌ ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­ Á¦¾îÇÏ´Â »ó¼öÀÎÁö È®½ÅÇÒ ¼ö ¾ø´Â °æ¿ì, ¹®ÀÚ¿­ÀÌ SQL ¹®ÀÚ¿­·Î Á÷Á¢ ½ÇÇàµÇÁö ¾Ê±â ¶§¹®¿¡ ¾ÈÀüÇÏ´Ù°í °¡Á¤ÇÒ ¼ö ¾ø½À´Ï´Ù. SQL ¹®¿¡¼­ »ç¿ëÀÚ Á¦¾î ¹®ÀÚ¿­ÀÇ ¸ğµç »ç¿ëÀ» Ã¶ÀúÇÏ°Ô Á¶»çÇÏ°í Äõ¸®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ´Â µ¥ »ç¿ëµÇ´Â ÀÏÀÌ ¾ø´ÂÁö È®ÀÎÇØ¾ß ÇÕ´Ï´Ù.

2. µ¥ÀÌÅÍ°¡ Å¬·¡½ºÀÇ °ø¿ë ºñ final ¹®ÀÚ¿­ ÇÊµå¿¡¼­ ¿À´Â °æ¿ì ÀÌ µ¥ÀÌÅÍ´Â ½Å·ÚÇÒ ¼ö ¾ø½À´Ï´Ù. ÀÌ·¯ÇÑ À¯ÇüÀÇ ÇÊµå´Â ¾Ë·ÁÁöÁö ¾ÊÀº ¼Ò½º¿¡ ÀÇÇØ ¼öÁ¤µÉ ¼ö ÀÖ½À´Ï´Ù.

3. SQL Injection ¹®Á¦´Â µ¥ÀÌÅÍ Èå¸§ ¼öÁ¤ ÀÛ¾÷ ÈÄ¿¡µµ °è¼ÓÇØ¼­ º¸°íµÉ ¼ö ÀÖ½À´Ï´Ù(¿ì¼± ¼øÀ§ °ªÀº °¨¼Ò). Fortify Static Code Analyzer¿¡¼­ »ç¿ëÀÚ Á¦¾î ÀÔ·ÂÀÌ SQL ¹® ±¸¼º¿¡ »ç¿ëµÇ°í ÀÖ´Ù´Â ºĞ¸íÇÑ µ¥ÀÌÅÍ Èå¸§ Áõ°Å°¡ ¹ß°ßµÇ¸é ³ôÀ½/½É°¢ ¿ì¼± ¼øÀ§ÀÇ µ¥ÀÌÅÍ Èå¸§ ¹®Á¦°¡ º¸°íµË´Ï´Ù. Fortify Static Code Analyzer¿¡¼­ µ¥ÀÌÅÍ ¼Ò½º¸¦ °áÁ¤ÇÒ ¼ö ¾ø°í ¼Ò½º°¡ µ¿ÀûÀ¸·Î º¯°æµÉ ¼ö ÀÖ´Â °æ¿ì ³·À½/Áß°£ ¿ì¼± ¼øÀ§ÀÇ ÀÇ¹Ì Ã¼°è ¹®Á¦°¡ º¸°íµË´Ï´Ù. ÀÌ Àü·«Àº SQL Injection°ú °°ÀÌ ¾Ç¿ëÀÇ ÀáÀçÀû ¿µÇâÀÌ °ÅÁş ±àÁ¤ ¹®Á¦¸¦ °¨»çÇÏ´Â ºÒÆíÇÔº¸´Ù Å« ÀÏºÎ Ãë¾à¼º ¹üÁÖ¿¡ Ã¤ÅÃµÇ¾ú½À´Ï´Ù.

4. Fortify AppDefender adds protection against this category.,9147C5CEBDA6DE4FE869C32D0183E3F5,E04D3E1F-2D8C-400A-BB55-7DA143F987E3,,,,2024-02-13,
Low,Low,Input Validation and Representation,SQL Injection,src/adrui/registerServlet.java,registerServlet.java,,		// TODO Auto-generated method stub
		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");,javax.servlet.ServletRequest.getParameter(),src/adrui/LoginModel.java,LoginModel.java,,	public String check(Connection conn, String user, String pass) throws SQLException{
		state = conn.createStatement();
		rs = state.executeQuery(sql);
		while(rs.next()){
			if(rs.getString(2).equals(user)){,executeQuery(),LoginModel.javaÀÇ 9 ÁÙ¿¡¼­ check() ¸Ş¼­µå´Â ÀáÀçÀûÀ¸·Î ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ ³ª¿Â ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ¸¸µé¾îÁø SQL Äõ¸®¸¦ È£ÃâÇÕ´Ï´Ù. ÀÌ È£ÃâÀ» »ç¿ëÇÏ¿© °ø°İÀÚ´Â ÇØ´ç ¹®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ°Å³ª ÀÓÀÇÀÇ SQL ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.,LoginModel.javaÀÇ 9 ÁÙ¿¡¼­ check() ¸Ş¼­µå´Â ÀáÀçÀûÀ¸·Î ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ ³ª¿Â ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ¸¸µé¾îÁø SQL Äõ¸®¸¦ È£ÃâÇÕ´Ï´Ù. ÀÌ È£ÃâÀ» »ç¿ëÇÏ¿© °ø°İÀÚ´Â ÇØ´ç ¹®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ°Å³ª ÀÓÀÇÀÇ SQL ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.,SQL injection ¿À·ù´Â ´ÙÀ½ °æ¿ì¿¡ ¹ß»ıÇÕ´Ï´Ù.

1. ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ µ¥ÀÌÅÍ°¡ ÇÁ·Î±×·¥¿¡ ÀÔ·ÂµË´Ï´Ù.

ÀÌ·± °æ¿ì, Fortify Static Code Analyzer´Â µ¥ÀÌÅÍ ¼Ò½º¸¦ ½Å·ÚÇÒ ¼ö ÀÖ´Â °ÍÀ¸·Î ÆÇ´ÜÇÏÁö ¾Ê½À´Ï´Ù.

2. µ¥ÀÌÅÍ¸¦ »ç¿ëÇÏ¿© SQL Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÕ´Ï´Ù.



¿¹Á¦ 1: ´ÙÀ½ ÄÚµå´Â ÁöÁ¤µÈ ÀÌ¸§°ú ÀÏÄ¡ÇÏ´Â Ç×¸ñÀ» °Ë»öÇÏ´Â SQL Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÏ°í ½ÇÇàÇÕ´Ï´Ù. Äõ¸®´Â Ç¥½ÃµÇ´Â Ç×¸ñÀ» Ç×¸ñ ¼ÒÀ¯ÀÚ°¡ ÇöÀç ÀÎÁõµÈ »ç¿ëÀÚÀÇ ÀÌ¸§°ú ÀÏÄ¡ÇÏ´Â Ç×¸ñÀ¸·Î Á¦ÇÑÇÕ´Ï´Ù.


...
	String userName = ctx.getAuthenticatedUserName();
	String itemName = request.getParameter("itemName");
	String query = "SELECT * FROM items WHERE owner = '"
				+ userName + "' AND itemname = '"
				+ itemName + "'";
	ResultSet rs = stmt.execute(query);
...


Äõ¸®´Â ´ÙÀ½ ÄÚµå¸¦ ½ÇÇàÇÏ·Á°í ÇÕ´Ï´Ù.


	SELECT * FROM items
	WHERE owner = <userName>
	AND itemname = <itemName>;


ÇÏÁö¸¸ »ó¼öÀÎ ±âº» Äõ¸® ¹®ÀÚ¿­°ú »ç¿ëÀÚ ÀÔ·Â ¹®ÀÚ¿­À» ¿¬°áÇÏ¿© Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÏ±â ¶§¹®¿¡, Äõ¸®´Â itemName¿¡ ÀÛÀºµû¿ÈÇ¥°¡ µé¾î ÀÖÁö ¾ÊÀº °æ¿ì¿¡¸¸ Á¤È®ÇÏ°Ô µ¿ÀÛÇÕ´Ï´Ù. »ç¿ëÀÚ ÀÌ¸§ÀÌ wileyÀÎ °ø°İÀÚ°¡ itemName¿¡ ¹®ÀÚ¿­ "name' OR 'a'='a"¸¦ ÀÔ·ÂÇÏ¸é Äõ¸®´Â ´ÙÀ½°ú °°ÀÌ »ı¼ºµË´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name' OR 'a'='a';


OR 'a'='a' Á¶°ÇÀ» Ãß°¡ÇÏ¸é where ÀıÀÌ Ç×»ó true·Î Æò°¡ÇÏ±â ¶§¹®¿¡ Äõ¸®´Â ÈÎ¾À °£´ÜÇÑ ´ÙÀ½ Äõ¸®¿Í ³í¸®ÀûÀ¸·Î µ¿ÀÏÇÏ°Ô µË´Ï´Ù.


	SELECT * FROM items;


°ø°İÀÚ´Â ÀÌ·¸°Ô Äõ¸®¸¦ ´Ü¼øÈ­ÇÏ¿© Äõ¸®°¡ ÀÎÁõµÈ »ç¿ëÀÚ°¡ ¼ÒÀ¯ÇÑ Ç×¸ñ¸¸ ¹İÈ¯ÇØ¾ß ÇÑ´Ù´Â ¿ä±¸ »çÇ×À» ¹«½ÃÇÒ ¼ö ÀÖ½À´Ï´Ù. ÀÌÁ¦ Äõ¸®´Â ÁöÁ¤µÈ ¼ÒÀ¯ÀÚ¿Í °ü°è¾øÀÌ items Å×ÀÌºí¿¡ ÀúÀåµÈ ¸ğµç Ç×¸ñÀ» ¹İÈ¯ÇÕ´Ï´Ù.

¿¹Á¦ 2: ÀÌ ¿¹Á¦´Â Example 1¿¡¼­ »ı¼ºÇÏ¿© ¼öÇàÇÑ Äõ¸®¿¡ ¶Ç ´Ù¸¥ ¾Ç¼º °ªÀÌ Àü´ŞµÉ ¶§ÀÇ °á°ú¸¦ °ËÅäÇÕ´Ï´Ù. »ç¿ëÀÚ ÀÌ¸§ÀÌ wileyÀÎ °ø°İÀÚ°¡ itemName¿¡ ¹®ÀÚ¿­ "name'; DELETE FROM items; --"¸¦ ÀÔ·ÂÇÏ¸é Äõ¸®´Â ´ÙÀ½°ú °°Àº µÎ °³ÀÇ Äõ¸®°¡ µË´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name';

	DELETE FROM items;

	--'


Microsoft(R) SQL Server 2000À» Æ÷ÇÔÇÑ ¸¹Àº µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­ ¿©·¯ SQL ¹®À» ¼¼¹ÌÄİ·ĞÀ¸·Î ±¸ºĞÇÏ¿© ÇÑ²¨¹ø¿¡ ½ÇÇàÇÏ´Â °ÍÀ» Çã¿ëÇÕ´Ï´Ù. ÀÌ °ø°İ ¹®ÀÚ¿­Àº ¼¼¹ÌÄİ·ĞÀ¸·Î ±¸ºĞÇÑ ¹®¿¡ ´ëÇÑ ÀÏ°ı ½ÇÇàÀ» Çã¿ëÇÏÁö ¾Ê´Â Oracle ¹× ±âÅ¸ µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­´Â ¿À·ù¸¦ ÀÏÀ¸Å°Áö¸¸ ÀÏ°ı ½ÇÇàÀ» Çã¿ëÇÏ´Â µ¥ÀÌÅÍº£ÀÌ½º¿¡¼­´Â °ø°İÀÚ°¡ ÀÌ·± Á¾·ùÀÇ °ø°İÀ¸·Î µ¥ÀÌÅÍº£ÀÌ½º¿¡ ´ëÇØ ÀÓÀÇÀÇ ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.

¸¶Áö¸·ÀÇ ÇÏÀÌÇÂ ½Ö(--)À» º¸°Ú½À´Ï´Ù. ÀÌ´Â ´ëºÎºĞÀÇ µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­ ÇØ´ç ¹®¿¡ ´ëÇÑ ³ª¸ÓÁö ºÎºĞÀ» ÁÖ¼®À¸·Î Ã³¸®ÇÏ¿© ½ÇÇàÇÏÁö ¸»¶ó´Â ÀÇ¹Ì·Î ÇØ¼®µË´Ï´Ù[4]. ÀÌ °æ¿ì, ÀÌ ÁÖ¼® ¹®ÀÚ´Â ¼öÁ¤µÈ Äõ¸®¿¡¼­ ¸¶Áö¸·ÀÇ ÀÛÀºµû¿ÈÇ¥ ÇÑÂÊÀ» Á¦°ÅÇÏ´Â ¿ªÇÒÀ» ÇÕ´Ï´Ù. ÁÖ¼®À» ÀÌ·± ½ÄÀ¸·Î »ç¿ëÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍº£ÀÌ½º¿¡¼­µµ Example 1¿¡¼­ »ç¿ëµÈ °Í°ú À¯»çÇÑ ¼ÓÀÓ¼ö¸¦ »ç¿ëÇÏ¸é ´ëºÎºĞÀÇ °ø°İÀÌ È¿°ú¸¦ °ÅµÑ ¼ö ÀÖ½À´Ï´Ù. °ø°İÀÚ°¡ ¹®ÀÚ¿­ "name'); DELETE FROM items; SELECT * FROM items WHERE 'a'='a"¸¦ ÀÔ·ÂÇÏ¿© ´ÙÀ½ ¼¼ °¡Áö À¯È¿ÇÑ ¹®À» ¸¸µå´Â °æ¿ìÀÔ´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name';

	DELETE FROM items;

	SELECT * FROM items WHERE 'a'='a';


¸ğ¹ÙÀÏ È¯°æ¿¡¼­´Â SQL Injection°ú °°Àº ÀüÇüÀûÀÎ À¥ ÀÀ¿ë ÇÁ·Î±×·¥ Ãë¾à¼ºÀÌ ¹ß»ıÇÏÁö ¾Ê´Â´Ù°í »ı°¢ÇÏ´Â »ç¿ëÀÚµµ ÀÖ½À´Ï´Ù. ÀÚ±â ÀÚ½ÅÀ» °ø°İÇÏ´Â »ç¿ëÀÚ´Â ¾øÀ» °ÍÀÌ¶ó ¿©±â±â ¶§¹®ÀÔ´Ï´Ù. ±×·¯³ª ¸ğ¹ÙÀÏ ÇÃ·§ÆûÀÇ ÇÙ½É ¿ä¼Ò´Â ´Ù¾çÇÑ ¼Ò½º¿¡¼­ ´Ù¿î·ÎµåµÇ¾î °°Àº ÀåÄ¡¿¡¼­ ÇÔ²² ½ÇÇàµÇ´Â ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ¶ó´Â Á¡À» À¯³äÇØ¾ß ÇÕ´Ï´Ù. Áï ±İÀ¶ ÀÀ¿ë ÇÁ·Î±×·¥°ú ¸È¿ş¾î¸¦ ÇÔ²² ½ÇÇàÇÒ °¡´É¼ºÀÌ ³ôÀ¸¹Ç·Î ÇÁ·Î¼¼½º °£ Åë½ÅÀ» Æ÷ÇÔÇÏµµ·Ï ¸ğ¹ÙÀÏ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ °ø°İ Ç¥¸éÀ» È®ÀåÇØ¾ß ÇÕ´Ï´Ù.

¿¹Á¦ 3: ´ÙÀ½ ÄÚµå´Â Example 1À» Android ÇÃ·§Æû¿¡ ¸Â°Ô Á¶Á¤ÇÕ´Ï´Ù.


...
        PasswordAuthentication pa = authenticator.getPasswordAuthentication();
        String userName = pa.getUserName();
        String itemName = this.getIntent().getExtras().getString("itemName");
        String query = "SELECT * FROM items WHERE owner = '"
                                + userName + "' AND itemname = '"
                                + itemName + "'";
        SQLiteDatabase db = this.openOrCreateDatabase("DB", MODE_PRIVATE, null);
        Cursor c = db.rawQuery(query, null);
...


SQL Injection °ø°İÀ» ¹æÁöÇÏ´Â ÇÑ °¡Áö ±âÁ¸ÀÇ Á¢±Ù ¹æ½ÄÀº °ø°İÀ» ÀÔ·Â°ª °ËÁõ ¹®Á¦·Î Ã³¸®ÇÏ°í ¾ÈÀüÇÑ °ª ¸ñ·Ï(Çã¿ë ¸ñ·Ï)ÀÇ ¹®ÀÚ¸¸ ¹Ş°Å³ª ¾ÇÀÇÀûÀÏ °¡´É¼ºÀÌ ÀÖ´Â °ª ¸ñ·Ï(°ÅºÎ ¸ñ·Ï)À» ½Äº°ÇÏ¿© ÀÌ½ºÄÉÀÌÇÁ Ã³¸®ÇÏ´Â °ÍÀÔ´Ï´Ù. Çã¿ë ¸ñ·Ï °Ë»ç´Â ¾ö°İÇÑ ÀÔ·Â°ª °ËÁõ ±ÔÄ¢À» ÀÌÇàÇÏ´Â ¸Å¿ì È¿À²ÀûÀÎ ¼ö´ÜÀÌ µÇ±âµµ ÇÏÁö¸¸, ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº À¯Áö °ü¸®°¡ ½±°í º¸´Ù °­·ÂÇÑ º¸¾ÈÀ» Á¦°øÇÒ ¼ö ÀÖ½À´Ï´Ù. ´ëºÎºĞÀÇ °æ¿ì °ÅºÎ ¸ñ·Ï ±¸ÇöÀº SQL Injection °ø°İ ¹æÁöÀÇ È¿°ú¸¦ ¶³¾î¶ß¸®´Â ÇãÁ¡ÀÌ ¾ÆÁÖ ¸¹½À´Ï´Ù. ¿¹¸¦ µé¾î, °ø°İÀÚ´Â ´ÙÀ½°ú °°ÀÌ ÇÒ ¼ö ÀÖ½À´Ï´Ù.

- µû¿ÈÇ¥·Î ¹­Áö ¾ÊÀº ÇÊµå¸¦ ³ë¸³´Ï´Ù.
- ÀÌ½ºÄÉÀÌÇÁ Ã³¸®µÈ ¸ŞÅ¸ ¹®ÀÚ¸¦ »ç¿ëÇÒ ÇÊ¿ä°¡ ¾ø´Â ¹æ¹ıÀ» Ã£½À´Ï´Ù.
- ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)¸¦ »ç¿ëÇÏ¿© »ğÀÔµÈ ¸ŞÅ¸ ¹®ÀÚ¸¦ ¼û±é´Ï´Ù.

SQL Äõ¸®¿¡ ÀÔ·ÂÇÒ ¶§ ¼öµ¿À¸·Î ¹®ÀÚ¸¦ ÀÌ½ºÄÉÀÌÇÁ Ã³¸®ÇÏ´Â ¹æ¹ıµµ ÀÖÁö¸¸ ÀÌ°ÍÀ¸·Î SQL injection °ø°İÀ¸·ÎºÎÅÍ ÀÀ¿ë ÇÁ·Î±×·¥À» º¸È£ÇÒ ¼ö´Â ¾ø½À´Ï´Ù.

SQL injection °ø°İÀ» ´Ù·ç´Â µ¥ ÁÖ·Î Á¦½ÃµÇ´Â ´Ù¸¥ ¼Ö·ç¼ÇÀº ÀúÀå ÇÁ·Î½ÃÀú(stored procedure)¸¦ »ç¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏºÎ À¯ÇüÀÇ SQL injection °ø°İÀº ¸·À» ¼ö ÀÖÁö¸¸ ´Ù¸¥ ¸¹Àº À¯ÇüÀº ¸·Áö ¸øÇÕ´Ï´Ù. ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏ¹İÀûÀ¸·Î ¸Å°³ º¯¼ö¿¡ Àü´ŞµÇ´Â SQL ¹®ÀÇ À¯ÇüÀ» Á¦ÇÑÇÏ¿© SQL injection °ø°İÀ» ¸·½À´Ï´Ù. ÇÏÁö¸¸ ÀÌ Á¦¾àÀ» ÇÇÇÒ ¼ö ÀÖ´Â ¸¹Àº ¹æ¹ıÀÌ ÀÖ¾î ¼ö¸¹Àº ºñÁ¤»óÀûÀÎ ¹®À» ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)¿¡ Àü´ŞÇÒ ¼ö ÀÖ½À´Ï´Ù. µÇÇ®ÀÌÇÏÁö¸¸, ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏºÎ ÀÍ½ºÇÃ·ÎÀÌÆ®´Â ¸·À» ¼ö ÀÖÁö¸¸ ÀÀ¿ë ÇÁ·Î±×·¥À» SQL injection °ø°İ¿¡ ´ëÇØ ¾ÈÀüÇÏ°Ô º¸È£ÇÒ ¼ö´Â ¾ø½À´Ï´Ù.,SQL injection Ãë¾àÁ¡ÀÇ ¿øÀÎÀº °ø°İÀÚ°¡ SQL Äõ¸®ÀÇ ÄÁÅØ½ºÆ®¸¦ º¯°æÇÏ¿© ÇÁ·Î±×·¡¸Ó°¡ µ¥ÀÌÅÍ·Î ÇØ¼®µÇ±â¸¦ ¹Ù¶ó´Â °ªÀ» ¸í·ÉÀ¸·Î ÇØ¼®µÇµµ·Ï ¸¸µé ¼ö ÀÖ´Ù´Â Á¡ÀÔ´Ï´Ù. SQL Äõ¸®¸¦ »ı¼ºÇÒ ¶§, ÇÁ·Î±×·¡¸Ó´Â ¹«¾ùÀÌ ¸í·ÉÀ¸·Î ÇØ¼®µÇ¾î¾ß ÇÏ°í ¹«¾ùÀÌ µ¥ÀÌÅÍ·Î ÇØ¼®µÇ¾î¾ß ÇÏ´ÂÁö ¾Ë°í ÀÖ½À´Ï´Ù. ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº µ¥ÀÌÅÍ À§ÁÖÀÇ ÄÁÅØ½ºÆ® º¯°æÀ» Çã¿ëÇÏÁö ¾Ê°í °ÅÀÇ ¸ğµç SQL injection °ø°İÀ» ¹æÁöÇÏ¿© ÀÌ¸¦ ÀÌÇàÇÕ´Ï´Ù. ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº ÀÏ¹İ SQL ¹®ÀÚ¿­À» »ç¿ëÇÏ¿© »ı¼ºµÇÁö¸¸, »ç¿ëÀÚ°¡ Á¦°øÇÏ´Â µ¥ÀÌÅÍ¸¦ Æ÷ÇÔÇØ¾ß ÇÏ´Â °æ¿ì¿¡ ÀÌÈÄ¿¡ »ğÀÔµÇ´Â µ¥ÀÌÅÍÀÇ ÀÚ¸® Ç¥½ÃÀÚÀÎ ¹ÙÀÎµù ¸Å°³ º¯¼ö¸¦ »ı¼ºÇÕ´Ï´Ù. ¹ÙÀÎµù ¸Å°³ º¯¼ö¸¦ »ç¿ëÇÏ¸é ÇÁ·Î±×·¥ÀÌ ¸í·ÉÀ¸·Î Ã³¸®ÇØ¾ß ÇÒ °Í°ú µ¥ÀÌÅÍ·Î Ã³¸®ÇØ¾ß ÇÒ °ÍÀ» µ¥ÀÌÅÍº£ÀÌ½º¿¡ ¸í½ÃÀûÀ¸·Î ÁöÁ¤ÇÒ ¼ö ÀÖ½À´Ï´Ù. ÇÁ·Î±×·¥ÀÌ ¹®À» ½ÇÇàÇÒ ÁØºñ°¡ µÇ¸é °¢ ¹ÙÀÎµù ¸Å°³ º¯¼ö¿¡ »ç¿ëÇÒ ·±Å¸ÀÓ °ªÀ» µ¥ÀÌÅÍº£ÀÌ½º¿¡ ÁöÁ¤ÇÏ¿© µ¥ÀÌÅÍ°¡ ¸í·ÉÀ¸·Î ÇØ¼®µÉ À§ÇèÀ» ÇÇÇÒ ¼ö ÀÖ½À´Ï´Ù. 

»ç¿ëÀÚ°¡ Á¦°øÇÏ´Â ¹®ÀÚ¿­À» ¿¬°áÇÏ´Â ´ë½Å ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏµµ·Ï ´ÙÀ½°ú °°ÀÌ ¿¹Á¦ 1À» ´Ù½Ã ÀÛ¼ºÇÒ ¼ö ÀÖ½À´Ï´Ù.


...
	String userName = ctx.getAuthenticatedUserName();
	String itemName = request.getParameter("itemName");
	String query =
        	"SELECT * FROM items WHERE itemname=? AND owner=?";
	PreparedStatement stmt = conn.prepareStatement(query);
	stmt.setString(1, itemName);
	stmt.setString(2, userName);
	ResultSet results = stmt.execute();
...


Android¿¡ ÇØ´çÇÏ´Â ÄÚµå´Â ´ÙÀ½°ú °°½À´Ï´Ù.


...
	PasswordAuthentication pa = authenticator.getPasswordAuthentication();
	String userName = pa.getUserName();
	String itemName = this.getIntent().getExtras().getString("itemName");
	String query = "SELECT * FROM items WHERE itemname=? AND owner=?";
	SQLiteDatabase db = this.openOrCreateDatabase("DB", MODE_PRIVATE, null);
	Cursor c = db.rawQuery(query, new Object[]{itemName, userName});
...


ÈçÈ÷ º¸°í¼­ »ı¼º ÄÚµå¿¡¼­ º¼ ¼ö ÀÖ´Â º¹ÀâÇÑ ½Ã³ª¸®¿À¿¡¼­´Â WHERE ÀıÀÇ µ¿Àû Á¦¾à Á¶°Ç Ãß°¡¿Í °°ÀÌ, SQL ¹®ÀÇ ¸í·É ±¸Á¶°¡ °áÁ¤µÇ´Â »ç¿ëÀÚ ÀÔ·ÂÀÌ ÇÊ¿äÇÕ´Ï´Ù. ±×·¸´Ù°í ÀÌ ¿ä±¸ »çÇ×ÀÌ »ç¿ëÀÚ ÀÔ·ÂÀ» ¿¬°áÇÏ¿© Äõ¸® ¹®ÀÚ¿­À» ¸¸µå´Â °ÍÀ» Á¤´çÈ­ÇÒ ¼ö´Â ¾ø½À´Ï´Ù. »ç¿ëÀÚ ÀÔ·ÂÀ» SQL ¹® ¸í·É ±¸Á¶¿¡ Àû¿ëÇØ¾ß ÇÏ´Â °æ¿ì °£Á¢ ÂüÁ¶¸¦ »ç¿ëÇÏ¿© SQL injection °ø°İÀ» ¿¹¹æÇÕ´Ï´Ù. Áï, SQL ¹®¿¡ Æ÷ÇÔ½ÃÅ³ ¿©·¯ ¿ä¼Ò¿¡ ÇØ´çÇÏ´Â À¯È¿ÇÑ ¹®ÀÚ¿­ ÁıÇÕÀ» ¸¸µì´Ï´Ù. ¹®À» ¸¸µé ¶§ »ç¿ëÀÚ ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ÀÌ ÀÀ¿ë ÇÁ·Î±×·¥ Á¦¾î °ª ÁıÇÕ¿¡¼­ °ªÀ» ¼±ÅÃÇÕ´Ï´Ù.,1. ÀÌ ¶§, ÈçÈ÷ ÀúÁö¸£´Â ½Ç¼ö´Â »ç¿ëÀÚ°¡ Á¦¾îÇÏ´Â ¹®ÀÚ¿­À» ¿¬°áÇÏ¿© »ı¼ºÇÑ, ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. ¹°·Ğ ÀÌ·¸°Ô ÇÏ¸é ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏ´Â ¸ñÀûÀÌ ¹«»êµË´Ï´Ù. SQL ¹®À» Çü¼ºÇÏ´Â ¹®ÀÚ¿­ÀÌ ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­ Á¦¾îÇÏ´Â »ó¼öÀÎÁö È®½ÅÇÒ ¼ö ¾ø´Â °æ¿ì, ¹®ÀÚ¿­ÀÌ SQL ¹®ÀÚ¿­·Î Á÷Á¢ ½ÇÇàµÇÁö ¾Ê±â ¶§¹®¿¡ ¾ÈÀüÇÏ´Ù°í °¡Á¤ÇÒ ¼ö ¾ø½À´Ï´Ù. SQL ¹®¿¡¼­ »ç¿ëÀÚ Á¦¾î ¹®ÀÚ¿­ÀÇ ¸ğµç »ç¿ëÀ» Ã¶ÀúÇÏ°Ô Á¶»çÇÏ°í Äõ¸®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ´Â µ¥ »ç¿ëµÇ´Â ÀÏÀÌ ¾ø´ÂÁö È®ÀÎÇØ¾ß ÇÕ´Ï´Ù.

2. µ¥ÀÌÅÍ°¡ Å¬·¡½ºÀÇ °ø¿ë ºñ final ¹®ÀÚ¿­ ÇÊµå¿¡¼­ ¿À´Â °æ¿ì ÀÌ µ¥ÀÌÅÍ´Â ½Å·ÚÇÒ ¼ö ¾ø½À´Ï´Ù. ÀÌ·¯ÇÑ À¯ÇüÀÇ ÇÊµå´Â ¾Ë·ÁÁöÁö ¾ÊÀº ¼Ò½º¿¡ ÀÇÇØ ¼öÁ¤µÉ ¼ö ÀÖ½À´Ï´Ù.

3. SQL Injection ¹®Á¦´Â µ¥ÀÌÅÍ Èå¸§ ¼öÁ¤ ÀÛ¾÷ ÈÄ¿¡µµ °è¼ÓÇØ¼­ º¸°íµÉ ¼ö ÀÖ½À´Ï´Ù(¿ì¼± ¼øÀ§ °ªÀº °¨¼Ò). Fortify Static Code Analyzer¿¡¼­ »ç¿ëÀÚ Á¦¾î ÀÔ·ÂÀÌ SQL ¹® ±¸¼º¿¡ »ç¿ëµÇ°í ÀÖ´Ù´Â ºĞ¸íÇÑ µ¥ÀÌÅÍ Èå¸§ Áõ°Å°¡ ¹ß°ßµÇ¸é ³ôÀ½/½É°¢ ¿ì¼± ¼øÀ§ÀÇ µ¥ÀÌÅÍ Èå¸§ ¹®Á¦°¡ º¸°íµË´Ï´Ù. Fortify Static Code Analyzer¿¡¼­ µ¥ÀÌÅÍ ¼Ò½º¸¦ °áÁ¤ÇÒ ¼ö ¾ø°í ¼Ò½º°¡ µ¿ÀûÀ¸·Î º¯°æµÉ ¼ö ÀÖ´Â °æ¿ì ³·À½/Áß°£ ¿ì¼± ¼øÀ§ÀÇ ÀÇ¹Ì Ã¼°è ¹®Á¦°¡ º¸°íµË´Ï´Ù. ÀÌ Àü·«Àº SQL Injection°ú °°ÀÌ ¾Ç¿ëÀÇ ÀáÀçÀû ¿µÇâÀÌ °ÅÁş ±àÁ¤ ¹®Á¦¸¦ °¨»çÇÏ´Â ºÒÆíÇÔº¸´Ù Å« ÀÏºÎ Ãë¾à¼º ¹üÁÖ¿¡ Ã¤ÅÃµÇ¾ú½À´Ï´Ù.

4. Fortify AppDefender adds protection against this category.,E05BD34011271AF74D20BA4CC2F53A2E,4B673A45-9AD5-4CBA-945B-11A3702CDF57,,,,2024-02-13,
Critical,Critical,Input Validation and Representation,SQL Injection,src/adrui/registerServlet.java,registerServlet.java,,		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));
		try{,javax.servlet.ServletRequest.getParameter(),src/adrui/registerServlet.java,registerServlet.java,,				System.out.println("f = true");
				sql = "insert into user values('" + sno + "', '" + user + "', '" + pass + "')";
				state.executeUpdate(sql);		
				
			},java.sql.Statement.executeUpdate(),registerServlet.javaÀÇ 64 ÁÙ¿¡¼­ doPost() ¸Ş¼­µå´Â ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ ³ª¿Â ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ¸¸µé¾îÁø SQL Äõ¸®¸¦ È£ÃâÇÕ´Ï´Ù. ÀÌ È£ÃâÀ» »ç¿ëÇÏ¿© °ø°İÀÚ´Â ÇØ´ç ¹®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ°Å³ª ÀÓÀÇÀÇ SQL ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.,LoginModel.javaÀÇ 9 ÁÙ¿¡¼­ check() ¸Ş¼­µå´Â ÀáÀçÀûÀ¸·Î ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ ³ª¿Â ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ¸¸µé¾îÁø SQL Äõ¸®¸¦ È£ÃâÇÕ´Ï´Ù. ÀÌ È£ÃâÀ» »ç¿ëÇÏ¿© °ø°İÀÚ´Â ÇØ´ç ¹®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ°Å³ª ÀÓÀÇÀÇ SQL ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.,SQL injection ¿À·ù´Â ´ÙÀ½ °æ¿ì¿¡ ¹ß»ıÇÕ´Ï´Ù.

1. ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ µ¥ÀÌÅÍ°¡ ÇÁ·Î±×·¥¿¡ ÀÔ·ÂµË´Ï´Ù.

ÀÌ·± °æ¿ì, Fortify Static Code Analyzer´Â µ¥ÀÌÅÍ ¼Ò½º¸¦ ½Å·ÚÇÒ ¼ö ÀÖ´Â °ÍÀ¸·Î ÆÇ´ÜÇÏÁö ¾Ê½À´Ï´Ù.

2. µ¥ÀÌÅÍ¸¦ »ç¿ëÇÏ¿© SQL Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÕ´Ï´Ù.



¿¹Á¦ 1: ´ÙÀ½ ÄÚµå´Â ÁöÁ¤µÈ ÀÌ¸§°ú ÀÏÄ¡ÇÏ´Â Ç×¸ñÀ» °Ë»öÇÏ´Â SQL Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÏ°í ½ÇÇàÇÕ´Ï´Ù. Äõ¸®´Â Ç¥½ÃµÇ´Â Ç×¸ñÀ» Ç×¸ñ ¼ÒÀ¯ÀÚ°¡ ÇöÀç ÀÎÁõµÈ »ç¿ëÀÚÀÇ ÀÌ¸§°ú ÀÏÄ¡ÇÏ´Â Ç×¸ñÀ¸·Î Á¦ÇÑÇÕ´Ï´Ù.


...
	String userName = ctx.getAuthenticatedUserName();
	String itemName = request.getParameter("itemName");
	String query = "SELECT * FROM items WHERE owner = '"
				+ userName + "' AND itemname = '"
				+ itemName + "'";
	ResultSet rs = stmt.execute(query);
...


Äõ¸®´Â ´ÙÀ½ ÄÚµå¸¦ ½ÇÇàÇÏ·Á°í ÇÕ´Ï´Ù.


	SELECT * FROM items
	WHERE owner = <userName>
	AND itemname = <itemName>;


ÇÏÁö¸¸ »ó¼öÀÎ ±âº» Äõ¸® ¹®ÀÚ¿­°ú »ç¿ëÀÚ ÀÔ·Â ¹®ÀÚ¿­À» ¿¬°áÇÏ¿© Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÏ±â ¶§¹®¿¡, Äõ¸®´Â itemName¿¡ ÀÛÀºµû¿ÈÇ¥°¡ µé¾î ÀÖÁö ¾ÊÀº °æ¿ì¿¡¸¸ Á¤È®ÇÏ°Ô µ¿ÀÛÇÕ´Ï´Ù. »ç¿ëÀÚ ÀÌ¸§ÀÌ wileyÀÎ °ø°İÀÚ°¡ itemName¿¡ ¹®ÀÚ¿­ "name' OR 'a'='a"¸¦ ÀÔ·ÂÇÏ¸é Äõ¸®´Â ´ÙÀ½°ú °°ÀÌ »ı¼ºµË´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name' OR 'a'='a';


OR 'a'='a' Á¶°ÇÀ» Ãß°¡ÇÏ¸é where ÀıÀÌ Ç×»ó true·Î Æò°¡ÇÏ±â ¶§¹®¿¡ Äõ¸®´Â ÈÎ¾À °£´ÜÇÑ ´ÙÀ½ Äõ¸®¿Í ³í¸®ÀûÀ¸·Î µ¿ÀÏÇÏ°Ô µË´Ï´Ù.


	SELECT * FROM items;


°ø°İÀÚ´Â ÀÌ·¸°Ô Äõ¸®¸¦ ´Ü¼øÈ­ÇÏ¿© Äõ¸®°¡ ÀÎÁõµÈ »ç¿ëÀÚ°¡ ¼ÒÀ¯ÇÑ Ç×¸ñ¸¸ ¹İÈ¯ÇØ¾ß ÇÑ´Ù´Â ¿ä±¸ »çÇ×À» ¹«½ÃÇÒ ¼ö ÀÖ½À´Ï´Ù. ÀÌÁ¦ Äõ¸®´Â ÁöÁ¤µÈ ¼ÒÀ¯ÀÚ¿Í °ü°è¾øÀÌ items Å×ÀÌºí¿¡ ÀúÀåµÈ ¸ğµç Ç×¸ñÀ» ¹İÈ¯ÇÕ´Ï´Ù.

¿¹Á¦ 2: ÀÌ ¿¹Á¦´Â Example 1¿¡¼­ »ı¼ºÇÏ¿© ¼öÇàÇÑ Äõ¸®¿¡ ¶Ç ´Ù¸¥ ¾Ç¼º °ªÀÌ Àü´ŞµÉ ¶§ÀÇ °á°ú¸¦ °ËÅäÇÕ´Ï´Ù. »ç¿ëÀÚ ÀÌ¸§ÀÌ wileyÀÎ °ø°İÀÚ°¡ itemName¿¡ ¹®ÀÚ¿­ "name'; DELETE FROM items; --"¸¦ ÀÔ·ÂÇÏ¸é Äõ¸®´Â ´ÙÀ½°ú °°Àº µÎ °³ÀÇ Äõ¸®°¡ µË´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name';

	DELETE FROM items;

	--'


Microsoft(R) SQL Server 2000À» Æ÷ÇÔÇÑ ¸¹Àº µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­ ¿©·¯ SQL ¹®À» ¼¼¹ÌÄİ·ĞÀ¸·Î ±¸ºĞÇÏ¿© ÇÑ²¨¹ø¿¡ ½ÇÇàÇÏ´Â °ÍÀ» Çã¿ëÇÕ´Ï´Ù. ÀÌ °ø°İ ¹®ÀÚ¿­Àº ¼¼¹ÌÄİ·ĞÀ¸·Î ±¸ºĞÇÑ ¹®¿¡ ´ëÇÑ ÀÏ°ı ½ÇÇàÀ» Çã¿ëÇÏÁö ¾Ê´Â Oracle ¹× ±âÅ¸ µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­´Â ¿À·ù¸¦ ÀÏÀ¸Å°Áö¸¸ ÀÏ°ı ½ÇÇàÀ» Çã¿ëÇÏ´Â µ¥ÀÌÅÍº£ÀÌ½º¿¡¼­´Â °ø°İÀÚ°¡ ÀÌ·± Á¾·ùÀÇ °ø°İÀ¸·Î µ¥ÀÌÅÍº£ÀÌ½º¿¡ ´ëÇØ ÀÓÀÇÀÇ ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.

¸¶Áö¸·ÀÇ ÇÏÀÌÇÂ ½Ö(--)À» º¸°Ú½À´Ï´Ù. ÀÌ´Â ´ëºÎºĞÀÇ µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­ ÇØ´ç ¹®¿¡ ´ëÇÑ ³ª¸ÓÁö ºÎºĞÀ» ÁÖ¼®À¸·Î Ã³¸®ÇÏ¿© ½ÇÇàÇÏÁö ¸»¶ó´Â ÀÇ¹Ì·Î ÇØ¼®µË´Ï´Ù[4]. ÀÌ °æ¿ì, ÀÌ ÁÖ¼® ¹®ÀÚ´Â ¼öÁ¤µÈ Äõ¸®¿¡¼­ ¸¶Áö¸·ÀÇ ÀÛÀºµû¿ÈÇ¥ ÇÑÂÊÀ» Á¦°ÅÇÏ´Â ¿ªÇÒÀ» ÇÕ´Ï´Ù. ÁÖ¼®À» ÀÌ·± ½ÄÀ¸·Î »ç¿ëÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍº£ÀÌ½º¿¡¼­µµ Example 1¿¡¼­ »ç¿ëµÈ °Í°ú À¯»çÇÑ ¼ÓÀÓ¼ö¸¦ »ç¿ëÇÏ¸é ´ëºÎºĞÀÇ °ø°İÀÌ È¿°ú¸¦ °ÅµÑ ¼ö ÀÖ½À´Ï´Ù. °ø°İÀÚ°¡ ¹®ÀÚ¿­ "name'); DELETE FROM items; SELECT * FROM items WHERE 'a'='a"¸¦ ÀÔ·ÂÇÏ¿© ´ÙÀ½ ¼¼ °¡Áö À¯È¿ÇÑ ¹®À» ¸¸µå´Â °æ¿ìÀÔ´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name';

	DELETE FROM items;

	SELECT * FROM items WHERE 'a'='a';


¸ğ¹ÙÀÏ È¯°æ¿¡¼­´Â SQL Injection°ú °°Àº ÀüÇüÀûÀÎ À¥ ÀÀ¿ë ÇÁ·Î±×·¥ Ãë¾à¼ºÀÌ ¹ß»ıÇÏÁö ¾Ê´Â´Ù°í »ı°¢ÇÏ´Â »ç¿ëÀÚµµ ÀÖ½À´Ï´Ù. ÀÚ±â ÀÚ½ÅÀ» °ø°İÇÏ´Â »ç¿ëÀÚ´Â ¾øÀ» °ÍÀÌ¶ó ¿©±â±â ¶§¹®ÀÔ´Ï´Ù. ±×·¯³ª ¸ğ¹ÙÀÏ ÇÃ·§ÆûÀÇ ÇÙ½É ¿ä¼Ò´Â ´Ù¾çÇÑ ¼Ò½º¿¡¼­ ´Ù¿î·ÎµåµÇ¾î °°Àº ÀåÄ¡¿¡¼­ ÇÔ²² ½ÇÇàµÇ´Â ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ¶ó´Â Á¡À» À¯³äÇØ¾ß ÇÕ´Ï´Ù. Áï ±İÀ¶ ÀÀ¿ë ÇÁ·Î±×·¥°ú ¸È¿ş¾î¸¦ ÇÔ²² ½ÇÇàÇÒ °¡´É¼ºÀÌ ³ôÀ¸¹Ç·Î ÇÁ·Î¼¼½º °£ Åë½ÅÀ» Æ÷ÇÔÇÏµµ·Ï ¸ğ¹ÙÀÏ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ °ø°İ Ç¥¸éÀ» È®ÀåÇØ¾ß ÇÕ´Ï´Ù.

¿¹Á¦ 3: ´ÙÀ½ ÄÚµå´Â Example 1À» Android ÇÃ·§Æû¿¡ ¸Â°Ô Á¶Á¤ÇÕ´Ï´Ù.


...
        PasswordAuthentication pa = authenticator.getPasswordAuthentication();
        String userName = pa.getUserName();
        String itemName = this.getIntent().getExtras().getString("itemName");
        String query = "SELECT * FROM items WHERE owner = '"
                                + userName + "' AND itemname = '"
                                + itemName + "'";
        SQLiteDatabase db = this.openOrCreateDatabase("DB", MODE_PRIVATE, null);
        Cursor c = db.rawQuery(query, null);
...


SQL Injection °ø°İÀ» ¹æÁöÇÏ´Â ÇÑ °¡Áö ±âÁ¸ÀÇ Á¢±Ù ¹æ½ÄÀº °ø°İÀ» ÀÔ·Â°ª °ËÁõ ¹®Á¦·Î Ã³¸®ÇÏ°í ¾ÈÀüÇÑ °ª ¸ñ·Ï(Çã¿ë ¸ñ·Ï)ÀÇ ¹®ÀÚ¸¸ ¹Ş°Å³ª ¾ÇÀÇÀûÀÏ °¡´É¼ºÀÌ ÀÖ´Â °ª ¸ñ·Ï(°ÅºÎ ¸ñ·Ï)À» ½Äº°ÇÏ¿© ÀÌ½ºÄÉÀÌÇÁ Ã³¸®ÇÏ´Â °ÍÀÔ´Ï´Ù. Çã¿ë ¸ñ·Ï °Ë»ç´Â ¾ö°İÇÑ ÀÔ·Â°ª °ËÁõ ±ÔÄ¢À» ÀÌÇàÇÏ´Â ¸Å¿ì È¿À²ÀûÀÎ ¼ö´ÜÀÌ µÇ±âµµ ÇÏÁö¸¸, ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº À¯Áö °ü¸®°¡ ½±°í º¸´Ù °­·ÂÇÑ º¸¾ÈÀ» Á¦°øÇÒ ¼ö ÀÖ½À´Ï´Ù. ´ëºÎºĞÀÇ °æ¿ì °ÅºÎ ¸ñ·Ï ±¸ÇöÀº SQL Injection °ø°İ ¹æÁöÀÇ È¿°ú¸¦ ¶³¾î¶ß¸®´Â ÇãÁ¡ÀÌ ¾ÆÁÖ ¸¹½À´Ï´Ù. ¿¹¸¦ µé¾î, °ø°İÀÚ´Â ´ÙÀ½°ú °°ÀÌ ÇÒ ¼ö ÀÖ½À´Ï´Ù.

- µû¿ÈÇ¥·Î ¹­Áö ¾ÊÀº ÇÊµå¸¦ ³ë¸³´Ï´Ù.
- ÀÌ½ºÄÉÀÌÇÁ Ã³¸®µÈ ¸ŞÅ¸ ¹®ÀÚ¸¦ »ç¿ëÇÒ ÇÊ¿ä°¡ ¾ø´Â ¹æ¹ıÀ» Ã£½À´Ï´Ù.
- ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)¸¦ »ç¿ëÇÏ¿© »ğÀÔµÈ ¸ŞÅ¸ ¹®ÀÚ¸¦ ¼û±é´Ï´Ù.

SQL Äõ¸®¿¡ ÀÔ·ÂÇÒ ¶§ ¼öµ¿À¸·Î ¹®ÀÚ¸¦ ÀÌ½ºÄÉÀÌÇÁ Ã³¸®ÇÏ´Â ¹æ¹ıµµ ÀÖÁö¸¸ ÀÌ°ÍÀ¸·Î SQL injection °ø°İÀ¸·ÎºÎÅÍ ÀÀ¿ë ÇÁ·Î±×·¥À» º¸È£ÇÒ ¼ö´Â ¾ø½À´Ï´Ù.

SQL injection °ø°İÀ» ´Ù·ç´Â µ¥ ÁÖ·Î Á¦½ÃµÇ´Â ´Ù¸¥ ¼Ö·ç¼ÇÀº ÀúÀå ÇÁ·Î½ÃÀú(stored procedure)¸¦ »ç¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏºÎ À¯ÇüÀÇ SQL injection °ø°İÀº ¸·À» ¼ö ÀÖÁö¸¸ ´Ù¸¥ ¸¹Àº À¯ÇüÀº ¸·Áö ¸øÇÕ´Ï´Ù. ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏ¹İÀûÀ¸·Î ¸Å°³ º¯¼ö¿¡ Àü´ŞµÇ´Â SQL ¹®ÀÇ À¯ÇüÀ» Á¦ÇÑÇÏ¿© SQL injection °ø°İÀ» ¸·½À´Ï´Ù. ÇÏÁö¸¸ ÀÌ Á¦¾àÀ» ÇÇÇÒ ¼ö ÀÖ´Â ¸¹Àº ¹æ¹ıÀÌ ÀÖ¾î ¼ö¸¹Àº ºñÁ¤»óÀûÀÎ ¹®À» ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)¿¡ Àü´ŞÇÒ ¼ö ÀÖ½À´Ï´Ù. µÇÇ®ÀÌÇÏÁö¸¸, ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏºÎ ÀÍ½ºÇÃ·ÎÀÌÆ®´Â ¸·À» ¼ö ÀÖÁö¸¸ ÀÀ¿ë ÇÁ·Î±×·¥À» SQL injection °ø°İ¿¡ ´ëÇØ ¾ÈÀüÇÏ°Ô º¸È£ÇÒ ¼ö´Â ¾ø½À´Ï´Ù.,SQL injection Ãë¾àÁ¡ÀÇ ¿øÀÎÀº °ø°İÀÚ°¡ SQL Äõ¸®ÀÇ ÄÁÅØ½ºÆ®¸¦ º¯°æÇÏ¿© ÇÁ·Î±×·¡¸Ó°¡ µ¥ÀÌÅÍ·Î ÇØ¼®µÇ±â¸¦ ¹Ù¶ó´Â °ªÀ» ¸í·ÉÀ¸·Î ÇØ¼®µÇµµ·Ï ¸¸µé ¼ö ÀÖ´Ù´Â Á¡ÀÔ´Ï´Ù. SQL Äõ¸®¸¦ »ı¼ºÇÒ ¶§, ÇÁ·Î±×·¡¸Ó´Â ¹«¾ùÀÌ ¸í·ÉÀ¸·Î ÇØ¼®µÇ¾î¾ß ÇÏ°í ¹«¾ùÀÌ µ¥ÀÌÅÍ·Î ÇØ¼®µÇ¾î¾ß ÇÏ´ÂÁö ¾Ë°í ÀÖ½À´Ï´Ù. ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº µ¥ÀÌÅÍ À§ÁÖÀÇ ÄÁÅØ½ºÆ® º¯°æÀ» Çã¿ëÇÏÁö ¾Ê°í °ÅÀÇ ¸ğµç SQL injection °ø°İÀ» ¹æÁöÇÏ¿© ÀÌ¸¦ ÀÌÇàÇÕ´Ï´Ù. ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº ÀÏ¹İ SQL ¹®ÀÚ¿­À» »ç¿ëÇÏ¿© »ı¼ºµÇÁö¸¸, »ç¿ëÀÚ°¡ Á¦°øÇÏ´Â µ¥ÀÌÅÍ¸¦ Æ÷ÇÔÇØ¾ß ÇÏ´Â °æ¿ì¿¡ ÀÌÈÄ¿¡ »ğÀÔµÇ´Â µ¥ÀÌÅÍÀÇ ÀÚ¸® Ç¥½ÃÀÚÀÎ ¹ÙÀÎµù ¸Å°³ º¯¼ö¸¦ »ı¼ºÇÕ´Ï´Ù. ¹ÙÀÎµù ¸Å°³ º¯¼ö¸¦ »ç¿ëÇÏ¸é ÇÁ·Î±×·¥ÀÌ ¸í·ÉÀ¸·Î Ã³¸®ÇØ¾ß ÇÒ °Í°ú µ¥ÀÌÅÍ·Î Ã³¸®ÇØ¾ß ÇÒ °ÍÀ» µ¥ÀÌÅÍº£ÀÌ½º¿¡ ¸í½ÃÀûÀ¸·Î ÁöÁ¤ÇÒ ¼ö ÀÖ½À´Ï´Ù. ÇÁ·Î±×·¥ÀÌ ¹®À» ½ÇÇàÇÒ ÁØºñ°¡ µÇ¸é °¢ ¹ÙÀÎµù ¸Å°³ º¯¼ö¿¡ »ç¿ëÇÒ ·±Å¸ÀÓ °ªÀ» µ¥ÀÌÅÍº£ÀÌ½º¿¡ ÁöÁ¤ÇÏ¿© µ¥ÀÌÅÍ°¡ ¸í·ÉÀ¸·Î ÇØ¼®µÉ À§ÇèÀ» ÇÇÇÒ ¼ö ÀÖ½À´Ï´Ù. 

»ç¿ëÀÚ°¡ Á¦°øÇÏ´Â ¹®ÀÚ¿­À» ¿¬°áÇÏ´Â ´ë½Å ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏµµ·Ï ´ÙÀ½°ú °°ÀÌ ¿¹Á¦ 1À» ´Ù½Ã ÀÛ¼ºÇÒ ¼ö ÀÖ½À´Ï´Ù.


...
	String userName = ctx.getAuthenticatedUserName();
	String itemName = request.getParameter("itemName");
	String query =
        	"SELECT * FROM items WHERE itemname=? AND owner=?";
	PreparedStatement stmt = conn.prepareStatement(query);
	stmt.setString(1, itemName);
	stmt.setString(2, userName);
	ResultSet results = stmt.execute();
...


Android¿¡ ÇØ´çÇÏ´Â ÄÚµå´Â ´ÙÀ½°ú °°½À´Ï´Ù.


...
	PasswordAuthentication pa = authenticator.getPasswordAuthentication();
	String userName = pa.getUserName();
	String itemName = this.getIntent().getExtras().getString("itemName");
	String query = "SELECT * FROM items WHERE itemname=? AND owner=?";
	SQLiteDatabase db = this.openOrCreateDatabase("DB", MODE_PRIVATE, null);
	Cursor c = db.rawQuery(query, new Object[]{itemName, userName});
...


ÈçÈ÷ º¸°í¼­ »ı¼º ÄÚµå¿¡¼­ º¼ ¼ö ÀÖ´Â º¹ÀâÇÑ ½Ã³ª¸®¿À¿¡¼­´Â WHERE ÀıÀÇ µ¿Àû Á¦¾à Á¶°Ç Ãß°¡¿Í °°ÀÌ, SQL ¹®ÀÇ ¸í·É ±¸Á¶°¡ °áÁ¤µÇ´Â »ç¿ëÀÚ ÀÔ·ÂÀÌ ÇÊ¿äÇÕ´Ï´Ù. ±×·¸´Ù°í ÀÌ ¿ä±¸ »çÇ×ÀÌ »ç¿ëÀÚ ÀÔ·ÂÀ» ¿¬°áÇÏ¿© Äõ¸® ¹®ÀÚ¿­À» ¸¸µå´Â °ÍÀ» Á¤´çÈ­ÇÒ ¼ö´Â ¾ø½À´Ï´Ù. »ç¿ëÀÚ ÀÔ·ÂÀ» SQL ¹® ¸í·É ±¸Á¶¿¡ Àû¿ëÇØ¾ß ÇÏ´Â °æ¿ì °£Á¢ ÂüÁ¶¸¦ »ç¿ëÇÏ¿© SQL injection °ø°İÀ» ¿¹¹æÇÕ´Ï´Ù. Áï, SQL ¹®¿¡ Æ÷ÇÔ½ÃÅ³ ¿©·¯ ¿ä¼Ò¿¡ ÇØ´çÇÏ´Â À¯È¿ÇÑ ¹®ÀÚ¿­ ÁıÇÕÀ» ¸¸µì´Ï´Ù. ¹®À» ¸¸µé ¶§ »ç¿ëÀÚ ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ÀÌ ÀÀ¿ë ÇÁ·Î±×·¥ Á¦¾î °ª ÁıÇÕ¿¡¼­ °ªÀ» ¼±ÅÃÇÕ´Ï´Ù.,1. ÀÌ ¶§, ÈçÈ÷ ÀúÁö¸£´Â ½Ç¼ö´Â »ç¿ëÀÚ°¡ Á¦¾îÇÏ´Â ¹®ÀÚ¿­À» ¿¬°áÇÏ¿© »ı¼ºÇÑ, ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. ¹°·Ğ ÀÌ·¸°Ô ÇÏ¸é ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏ´Â ¸ñÀûÀÌ ¹«»êµË´Ï´Ù. SQL ¹®À» Çü¼ºÇÏ´Â ¹®ÀÚ¿­ÀÌ ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­ Á¦¾îÇÏ´Â »ó¼öÀÎÁö È®½ÅÇÒ ¼ö ¾ø´Â °æ¿ì, ¹®ÀÚ¿­ÀÌ SQL ¹®ÀÚ¿­·Î Á÷Á¢ ½ÇÇàµÇÁö ¾Ê±â ¶§¹®¿¡ ¾ÈÀüÇÏ´Ù°í °¡Á¤ÇÒ ¼ö ¾ø½À´Ï´Ù. SQL ¹®¿¡¼­ »ç¿ëÀÚ Á¦¾î ¹®ÀÚ¿­ÀÇ ¸ğµç »ç¿ëÀ» Ã¶ÀúÇÏ°Ô Á¶»çÇÏ°í Äõ¸®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ´Â µ¥ »ç¿ëµÇ´Â ÀÏÀÌ ¾ø´ÂÁö È®ÀÎÇØ¾ß ÇÕ´Ï´Ù.

2. µ¥ÀÌÅÍ°¡ Å¬·¡½ºÀÇ °ø¿ë ºñ final ¹®ÀÚ¿­ ÇÊµå¿¡¼­ ¿À´Â °æ¿ì ÀÌ µ¥ÀÌÅÍ´Â ½Å·ÚÇÒ ¼ö ¾ø½À´Ï´Ù. ÀÌ·¯ÇÑ À¯ÇüÀÇ ÇÊµå´Â ¾Ë·ÁÁöÁö ¾ÊÀº ¼Ò½º¿¡ ÀÇÇØ ¼öÁ¤µÉ ¼ö ÀÖ½À´Ï´Ù.

3. SQL Injection ¹®Á¦´Â µ¥ÀÌÅÍ Èå¸§ ¼öÁ¤ ÀÛ¾÷ ÈÄ¿¡µµ °è¼ÓÇØ¼­ º¸°íµÉ ¼ö ÀÖ½À´Ï´Ù(¿ì¼± ¼øÀ§ °ªÀº °¨¼Ò). Fortify Static Code Analyzer¿¡¼­ »ç¿ëÀÚ Á¦¾î ÀÔ·ÂÀÌ SQL ¹® ±¸¼º¿¡ »ç¿ëµÇ°í ÀÖ´Ù´Â ºĞ¸íÇÑ µ¥ÀÌÅÍ Èå¸§ Áõ°Å°¡ ¹ß°ßµÇ¸é ³ôÀ½/½É°¢ ¿ì¼± ¼øÀ§ÀÇ µ¥ÀÌÅÍ Èå¸§ ¹®Á¦°¡ º¸°íµË´Ï´Ù. Fortify Static Code Analyzer¿¡¼­ µ¥ÀÌÅÍ ¼Ò½º¸¦ °áÁ¤ÇÒ ¼ö ¾ø°í ¼Ò½º°¡ µ¿ÀûÀ¸·Î º¯°æµÉ ¼ö ÀÖ´Â °æ¿ì ³·À½/Áß°£ ¿ì¼± ¼øÀ§ÀÇ ÀÇ¹Ì Ã¼°è ¹®Á¦°¡ º¸°íµË´Ï´Ù. ÀÌ Àü·«Àº SQL Injection°ú °°ÀÌ ¾Ç¿ëÀÇ ÀáÀçÀû ¿µÇâÀÌ °ÅÁş ±àÁ¤ ¹®Á¦¸¦ °¨»çÇÏ´Â ºÒÆíÇÔº¸´Ù Å« ÀÏºÎ Ãë¾à¼º ¹üÁÖ¿¡ Ã¤ÅÃµÇ¾ú½À´Ï´Ù.

4. Fortify AppDefender adds protection against this category.,08D07C1407753721CFABDE9FE7DFE2CF,E04D3E1F-2D8C-400A-BB55-7DA143F987E3,,,,2024-02-13,
Critical,Critical,Input Validation and Representation,SQL Injection,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/registerServlet.java,registerServlet.java,,				System.out.println("f = true");
				sql = "insert into user values('" + sno + "', '" + user + "', '" + pass + "')";
				state.executeUpdate(sql);		
				
			},java.sql.Statement.executeUpdate(),registerServlet.javaÀÇ 64 ÁÙ¿¡¼­ doPost() ¸Ş¼­µå´Â ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ ³ª¿Â ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ¸¸µé¾îÁø SQL Äõ¸®¸¦ È£ÃâÇÕ´Ï´Ù. ÀÌ È£ÃâÀ» »ç¿ëÇÏ¿© °ø°İÀÚ´Â ÇØ´ç ¹®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ°Å³ª ÀÓÀÇÀÇ SQL ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.,LoginModel.javaÀÇ 9 ÁÙ¿¡¼­ check() ¸Ş¼­µå´Â ÀáÀçÀûÀ¸·Î ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ ³ª¿Â ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ¸¸µé¾îÁø SQL Äõ¸®¸¦ È£ÃâÇÕ´Ï´Ù. ÀÌ È£ÃâÀ» »ç¿ëÇÏ¿© °ø°İÀÚ´Â ÇØ´ç ¹®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ°Å³ª ÀÓÀÇÀÇ SQL ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.,SQL injection ¿À·ù´Â ´ÙÀ½ °æ¿ì¿¡ ¹ß»ıÇÕ´Ï´Ù.

1. ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¿¡¼­ µ¥ÀÌÅÍ°¡ ÇÁ·Î±×·¥¿¡ ÀÔ·ÂµË´Ï´Ù.

ÀÌ·± °æ¿ì, Fortify Static Code Analyzer´Â µ¥ÀÌÅÍ ¼Ò½º¸¦ ½Å·ÚÇÒ ¼ö ÀÖ´Â °ÍÀ¸·Î ÆÇ´ÜÇÏÁö ¾Ê½À´Ï´Ù.

2. µ¥ÀÌÅÍ¸¦ »ç¿ëÇÏ¿© SQL Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÕ´Ï´Ù.



¿¹Á¦ 1: ´ÙÀ½ ÄÚµå´Â ÁöÁ¤µÈ ÀÌ¸§°ú ÀÏÄ¡ÇÏ´Â Ç×¸ñÀ» °Ë»öÇÏ´Â SQL Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÏ°í ½ÇÇàÇÕ´Ï´Ù. Äõ¸®´Â Ç¥½ÃµÇ´Â Ç×¸ñÀ» Ç×¸ñ ¼ÒÀ¯ÀÚ°¡ ÇöÀç ÀÎÁõµÈ »ç¿ëÀÚÀÇ ÀÌ¸§°ú ÀÏÄ¡ÇÏ´Â Ç×¸ñÀ¸·Î Á¦ÇÑÇÕ´Ï´Ù.


...
	String userName = ctx.getAuthenticatedUserName();
	String itemName = request.getParameter("itemName");
	String query = "SELECT * FROM items WHERE owner = '"
				+ userName + "' AND itemname = '"
				+ itemName + "'";
	ResultSet rs = stmt.execute(query);
...


Äõ¸®´Â ´ÙÀ½ ÄÚµå¸¦ ½ÇÇàÇÏ·Á°í ÇÕ´Ï´Ù.


	SELECT * FROM items
	WHERE owner = <userName>
	AND itemname = <itemName>;


ÇÏÁö¸¸ »ó¼öÀÎ ±âº» Äõ¸® ¹®ÀÚ¿­°ú »ç¿ëÀÚ ÀÔ·Â ¹®ÀÚ¿­À» ¿¬°áÇÏ¿© Äõ¸®¸¦ µ¿ÀûÀ¸·Î »ı¼ºÇÏ±â ¶§¹®¿¡, Äõ¸®´Â itemName¿¡ ÀÛÀºµû¿ÈÇ¥°¡ µé¾î ÀÖÁö ¾ÊÀº °æ¿ì¿¡¸¸ Á¤È®ÇÏ°Ô µ¿ÀÛÇÕ´Ï´Ù. »ç¿ëÀÚ ÀÌ¸§ÀÌ wileyÀÎ °ø°İÀÚ°¡ itemName¿¡ ¹®ÀÚ¿­ "name' OR 'a'='a"¸¦ ÀÔ·ÂÇÏ¸é Äõ¸®´Â ´ÙÀ½°ú °°ÀÌ »ı¼ºµË´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name' OR 'a'='a';


OR 'a'='a' Á¶°ÇÀ» Ãß°¡ÇÏ¸é where ÀıÀÌ Ç×»ó true·Î Æò°¡ÇÏ±â ¶§¹®¿¡ Äõ¸®´Â ÈÎ¾À °£´ÜÇÑ ´ÙÀ½ Äõ¸®¿Í ³í¸®ÀûÀ¸·Î µ¿ÀÏÇÏ°Ô µË´Ï´Ù.


	SELECT * FROM items;


°ø°İÀÚ´Â ÀÌ·¸°Ô Äõ¸®¸¦ ´Ü¼øÈ­ÇÏ¿© Äõ¸®°¡ ÀÎÁõµÈ »ç¿ëÀÚ°¡ ¼ÒÀ¯ÇÑ Ç×¸ñ¸¸ ¹İÈ¯ÇØ¾ß ÇÑ´Ù´Â ¿ä±¸ »çÇ×À» ¹«½ÃÇÒ ¼ö ÀÖ½À´Ï´Ù. ÀÌÁ¦ Äõ¸®´Â ÁöÁ¤µÈ ¼ÒÀ¯ÀÚ¿Í °ü°è¾øÀÌ items Å×ÀÌºí¿¡ ÀúÀåµÈ ¸ğµç Ç×¸ñÀ» ¹İÈ¯ÇÕ´Ï´Ù.

¿¹Á¦ 2: ÀÌ ¿¹Á¦´Â Example 1¿¡¼­ »ı¼ºÇÏ¿© ¼öÇàÇÑ Äõ¸®¿¡ ¶Ç ´Ù¸¥ ¾Ç¼º °ªÀÌ Àü´ŞµÉ ¶§ÀÇ °á°ú¸¦ °ËÅäÇÕ´Ï´Ù. »ç¿ëÀÚ ÀÌ¸§ÀÌ wileyÀÎ °ø°İÀÚ°¡ itemName¿¡ ¹®ÀÚ¿­ "name'; DELETE FROM items; --"¸¦ ÀÔ·ÂÇÏ¸é Äõ¸®´Â ´ÙÀ½°ú °°Àº µÎ °³ÀÇ Äõ¸®°¡ µË´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name';

	DELETE FROM items;

	--'


Microsoft(R) SQL Server 2000À» Æ÷ÇÔÇÑ ¸¹Àº µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­ ¿©·¯ SQL ¹®À» ¼¼¹ÌÄİ·ĞÀ¸·Î ±¸ºĞÇÏ¿© ÇÑ²¨¹ø¿¡ ½ÇÇàÇÏ´Â °ÍÀ» Çã¿ëÇÕ´Ï´Ù. ÀÌ °ø°İ ¹®ÀÚ¿­Àº ¼¼¹ÌÄİ·ĞÀ¸·Î ±¸ºĞÇÑ ¹®¿¡ ´ëÇÑ ÀÏ°ı ½ÇÇàÀ» Çã¿ëÇÏÁö ¾Ê´Â Oracle ¹× ±âÅ¸ µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­´Â ¿À·ù¸¦ ÀÏÀ¸Å°Áö¸¸ ÀÏ°ı ½ÇÇàÀ» Çã¿ëÇÏ´Â µ¥ÀÌÅÍº£ÀÌ½º¿¡¼­´Â °ø°İÀÚ°¡ ÀÌ·± Á¾·ùÀÇ °ø°İÀ¸·Î µ¥ÀÌÅÍº£ÀÌ½º¿¡ ´ëÇØ ÀÓÀÇÀÇ ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù.

¸¶Áö¸·ÀÇ ÇÏÀÌÇÂ ½Ö(--)À» º¸°Ú½À´Ï´Ù. ÀÌ´Â ´ëºÎºĞÀÇ µ¥ÀÌÅÍº£ÀÌ½º ¼­¹ö¿¡¼­ ÇØ´ç ¹®¿¡ ´ëÇÑ ³ª¸ÓÁö ºÎºĞÀ» ÁÖ¼®À¸·Î Ã³¸®ÇÏ¿© ½ÇÇàÇÏÁö ¸»¶ó´Â ÀÇ¹Ì·Î ÇØ¼®µË´Ï´Ù[4]. ÀÌ °æ¿ì, ÀÌ ÁÖ¼® ¹®ÀÚ´Â ¼öÁ¤µÈ Äõ¸®¿¡¼­ ¸¶Áö¸·ÀÇ ÀÛÀºµû¿ÈÇ¥ ÇÑÂÊÀ» Á¦°ÅÇÏ´Â ¿ªÇÒÀ» ÇÕ´Ï´Ù. ÁÖ¼®À» ÀÌ·± ½ÄÀ¸·Î »ç¿ëÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍº£ÀÌ½º¿¡¼­µµ Example 1¿¡¼­ »ç¿ëµÈ °Í°ú À¯»çÇÑ ¼ÓÀÓ¼ö¸¦ »ç¿ëÇÏ¸é ´ëºÎºĞÀÇ °ø°İÀÌ È¿°ú¸¦ °ÅµÑ ¼ö ÀÖ½À´Ï´Ù. °ø°İÀÚ°¡ ¹®ÀÚ¿­ "name'); DELETE FROM items; SELECT * FROM items WHERE 'a'='a"¸¦ ÀÔ·ÂÇÏ¿© ´ÙÀ½ ¼¼ °¡Áö À¯È¿ÇÑ ¹®À» ¸¸µå´Â °æ¿ìÀÔ´Ï´Ù.


	SELECT * FROM items
	WHERE owner = 'wiley'
	AND itemname = 'name';

	DELETE FROM items;

	SELECT * FROM items WHERE 'a'='a';


¸ğ¹ÙÀÏ È¯°æ¿¡¼­´Â SQL Injection°ú °°Àº ÀüÇüÀûÀÎ À¥ ÀÀ¿ë ÇÁ·Î±×·¥ Ãë¾à¼ºÀÌ ¹ß»ıÇÏÁö ¾Ê´Â´Ù°í »ı°¢ÇÏ´Â »ç¿ëÀÚµµ ÀÖ½À´Ï´Ù. ÀÚ±â ÀÚ½ÅÀ» °ø°İÇÏ´Â »ç¿ëÀÚ´Â ¾øÀ» °ÍÀÌ¶ó ¿©±â±â ¶§¹®ÀÔ´Ï´Ù. ±×·¯³ª ¸ğ¹ÙÀÏ ÇÃ·§ÆûÀÇ ÇÙ½É ¿ä¼Ò´Â ´Ù¾çÇÑ ¼Ò½º¿¡¼­ ´Ù¿î·ÎµåµÇ¾î °°Àº ÀåÄ¡¿¡¼­ ÇÔ²² ½ÇÇàµÇ´Â ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ¶ó´Â Á¡À» À¯³äÇØ¾ß ÇÕ´Ï´Ù. Áï ±İÀ¶ ÀÀ¿ë ÇÁ·Î±×·¥°ú ¸È¿ş¾î¸¦ ÇÔ²² ½ÇÇàÇÒ °¡´É¼ºÀÌ ³ôÀ¸¹Ç·Î ÇÁ·Î¼¼½º °£ Åë½ÅÀ» Æ÷ÇÔÇÏµµ·Ï ¸ğ¹ÙÀÏ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ °ø°İ Ç¥¸éÀ» È®ÀåÇØ¾ß ÇÕ´Ï´Ù.

¿¹Á¦ 3: ´ÙÀ½ ÄÚµå´Â Example 1À» Android ÇÃ·§Æû¿¡ ¸Â°Ô Á¶Á¤ÇÕ´Ï´Ù.


...
        PasswordAuthentication pa = authenticator.getPasswordAuthentication();
        String userName = pa.getUserName();
        String itemName = this.getIntent().getExtras().getString("itemName");
        String query = "SELECT * FROM items WHERE owner = '"
                                + userName + "' AND itemname = '"
                                + itemName + "'";
        SQLiteDatabase db = this.openOrCreateDatabase("DB", MODE_PRIVATE, null);
        Cursor c = db.rawQuery(query, null);
...


SQL Injection °ø°İÀ» ¹æÁöÇÏ´Â ÇÑ °¡Áö ±âÁ¸ÀÇ Á¢±Ù ¹æ½ÄÀº °ø°İÀ» ÀÔ·Â°ª °ËÁõ ¹®Á¦·Î Ã³¸®ÇÏ°í ¾ÈÀüÇÑ °ª ¸ñ·Ï(Çã¿ë ¸ñ·Ï)ÀÇ ¹®ÀÚ¸¸ ¹Ş°Å³ª ¾ÇÀÇÀûÀÏ °¡´É¼ºÀÌ ÀÖ´Â °ª ¸ñ·Ï(°ÅºÎ ¸ñ·Ï)À» ½Äº°ÇÏ¿© ÀÌ½ºÄÉÀÌÇÁ Ã³¸®ÇÏ´Â °ÍÀÔ´Ï´Ù. Çã¿ë ¸ñ·Ï °Ë»ç´Â ¾ö°İÇÑ ÀÔ·Â°ª °ËÁõ ±ÔÄ¢À» ÀÌÇàÇÏ´Â ¸Å¿ì È¿À²ÀûÀÎ ¼ö´ÜÀÌ µÇ±âµµ ÇÏÁö¸¸, ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº À¯Áö °ü¸®°¡ ½±°í º¸´Ù °­·ÂÇÑ º¸¾ÈÀ» Á¦°øÇÒ ¼ö ÀÖ½À´Ï´Ù. ´ëºÎºĞÀÇ °æ¿ì °ÅºÎ ¸ñ·Ï ±¸ÇöÀº SQL Injection °ø°İ ¹æÁöÀÇ È¿°ú¸¦ ¶³¾î¶ß¸®´Â ÇãÁ¡ÀÌ ¾ÆÁÖ ¸¹½À´Ï´Ù. ¿¹¸¦ µé¾î, °ø°İÀÚ´Â ´ÙÀ½°ú °°ÀÌ ÇÒ ¼ö ÀÖ½À´Ï´Ù.

- µû¿ÈÇ¥·Î ¹­Áö ¾ÊÀº ÇÊµå¸¦ ³ë¸³´Ï´Ù.
- ÀÌ½ºÄÉÀÌÇÁ Ã³¸®µÈ ¸ŞÅ¸ ¹®ÀÚ¸¦ »ç¿ëÇÒ ÇÊ¿ä°¡ ¾ø´Â ¹æ¹ıÀ» Ã£½À´Ï´Ù.
- ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)¸¦ »ç¿ëÇÏ¿© »ğÀÔµÈ ¸ŞÅ¸ ¹®ÀÚ¸¦ ¼û±é´Ï´Ù.

SQL Äõ¸®¿¡ ÀÔ·ÂÇÒ ¶§ ¼öµ¿À¸·Î ¹®ÀÚ¸¦ ÀÌ½ºÄÉÀÌÇÁ Ã³¸®ÇÏ´Â ¹æ¹ıµµ ÀÖÁö¸¸ ÀÌ°ÍÀ¸·Î SQL injection °ø°İÀ¸·ÎºÎÅÍ ÀÀ¿ë ÇÁ·Î±×·¥À» º¸È£ÇÒ ¼ö´Â ¾ø½À´Ï´Ù.

SQL injection °ø°İÀ» ´Ù·ç´Â µ¥ ÁÖ·Î Á¦½ÃµÇ´Â ´Ù¸¥ ¼Ö·ç¼ÇÀº ÀúÀå ÇÁ·Î½ÃÀú(stored procedure)¸¦ »ç¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏºÎ À¯ÇüÀÇ SQL injection °ø°İÀº ¸·À» ¼ö ÀÖÁö¸¸ ´Ù¸¥ ¸¹Àº À¯ÇüÀº ¸·Áö ¸øÇÕ´Ï´Ù. ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏ¹İÀûÀ¸·Î ¸Å°³ º¯¼ö¿¡ Àü´ŞµÇ´Â SQL ¹®ÀÇ À¯ÇüÀ» Á¦ÇÑÇÏ¿© SQL injection °ø°İÀ» ¸·½À´Ï´Ù. ÇÏÁö¸¸ ÀÌ Á¦¾àÀ» ÇÇÇÒ ¼ö ÀÖ´Â ¸¹Àº ¹æ¹ıÀÌ ÀÖ¾î ¼ö¸¹Àº ºñÁ¤»óÀûÀÎ ¹®À» ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)¿¡ Àü´ŞÇÒ ¼ö ÀÖ½À´Ï´Ù. µÇÇ®ÀÌÇÏÁö¸¸, ÀúÀå ÇÁ·Î½ÃÀú(Stored procedure)´Â ÀÏºÎ ÀÍ½ºÇÃ·ÎÀÌÆ®´Â ¸·À» ¼ö ÀÖÁö¸¸ ÀÀ¿ë ÇÁ·Î±×·¥À» SQL injection °ø°İ¿¡ ´ëÇØ ¾ÈÀüÇÏ°Ô º¸È£ÇÒ ¼ö´Â ¾ø½À´Ï´Ù.,SQL injection Ãë¾àÁ¡ÀÇ ¿øÀÎÀº °ø°İÀÚ°¡ SQL Äõ¸®ÀÇ ÄÁÅØ½ºÆ®¸¦ º¯°æÇÏ¿© ÇÁ·Î±×·¡¸Ó°¡ µ¥ÀÌÅÍ·Î ÇØ¼®µÇ±â¸¦ ¹Ù¶ó´Â °ªÀ» ¸í·ÉÀ¸·Î ÇØ¼®µÇµµ·Ï ¸¸µé ¼ö ÀÖ´Ù´Â Á¡ÀÔ´Ï´Ù. SQL Äõ¸®¸¦ »ı¼ºÇÒ ¶§, ÇÁ·Î±×·¡¸Ó´Â ¹«¾ùÀÌ ¸í·ÉÀ¸·Î ÇØ¼®µÇ¾î¾ß ÇÏ°í ¹«¾ùÀÌ µ¥ÀÌÅÍ·Î ÇØ¼®µÇ¾î¾ß ÇÏ´ÂÁö ¾Ë°í ÀÖ½À´Ï´Ù. ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº µ¥ÀÌÅÍ À§ÁÖÀÇ ÄÁÅØ½ºÆ® º¯°æÀ» Çã¿ëÇÏÁö ¾Ê°í °ÅÀÇ ¸ğµç SQL injection °ø°İÀ» ¹æÁöÇÏ¿© ÀÌ¸¦ ÀÌÇàÇÕ´Ï´Ù. ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®Àº ÀÏ¹İ SQL ¹®ÀÚ¿­À» »ç¿ëÇÏ¿© »ı¼ºµÇÁö¸¸, »ç¿ëÀÚ°¡ Á¦°øÇÏ´Â µ¥ÀÌÅÍ¸¦ Æ÷ÇÔÇØ¾ß ÇÏ´Â °æ¿ì¿¡ ÀÌÈÄ¿¡ »ğÀÔµÇ´Â µ¥ÀÌÅÍÀÇ ÀÚ¸® Ç¥½ÃÀÚÀÎ ¹ÙÀÎµù ¸Å°³ º¯¼ö¸¦ »ı¼ºÇÕ´Ï´Ù. ¹ÙÀÎµù ¸Å°³ º¯¼ö¸¦ »ç¿ëÇÏ¸é ÇÁ·Î±×·¥ÀÌ ¸í·ÉÀ¸·Î Ã³¸®ÇØ¾ß ÇÒ °Í°ú µ¥ÀÌÅÍ·Î Ã³¸®ÇØ¾ß ÇÒ °ÍÀ» µ¥ÀÌÅÍº£ÀÌ½º¿¡ ¸í½ÃÀûÀ¸·Î ÁöÁ¤ÇÒ ¼ö ÀÖ½À´Ï´Ù. ÇÁ·Î±×·¥ÀÌ ¹®À» ½ÇÇàÇÒ ÁØºñ°¡ µÇ¸é °¢ ¹ÙÀÎµù ¸Å°³ º¯¼ö¿¡ »ç¿ëÇÒ ·±Å¸ÀÓ °ªÀ» µ¥ÀÌÅÍº£ÀÌ½º¿¡ ÁöÁ¤ÇÏ¿© µ¥ÀÌÅÍ°¡ ¸í·ÉÀ¸·Î ÇØ¼®µÉ À§ÇèÀ» ÇÇÇÒ ¼ö ÀÖ½À´Ï´Ù. 

»ç¿ëÀÚ°¡ Á¦°øÇÏ´Â ¹®ÀÚ¿­À» ¿¬°áÇÏ´Â ´ë½Å ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏµµ·Ï ´ÙÀ½°ú °°ÀÌ ¿¹Á¦ 1À» ´Ù½Ã ÀÛ¼ºÇÒ ¼ö ÀÖ½À´Ï´Ù.


...
	String userName = ctx.getAuthenticatedUserName();
	String itemName = request.getParameter("itemName");
	String query =
        	"SELECT * FROM items WHERE itemname=? AND owner=?";
	PreparedStatement stmt = conn.prepareStatement(query);
	stmt.setString(1, itemName);
	stmt.setString(2, userName);
	ResultSet results = stmt.execute();
...


Android¿¡ ÇØ´çÇÏ´Â ÄÚµå´Â ´ÙÀ½°ú °°½À´Ï´Ù.


...
	PasswordAuthentication pa = authenticator.getPasswordAuthentication();
	String userName = pa.getUserName();
	String itemName = this.getIntent().getExtras().getString("itemName");
	String query = "SELECT * FROM items WHERE itemname=? AND owner=?";
	SQLiteDatabase db = this.openOrCreateDatabase("DB", MODE_PRIVATE, null);
	Cursor c = db.rawQuery(query, new Object[]{itemName, userName});
...


ÈçÈ÷ º¸°í¼­ »ı¼º ÄÚµå¿¡¼­ º¼ ¼ö ÀÖ´Â º¹ÀâÇÑ ½Ã³ª¸®¿À¿¡¼­´Â WHERE ÀıÀÇ µ¿Àû Á¦¾à Á¶°Ç Ãß°¡¿Í °°ÀÌ, SQL ¹®ÀÇ ¸í·É ±¸Á¶°¡ °áÁ¤µÇ´Â »ç¿ëÀÚ ÀÔ·ÂÀÌ ÇÊ¿äÇÕ´Ï´Ù. ±×·¸´Ù°í ÀÌ ¿ä±¸ »çÇ×ÀÌ »ç¿ëÀÚ ÀÔ·ÂÀ» ¿¬°áÇÏ¿© Äõ¸® ¹®ÀÚ¿­À» ¸¸µå´Â °ÍÀ» Á¤´çÈ­ÇÒ ¼ö´Â ¾ø½À´Ï´Ù. »ç¿ëÀÚ ÀÔ·ÂÀ» SQL ¹® ¸í·É ±¸Á¶¿¡ Àû¿ëÇØ¾ß ÇÏ´Â °æ¿ì °£Á¢ ÂüÁ¶¸¦ »ç¿ëÇÏ¿© SQL injection °ø°İÀ» ¿¹¹æÇÕ´Ï´Ù. Áï, SQL ¹®¿¡ Æ÷ÇÔ½ÃÅ³ ¿©·¯ ¿ä¼Ò¿¡ ÇØ´çÇÏ´Â À¯È¿ÇÑ ¹®ÀÚ¿­ ÁıÇÕÀ» ¸¸µì´Ï´Ù. ¹®À» ¸¸µé ¶§ »ç¿ëÀÚ ÀÔ·ÂÀ» »ç¿ëÇÏ¿© ÀÌ ÀÀ¿ë ÇÁ·Î±×·¥ Á¦¾î °ª ÁıÇÕ¿¡¼­ °ªÀ» ¼±ÅÃÇÕ´Ï´Ù.,1. ÀÌ ¶§, ÈçÈ÷ ÀúÁö¸£´Â ½Ç¼ö´Â »ç¿ëÀÚ°¡ Á¦¾îÇÏ´Â ¹®ÀÚ¿­À» ¿¬°áÇÏ¿© »ı¼ºÇÑ, ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. ¹°·Ğ ÀÌ·¸°Ô ÇÏ¸é ¸Å°³ º¯¼ö°¡ ÀÖ´Â SQL ¹®À» »ç¿ëÇÏ´Â ¸ñÀûÀÌ ¹«»êµË´Ï´Ù. SQL ¹®À» Çü¼ºÇÏ´Â ¹®ÀÚ¿­ÀÌ ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­ Á¦¾îÇÏ´Â »ó¼öÀÎÁö È®½ÅÇÒ ¼ö ¾ø´Â °æ¿ì, ¹®ÀÚ¿­ÀÌ SQL ¹®ÀÚ¿­·Î Á÷Á¢ ½ÇÇàµÇÁö ¾Ê±â ¶§¹®¿¡ ¾ÈÀüÇÏ´Ù°í °¡Á¤ÇÒ ¼ö ¾ø½À´Ï´Ù. SQL ¹®¿¡¼­ »ç¿ëÀÚ Á¦¾î ¹®ÀÚ¿­ÀÇ ¸ğµç »ç¿ëÀ» Ã¶ÀúÇÏ°Ô Á¶»çÇÏ°í Äõ¸®ÀÇ ÀÇ¹Ì¸¦ ¼öÁ¤ÇÏ´Â µ¥ »ç¿ëµÇ´Â ÀÏÀÌ ¾ø´ÂÁö È®ÀÎÇØ¾ß ÇÕ´Ï´Ù.

2. µ¥ÀÌÅÍ°¡ Å¬·¡½ºÀÇ °ø¿ë ºñ final ¹®ÀÚ¿­ ÇÊµå¿¡¼­ ¿À´Â °æ¿ì ÀÌ µ¥ÀÌÅÍ´Â ½Å·ÚÇÒ ¼ö ¾ø½À´Ï´Ù. ÀÌ·¯ÇÑ À¯ÇüÀÇ ÇÊµå´Â ¾Ë·ÁÁöÁö ¾ÊÀº ¼Ò½º¿¡ ÀÇÇØ ¼öÁ¤µÉ ¼ö ÀÖ½À´Ï´Ù.

3. SQL Injection ¹®Á¦´Â µ¥ÀÌÅÍ Èå¸§ ¼öÁ¤ ÀÛ¾÷ ÈÄ¿¡µµ °è¼ÓÇØ¼­ º¸°íµÉ ¼ö ÀÖ½À´Ï´Ù(¿ì¼± ¼øÀ§ °ªÀº °¨¼Ò). Fortify Static Code Analyzer¿¡¼­ »ç¿ëÀÚ Á¦¾î ÀÔ·ÂÀÌ SQL ¹® ±¸¼º¿¡ »ç¿ëµÇ°í ÀÖ´Ù´Â ºĞ¸íÇÑ µ¥ÀÌÅÍ Èå¸§ Áõ°Å°¡ ¹ß°ßµÇ¸é ³ôÀ½/½É°¢ ¿ì¼± ¼øÀ§ÀÇ µ¥ÀÌÅÍ Èå¸§ ¹®Á¦°¡ º¸°íµË´Ï´Ù. Fortify Static Code Analyzer¿¡¼­ µ¥ÀÌÅÍ ¼Ò½º¸¦ °áÁ¤ÇÒ ¼ö ¾ø°í ¼Ò½º°¡ µ¿ÀûÀ¸·Î º¯°æµÉ ¼ö ÀÖ´Â °æ¿ì ³·À½/Áß°£ ¿ì¼± ¼øÀ§ÀÇ ÀÇ¹Ì Ã¼°è ¹®Á¦°¡ º¸°íµË´Ï´Ù. ÀÌ Àü·«Àº SQL Injection°ú °°ÀÌ ¾Ç¿ëÀÇ ÀáÀçÀû ¿µÇâÀÌ °ÅÁş ±àÁ¤ ¹®Á¦¸¦ °¨»çÇÏ´Â ºÒÆíÇÔº¸´Ù Å« ÀÏºÎ Ãë¾à¼º ¹üÁÖ¿¡ Ã¤ÅÃµÇ¾ú½À´Ï´Ù.

4. Fortify AppDefender adds protection against this category.,7979A68DB1EB9D685F539D165EC5EE29,E04D3E1F-2D8C-400A-BB55-7DA143F987E3,,,,2024-02-13,
Low,Low,Encapsulation,System Information Leak: Incomplete Servlet Error Handling,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/LoginServlet.java,LoginServlet.java,,	 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		response.getWriter().append("Served at: ").append(request.getContextPath());,Function: doGet(),LoginServlet ServletÀº doGet()ÀÇ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÕ´Ï´Ù. ServletÀÌ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÏ¸é °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â µğ¹ö±ë Á¤º¸¸¦ ³ëÃâÇÒ ¼ö ÀÖ½À´Ï´Ù.,LoginServlet ServletÀº doGet()ÀÇ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÕ´Ï´Ù. ServletÀÌ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÏ¸é °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â µğ¹ö±ë Á¤º¸¸¦ ³ëÃâÇÒ ¼ö ÀÖ½À´Ï´Ù.,Servlet¿¡ ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÏ¸é Servlet ÄÁÅ×ÀÌ³Ê°¡ »ç¿ëÀÚ¿¡°Ô º¸³»´Â ±âº» ¿À·ù ÀÀ´ä¿¡´Â º¸Åë µğ¹ö±ë Á¤º¸°¡ Æ÷ÇÔµË´Ï´Ù. µğ¹ö±ë Á¤º¸´Â °ø°İÀÚ¿¡°Ô ¾ÆÁÖ ¾µ¸ğ°¡ ÀÖ½À´Ï´Ù. ¿¹¸¦ µé¾î, ½ºÅÃ ÃßÀûÀº °ø°İÀÚ¿¡°Ô Àß¸øµÈ SQL Äõ¸® ¹®ÀÚ¿­, »ç¿ë ÁßÀÎ µ¥ÀÌÅÍº£ÀÌ½º À¯Çü ¹× ÀÀ¿ë ÇÁ·Î±×·¥ ÄÁÅ×ÀÌ³Ê ¹öÀüÀ» º¸¿©ÁÙ ¼ö ÀÖ½À´Ï´Ù. °ø°İÀÚ´Â ÀÌ Á¤º¸¸¦ »ç¿ëÇÏ¿© ÀÌ ±¸¼º ¿ä¼ÒÀÇ ¾Ë·ÁÁø Ãë¾àÁ¡À» °ø·«ÇÕ´Ï´Ù.

¿¹Á¦ 1: ´ÙÀ½ ¸Ş¼­µå¿¡¼­ DNS Á¶È¸ ½ÇÆĞ·Î Servlet¿¡ ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res)
              throws IOException {
    String ip = req.getRemoteAddr();
    InetAddress addr = InetAddress.getByName(ip);
    ...
    out.println("hello " + addr.getHostName());
}


¿¹Á¦ 2: ´ÙÀ½ ¸Ş¼­µå´Â ¸Å°³ º¯¼ö "name"ÀÌ ¿äÃ»ÇÑ ºÎºĞÀÌ ¾Æ´Ñ °æ¿ì NullPointerExceptionÀÌ ¹ß»ıÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res)
              throws IOException {
    String name = getParameter("name");
    ...
    out.println("hello " + name.trim());
}
,¸ğµç ÃÖ»óÀ§ ¼öÁØ Servlet ¸Ş¼­µå´Â ThrowableÀ» Ä³Ä¡(catch)ÇÏ¿© ServletÀÇ ¿À·ù ÀÀ´ä ¸ŞÄ¿´ÏÁòÀÌ È£ÃâµÉ ±âÈ¸¸¦ ÃÖ¼ÒÈ­ÇØ¾ß ÇÕ´Ï´Ù. 

¿¹Á¦ 3: Example 1ÀÇ ¸Ş¼­µå´Â ´ÙÀ½°ú °°ÀÌ ´Ù½Ã ÀÛ¼ºÇØ¾ß ÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res) {
      try {
          String ip = req.getRemoteAddr();
          InetAddress addr = InetAddress.getByName(ip);
      ...
          out.println("hello " + addr.getHostName());
      }catch (Throwable t) {
          logger.error("caught throwable at top level", t);
      }
  }
}
,,0D85D8B3021CC15E7F4434F4B9EFED84,97B9518A-F1BC-44CE-BEB1-D5FBDDFCCF9D,,,,2024-02-13,
Low,Low,Encapsulation,System Information Leak: Incomplete Servlet Error Handling,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/registerServlet.java,registerServlet.java,,	 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		response.getWriter().append("Served at: ").append(request.getContextPath());,Function: doGet(),registerServlet ServletÀº doGet()ÀÇ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÕ´Ï´Ù. ServletÀÌ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÏ¸é °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â µğ¹ö±ë Á¤º¸¸¦ ³ëÃâÇÒ ¼ö ÀÖ½À´Ï´Ù.,LoginServlet ServletÀº doGet()ÀÇ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÕ´Ï´Ù. ServletÀÌ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÏ¸é °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â µğ¹ö±ë Á¤º¸¸¦ ³ëÃâÇÒ ¼ö ÀÖ½À´Ï´Ù.,Servlet¿¡ ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÏ¸é Servlet ÄÁÅ×ÀÌ³Ê°¡ »ç¿ëÀÚ¿¡°Ô º¸³»´Â ±âº» ¿À·ù ÀÀ´ä¿¡´Â º¸Åë µğ¹ö±ë Á¤º¸°¡ Æ÷ÇÔµË´Ï´Ù. µğ¹ö±ë Á¤º¸´Â °ø°İÀÚ¿¡°Ô ¾ÆÁÖ ¾µ¸ğ°¡ ÀÖ½À´Ï´Ù. ¿¹¸¦ µé¾î, ½ºÅÃ ÃßÀûÀº °ø°İÀÚ¿¡°Ô Àß¸øµÈ SQL Äõ¸® ¹®ÀÚ¿­, »ç¿ë ÁßÀÎ µ¥ÀÌÅÍº£ÀÌ½º À¯Çü ¹× ÀÀ¿ë ÇÁ·Î±×·¥ ÄÁÅ×ÀÌ³Ê ¹öÀüÀ» º¸¿©ÁÙ ¼ö ÀÖ½À´Ï´Ù. °ø°İÀÚ´Â ÀÌ Á¤º¸¸¦ »ç¿ëÇÏ¿© ÀÌ ±¸¼º ¿ä¼ÒÀÇ ¾Ë·ÁÁø Ãë¾àÁ¡À» °ø·«ÇÕ´Ï´Ù.

¿¹Á¦ 1: ´ÙÀ½ ¸Ş¼­µå¿¡¼­ DNS Á¶È¸ ½ÇÆĞ·Î Servlet¿¡ ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res)
              throws IOException {
    String ip = req.getRemoteAddr();
    InetAddress addr = InetAddress.getByName(ip);
    ...
    out.println("hello " + addr.getHostName());
}


¿¹Á¦ 2: ´ÙÀ½ ¸Ş¼­µå´Â ¸Å°³ º¯¼ö "name"ÀÌ ¿äÃ»ÇÑ ºÎºĞÀÌ ¾Æ´Ñ °æ¿ì NullPointerExceptionÀÌ ¹ß»ıÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res)
              throws IOException {
    String name = getParameter("name");
    ...
    out.println("hello " + name.trim());
}
,¸ğµç ÃÖ»óÀ§ ¼öÁØ Servlet ¸Ş¼­µå´Â ThrowableÀ» Ä³Ä¡(catch)ÇÏ¿© ServletÀÇ ¿À·ù ÀÀ´ä ¸ŞÄ¿´ÏÁòÀÌ È£ÃâµÉ ±âÈ¸¸¦ ÃÖ¼ÒÈ­ÇØ¾ß ÇÕ´Ï´Ù. 

¿¹Á¦ 3: Example 1ÀÇ ¸Ş¼­µå´Â ´ÙÀ½°ú °°ÀÌ ´Ù½Ã ÀÛ¼ºÇØ¾ß ÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res) {
      try {
          String ip = req.getRemoteAddr();
          InetAddress addr = InetAddress.getByName(ip);
      ...
          out.println("hello " + addr.getHostName());
      }catch (Throwable t) {
          logger.error("caught throwable at top level", t);
      }
  }
}
,,4C80BB31FC4828FD5B90F74DBFB384F9,97B9518A-F1BC-44CE-BEB1-D5FBDDFCCF9D,,,,2024-02-13,
Low,Low,Encapsulation,System Information Leak: Incomplete Servlet Error Handling,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/LoginServlet.java,LoginServlet.java,,	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		System.out.println("Login Test");,Function: doPost(),LoginServlet ServletÀº doPost()ÀÇ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÕ´Ï´Ù. ServletÀÌ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÏ¸é °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â µğ¹ö±ë Á¤º¸¸¦ ³ëÃâÇÒ ¼ö ÀÖ½À´Ï´Ù.,LoginServlet ServletÀº doGet()ÀÇ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÕ´Ï´Ù. ServletÀÌ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÏ¸é °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â µğ¹ö±ë Á¤º¸¸¦ ³ëÃâÇÒ ¼ö ÀÖ½À´Ï´Ù.,Servlet¿¡ ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÏ¸é Servlet ÄÁÅ×ÀÌ³Ê°¡ »ç¿ëÀÚ¿¡°Ô º¸³»´Â ±âº» ¿À·ù ÀÀ´ä¿¡´Â º¸Åë µğ¹ö±ë Á¤º¸°¡ Æ÷ÇÔµË´Ï´Ù. µğ¹ö±ë Á¤º¸´Â °ø°İÀÚ¿¡°Ô ¾ÆÁÖ ¾µ¸ğ°¡ ÀÖ½À´Ï´Ù. ¿¹¸¦ µé¾î, ½ºÅÃ ÃßÀûÀº °ø°İÀÚ¿¡°Ô Àß¸øµÈ SQL Äõ¸® ¹®ÀÚ¿­, »ç¿ë ÁßÀÎ µ¥ÀÌÅÍº£ÀÌ½º À¯Çü ¹× ÀÀ¿ë ÇÁ·Î±×·¥ ÄÁÅ×ÀÌ³Ê ¹öÀüÀ» º¸¿©ÁÙ ¼ö ÀÖ½À´Ï´Ù. °ø°İÀÚ´Â ÀÌ Á¤º¸¸¦ »ç¿ëÇÏ¿© ÀÌ ±¸¼º ¿ä¼ÒÀÇ ¾Ë·ÁÁø Ãë¾àÁ¡À» °ø·«ÇÕ´Ï´Ù.

¿¹Á¦ 1: ´ÙÀ½ ¸Ş¼­µå¿¡¼­ DNS Á¶È¸ ½ÇÆĞ·Î Servlet¿¡ ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res)
              throws IOException {
    String ip = req.getRemoteAddr();
    InetAddress addr = InetAddress.getByName(ip);
    ...
    out.println("hello " + addr.getHostName());
}


¿¹Á¦ 2: ´ÙÀ½ ¸Ş¼­µå´Â ¸Å°³ º¯¼ö "name"ÀÌ ¿äÃ»ÇÑ ºÎºĞÀÌ ¾Æ´Ñ °æ¿ì NullPointerExceptionÀÌ ¹ß»ıÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res)
              throws IOException {
    String name = getParameter("name");
    ...
    out.println("hello " + name.trim());
}
,¸ğµç ÃÖ»óÀ§ ¼öÁØ Servlet ¸Ş¼­µå´Â ThrowableÀ» Ä³Ä¡(catch)ÇÏ¿© ServletÀÇ ¿À·ù ÀÀ´ä ¸ŞÄ¿´ÏÁòÀÌ È£ÃâµÉ ±âÈ¸¸¦ ÃÖ¼ÒÈ­ÇØ¾ß ÇÕ´Ï´Ù. 

¿¹Á¦ 3: Example 1ÀÇ ¸Ş¼­µå´Â ´ÙÀ½°ú °°ÀÌ ´Ù½Ã ÀÛ¼ºÇØ¾ß ÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res) {
      try {
          String ip = req.getRemoteAddr();
          InetAddress addr = InetAddress.getByName(ip);
      ...
          out.println("hello " + addr.getHostName());
      }catch (Throwable t) {
          logger.error("caught throwable at top level", t);
      }
  }
}
,,D1CED827D763E2CF7E0809CC14ED711D,97B9518A-F1BC-44CE-BEB1-D5FBDDFCCF9D,,,,2024-02-13,
Low,Low,Encapsulation,System Information Leak: Incomplete Servlet Error Handling,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/registerServlet.java,registerServlet.java,,	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		//doGet(request, response);,Function: doPost(),registerServlet ServletÀº doPost()ÀÇ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÕ´Ï´Ù. ServletÀÌ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÏ¸é °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â µğ¹ö±ë Á¤º¸¸¦ ³ëÃâÇÒ ¼ö ÀÖ½À´Ï´Ù.,LoginServlet ServletÀº doGet()ÀÇ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÕ´Ï´Ù. ServletÀÌ ¸ğµç ¿¹¿Ü »çÇ×À» Ä³Ä¡ÇÏÁö ¸øÇÏ¸é °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â µğ¹ö±ë Á¤º¸¸¦ ³ëÃâÇÒ ¼ö ÀÖ½À´Ï´Ù.,Servlet¿¡ ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÏ¸é Servlet ÄÁÅ×ÀÌ³Ê°¡ »ç¿ëÀÚ¿¡°Ô º¸³»´Â ±âº» ¿À·ù ÀÀ´ä¿¡´Â º¸Åë µğ¹ö±ë Á¤º¸°¡ Æ÷ÇÔµË´Ï´Ù. µğ¹ö±ë Á¤º¸´Â °ø°İÀÚ¿¡°Ô ¾ÆÁÖ ¾µ¸ğ°¡ ÀÖ½À´Ï´Ù. ¿¹¸¦ µé¾î, ½ºÅÃ ÃßÀûÀº °ø°İÀÚ¿¡°Ô Àß¸øµÈ SQL Äõ¸® ¹®ÀÚ¿­, »ç¿ë ÁßÀÎ µ¥ÀÌÅÍº£ÀÌ½º À¯Çü ¹× ÀÀ¿ë ÇÁ·Î±×·¥ ÄÁÅ×ÀÌ³Ê ¹öÀüÀ» º¸¿©ÁÙ ¼ö ÀÖ½À´Ï´Ù. °ø°İÀÚ´Â ÀÌ Á¤º¸¸¦ »ç¿ëÇÏ¿© ÀÌ ±¸¼º ¿ä¼ÒÀÇ ¾Ë·ÁÁø Ãë¾àÁ¡À» °ø·«ÇÕ´Ï´Ù.

¿¹Á¦ 1: ´ÙÀ½ ¸Ş¼­µå¿¡¼­ DNS Á¶È¸ ½ÇÆĞ·Î Servlet¿¡ ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res)
              throws IOException {
    String ip = req.getRemoteAddr();
    InetAddress addr = InetAddress.getByName(ip);
    ...
    out.println("hello " + addr.getHostName());
}


¿¹Á¦ 2: ´ÙÀ½ ¸Ş¼­µå´Â ¸Å°³ º¯¼ö "name"ÀÌ ¿äÃ»ÇÑ ºÎºĞÀÌ ¾Æ´Ñ °æ¿ì NullPointerExceptionÀÌ ¹ß»ıÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res)
              throws IOException {
    String name = getParameter("name");
    ...
    out.println("hello " + name.trim());
}
,¸ğµç ÃÖ»óÀ§ ¼öÁØ Servlet ¸Ş¼­µå´Â ThrowableÀ» Ä³Ä¡(catch)ÇÏ¿© ServletÀÇ ¿À·ù ÀÀ´ä ¸ŞÄ¿´ÏÁòÀÌ È£ÃâµÉ ±âÈ¸¸¦ ÃÖ¼ÒÈ­ÇØ¾ß ÇÕ´Ï´Ù. 

¿¹Á¦ 3: Example 1ÀÇ ¸Ş¼­µå´Â ´ÙÀ½°ú °°ÀÌ ´Ù½Ã ÀÛ¼ºÇØ¾ß ÇÕ´Ï´Ù.


protected void doPost (HttpServletRequest req,
                    HttpServletResponse res) {
      try {
          String ip = req.getRemoteAddr();
          InetAddress addr = InetAddress.getByName(ip);
      ...
          out.println("hello " + addr.getHostName());
      }catch (Throwable t) {
          logger.error("caught throwable at top level", t);
      }
  }
}
,,FCCFD957687589A021B1ADD593FB3FD6,97B9518A-F1BC-44CE-BEB1-D5FBDDFCCF9D,,,,2024-02-13,
Low,Low,Encapsulation,Cross-Site Request Forgery,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),login.jsp,login.jsp,,			window.onload=show;
		</script>
		<form style="margin:auto;" action="login.do" method="POST">
    		<center>??¡§©¡?¡¤????¨ö?</center><br/><br/>
    		USER: <br/> <input type="text" name="user"></input><br/><br/>,Function: doPost(),login.jsp ÆÄÀÏÀÇ 25 ÁÙ¿¡ ÀÖ´Â Æû °Ô½Ã¿¡´Â °ø°İÀÚÀÇ ¹«´Ü ¿äÃ»À» ¸·±â À§ÇÑ »ç¿ëÀÚ Æ¯Á¤ ±â¹ĞÀÌ Æ÷ÇÔµÇ¾î ÀÖ¾î¾ß ÇÕ´Ï´Ù.,login.html ÆÄÀÏÀÇ 16 ÁÙ¿¡ ÀÖ´Â Æû °Ô½Ã¿¡´Â °ø°İÀÚÀÇ ¹«´Ü ¿äÃ»À» ¸·±â À§ÇÑ »ç¿ëÀÚ Æ¯Á¤ ±â¹ĞÀÌ Æ÷ÇÔµÇ¾î ÀÖ¾î¾ß ÇÕ´Ï´Ù.,CSRF(cross-site request forgery) Ãë¾àÁ¡Àº ´ÙÀ½ °æ¿ì¿¡ ¹ß»ıÇÕ´Ï´Ù.
1. À¥ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ¼¼¼Ç ÄíÅ°¸¦ »ç¿ëÇÕ´Ï´Ù.

2. ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ÇØ´ç ¿äÃ»ÀÌ »ç¿ëÀÚÀÇ µ¿ÀÇ ÇÏ¿¡ ÀÌ·ç¾îÁ³´ÂÁö È®ÀÎÇÏÁö ¾Ê°í HTTP ¿äÃ»¿¡ ´ëÇØ ÀÛ¾÷ÇÕ´Ï´Ù.



Nonce´Â ÀçÀü¼Û °ø°İÀ» ¸·±â À§ÇØ ¸Ş½ÃÁö¿Í ÇÔ²² Àü¼ÛµÈ ¾ÏÈ£È­ ¹«ÀÛÀ§ °ªÀÔ´Ï´Ù. ¿äÃ»¿¡ ÃâÃ³¸¦ Áõ¸íÇÏ´Â Á¤º¸°¡ Æ÷ÇÔµÇ¾î ÀÖÁö ¾ÊÀº °æ¿ì, ÇØ´ç ¿äÃ»À» Ã³¸®ÇÏ´Â ÄÚµå´Â CSRF °ø°İ¿¡ Ãë¾àÇÕ´Ï´Ù(ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ »óÅÂ¸¦ º¯°æÇÏÁö ¾Ê´Â °æ¿ì Á¦¿Ü). ÀÌ´Â °ø°İÀÚ°¡ »ç¿ëÀÚ·Î ÇÏ¿©±İ ÇãÀ§ ¿äÃ»À» Á¦ÃâÇÏµµ·Ï ¼ÓÀÌÁö ¸øÇÏ°Ô ÇÏ·Á¸é ¼¼¼Ç ÄíÅ°¸¦ »ç¿ëÇÏ´Â À¥ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ Æ¯º°ÇÑ ¿¹¹æ Á¶Ä¡¸¦ ÃëÇØ¾ß ÇÑ´Ù´Â ÀÇ¹ÌÀÔ´Ï´Ù. °ü¸®ÀÚ°¡ ´ÙÀ½°ú °°Àº ÆûÀ» Á¦ÃâÇÏ¿© »õ·Î¿î °èÁ¤À» »ı¼ºÇÏµµ·Ï Çã¿ëÇÏ´Â À¥ ÀÀ¿ë ÇÁ·Î±×·¥À» »ó»óÇØ º¸½Ê½Ã¿À.


<form method="POST" action="/new_user" >
  Name of new user: <input type="text" name="username">
  Password for new user: <input type="password" name="user_passwd">
    <input type="submit" name="action" value="Create User">
</form>


°ø°İÀÚ´Â ´ÙÀ½°ú °°ÀÌ À¥ »çÀÌÆ®¸¦ ¼³Á¤ÇÒ ¼öµµ ÀÖ½À´Ï´Ù.


<form method="POST" action="http://www.example.com/new_user">
  <input type="hidden" name="username" value="hacker">
  <input type="hidden" name="user_passwd" value="hacked">
</form>
<script>
  document.usr_form.submit();
</script>


¿¹¸¦ µé¾î example.comÀÇ °ü¸®ÀÚ°¡ »çÀÌÆ®¿¡¼­ ¼¼¼ÇÀ» È°¼ºÈ­ÇÑ »óÅÂ¿¡¼­ ¾Ç¼º ÆäÀÌÁö¸¦ ¹æ¹®ÇÏ´Â °æ¿ì ¹«ÀÇ½ÄÀûÀ¸·Î °ø°İÀÚ¸¦ À§ÇÑ °èÁ¤À» ¸¸µé°Ô µË´Ï´Ù. ÀÌ°ÍÀÌ CSRF °ø°İÀÔ´Ï´Ù. ÀÌ´Â ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ÇØ´ç ¿äÃ»ÀÇ ÃâÃ³¸¦ È®ÀÎÇÏ´Â ¹æ¹ıÀ» °¡Áö°í ÀÖÁö ¾Ê±â ¶§¹®ÀÔ´Ï´Ù. ¸ğµç ¿äÃ»Àº »ç¿ëÀÚ°¡ ¼±ÅÃÇÑ Àû¹ıÇÑ ÀÛ¾÷ÀÌ°Å³ª °ø°İÀÚ°¡ ¼³Á¤ÇÑ ÇãÀ§ ÀÛ¾÷ÀÏ °¡´É¼ºÀÌ ÀÖ½À´Ï´Ù. °ø°İÀÚ´Â ÇãÀ§ ¿äÃ»ÀÌ »ı¼ºÇÏ´Â À¥ ÆäÀÌÁö¸¦ º¸Áö ¸øÇÏ¹Ç·Î ÀÌ °ø°İ ±â¹ıÀº ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ »óÅÂ¸¦ º¯°æÇÏ´Â ¿äÃ»ÀÇ °æ¿ì¿¡¸¸ À¯¿ëÇÕ´Ï´Ù.

ÇÏÁö¸¸ ¼¼¼Ç ID¸¦ ÄíÅ°°¡ ¾Æ´Ñ URL¿¡¼­ Àü´ŞÇÏ´Â ÀÀ¿ë ÇÁ·Î±×·¥Àº °ø°İÀÚ°¡ ¼¼¼Ç ID¿¡ Á¢±ÙÇÏ¿© ÇãÀ§ ¿äÃ»ÀÇ ÀÏºÎ·Î Æ÷ÇÔ½ÃÅ³ ¹æ¹ıÀÌ ¾øÀ¸¹Ç·Î CSRF ¹®Á¦°¡ ¹ß»ıÇÏÁö ¾Ê½À´Ï´Ù.

CSRF´Â 2007 OWASP Top 10 ¸ñ·Ï¿¡¼­ Á¦ 5À§ÀÔ´Ï´Ù.,¼¼¼Ç ÄíÅ°¸¦ »ç¿ëÇÏ´Â ÀÀ¿ë ÇÁ·Î±×·¥Àº ¹é¿£µå ÄÚµå°¡ ¿äÃ»ÀÇ ÃâÃ³¸¦ °ËÁõÇÏ´Â µ¥ »ç¿ëÇÏ´Â ¸ğµç Æû °Ô½Ã¿¡ ¾à°£ÀÇ Á¤º¸¸¦ Æ÷ÇÔ½ÃÄÑ¾ß ÇÕ´Ï´Ù. ÀÌ·¸°Ô ÇÏ´Â ¹æ¹ı Áß ÇÏ³ª´Â ´ÙÀ½°ú °°ÀÌ ÀÓÀÇÀÇ ¿äÃ» ID ¶Ç´Â Nonce¸¦ Æ÷ÇÔ½ÃÅ°´Â °ÍÀÔ´Ï´Ù.


  RequestBuilder rb = new RequestBuilder(RequestBuilder.POST, "/new_user");
  body = addToPost(body, new_username);
  body = addToPost(body, new_passwd);
  body = addToPost(body, request_id);
  rb.sendRequest(body, new NewAccountCallback(callback));


ÀÌ·¸°Ô ÇÏ¸é ³ª¸ÓÁö Æû µ¥ÀÌÅÍ¸¦ Ã³¸®ÇÏ±â Àü¿¡ ¹é¿£µå ·ÎÁ÷ÀÌ ¿äÃ» ID¸¦ °ËÁõÇÒ ¼ö ÀÖ½À´Ï´Ù. °¡´ÉÇÑ °æ¿ì ¿äÃ» ID´Â Æ¯Á¤ ¼¼¼ÇÀÇ ¸ğµç ¿äÃ»¿¡¼­ °øÀ¯µÇ´Â °ÍÀÌ ¾Æ´Ï¶ó °¢ ¼­¹ö ¿äÃ»¿¡ ´ëÇØ °íÀ¯ÇØ¾ß ÇÕ´Ï´Ù. ¼¼¼Ç ID¸¦ »ç¿ëÇÏ¸é °ø°İÀÚ°¡ ¿äÃ» ID¸¦ ÃßÃøÇÏ±â ¾î·Á¿öÁö¸ç CSRF °ø°İÀ» ¼º°øÀûÀ¸·Î ¼öÇàÇÏ±â°¡ ¾î·Á¿öÁı´Ï´Ù. ÅäÅ«Àº ½±°Ô ÃßÃøÇÒ ¼ö ¾ø¾î¾ß ÇÏ¸ç ¼¼¼Ç ÅäÅ«À» º¸È£ÇÏ´Â °Í°ú µ¿ÀÏÇÑ ¹æ½Ä(¿¹: SSLv3 »ç¿ë)À¸·Î º¸È£µÇ¾î¾ß ÇÕ´Ï´Ù.

Ãß°¡ÀûÀÎ ¿ÏÈ­ ±â¹ı¿¡´Â ´ÙÀ½ÀÌ Æ÷ÇÔµË´Ï´Ù.

ÇÁ·¹ÀÓ¿öÅ© º¸È£: ´ëºÎºĞÀÇ ÃÖ½Å À¥ ÀÀ¿ë ÇÁ·Î±×·¥ ÇÁ·¹ÀÓ¿öÅ©´Â CSRF º¸È£¸¦ Æ÷ÇÔÇÏ¸ç CSRF ÅäÅ«À» ÀÚµ¿À¸·Î Æ÷ÇÔÇÏ°í È®ÀÎÇÕ´Ï´Ù.
Ã§¸°Áö-ÀÀ´ä Á¦¾î »ç¿ë: °í°´¿¡°Ô ¼­¹ö¿¡¼­ Àü¼ÛµÈ Ã§¸°Áö¿¡ ÀÀ´äÇÏµµ·Ï ¿ä±¸ÇÏ´Â °ÍÀº CSRF¿¡ ´ëÇÑ °­·ÂÇÑ ´ëºñÃ¥ÀÔ´Ï´Ù. ÀÌ ¿ëµµ·Î »ç¿ëÇÒ ¼ö ÀÖ´Â Ã§¸°Áö¿¡´Â CAPTCHA, ¾ÏÈ£ ÀçÀÎÁõ, ÀÏÈ¸¿ë ÅäÅ« µîÀÌ ÀÖ½À´Ï´Ù.
HTTP Referer/Origin Çì´õ °Ë»ç: °ø°İÀÚ°¡ CSRF °ø°İÀ» ½ÇÇàÇÏ´Â µ¿¾È ÀÌ·¯ÇÑ Çì´õ¸¦ ½ºÇªÇÎÇÒ ¼ö ¾ø½À´Ï´Ù. µû¶ó¼­ ÀÌ·¯ÇÑ Çì´õ°¡ CSRF °ø°İÀ» ¹æÁöÇÏ´Â À¯¿ëÇÑ ¹æ¹ıÀÌ µË´Ï´Ù.
¼¼¼Ç ÄíÅ° Áßº¹ Àü¼Û: ½ÇÁ¦ ¼¼¼Ç ID ÄíÅ°¿Í ÇÔ²² ¼û°ÜÁø Æû °ªÀ¸·Î ¼¼¼Ç ID ÄíÅ°¸¦ Àü¼ÛÇÏ¸é CSRF °ø°İ¿¡ ´ëÇØ ÀûÀıÇÑ º¸È£¸¦ Á¦°øÇÒ ¼ö ÀÖ½À´Ï´Ù. ¼­¹ö¿¡¼­´Â Æû µ¥ÀÌÅÍÀÇ ´Ù¸¥ °ªÀ» Ã³¸®ÇÏ±â Àü¿¡ µÎ °ªÀ» ¸ğµÎ °Ë»çÇÏ¿© µ¿ÀÏÇÑÁö È®ÀÎÇÕ´Ï´Ù. °ø°İÀÚ°¡ »ç¿ëÀÚ¸¦ °¡ÀåÇÏ¿© ÆûÀ» Àü¼ÛÇÏ´Â °æ¿ì µ¿ÀÏ ÃâÃ³ Á¤Ã¥¿¡ µû¶ó ¼¼¼Ç ID ÄíÅ° °ªÀ» ¼öÁ¤ÇÒ ¼ö ¾ø½À´Ï´Ù.
¼¼¼Ç ¼ö¸í Á¦ÇÑ: CSRF °ø°İÀ» »ç¿ëÇÏ¿© º¸È£µÈ ¸®¼Ò½º¿¡ Á¢±ÙÇÒ ¶§ °ø°İÀÇ ÀÏºÎ·Î Àü¼ÛÇÑ ¼¼¼Ç ID°¡ ¼­¹ö¿¡¼­ À¯È¿ÇÑ µ¿¾È¿¡¸¸ °ø°İÀÌ À¯È¿ÇÏ°Ô µË´Ï´Ù. µû¶ó¼­ ¼¼¼Ç ¼ö¸íÀ» Á¦ÇÑÇÏ¸é °ø°İ ¼º°ø °¡´É¼ºÀÌ ÁÙ¾îµì´Ï´Ù.

¿©±â¿¡¼­ ¼³¸íÇÏ´Â ±â¹ıÀº XSS °ø°İÀ¸·Î ¹«·ÂÈ­µË´Ï´Ù. È¿°úÀûÀÎ CSRF ¿ÏÈ­ ±â¹ı¿¡´Â XSS ¿ÏÈ­ ±â¹ıÀÌ Æ÷ÇÔµË´Ï´Ù.
,1. Fortify Static Code Analyzer´Â GET ¶Ç´Â POST ÀÛ¾÷À» ¼öÇàÇÒ °¡´É¼ºÀÌ ÀÖ´Â ¸ğµç HTML ¾ç½Ä ¹× XMLHttpRequest °³Ã¼¿¡ ÇÃ·¡±×¸¦ ÁöÁ¤ÇÕ´Ï´Ù. °¨»çÀÚ´Â °¢ ¾ç½ÄÀÌ °ø°İÀÚ¿¡°Ô CSRF ´ë»óÀ¸·Î¼­ °¡Ä¡°¡ ÀÖ´ÂÁö ¿©ºÎ¿Í ÇØ´çÇÏ´Â ¿ÏÈ­ ±â¹ıÀ» »ç¿ëÇÏ´ÂÁö ¿©ºÎ¸¦ È®ÀÎÇØ¾ß ÇÕ´Ï´Ù.,56FB5AE4E7E9BB62980D1AA7A3D90A86,78E0700E-56FE-45A2-A11B-6A560F730576,,,,2024-02-13,
Low,Low,Encapsulation,Cross-Site Request Forgery,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),login.html,login.html,,    </div>    -->

    <form  style="margin: auto;" action="login.do" method="POST">
        <center>?”¨?ˆ·?™»å½?</center><br/><br/>
        USER: <br/> <input type="text" name="user"></input><br/><br/>,Function: doPost(),login.html ÆÄÀÏÀÇ 16 ÁÙ¿¡ ÀÖ´Â Æû °Ô½Ã¿¡´Â °ø°İÀÚÀÇ ¹«´Ü ¿äÃ»À» ¸·±â À§ÇÑ »ç¿ëÀÚ Æ¯Á¤ ±â¹ĞÀÌ Æ÷ÇÔµÇ¾î ÀÖ¾î¾ß ÇÕ´Ï´Ù.,login.html ÆÄÀÏÀÇ 16 ÁÙ¿¡ ÀÖ´Â Æû °Ô½Ã¿¡´Â °ø°İÀÚÀÇ ¹«´Ü ¿äÃ»À» ¸·±â À§ÇÑ »ç¿ëÀÚ Æ¯Á¤ ±â¹ĞÀÌ Æ÷ÇÔµÇ¾î ÀÖ¾î¾ß ÇÕ´Ï´Ù.,CSRF(cross-site request forgery) Ãë¾àÁ¡Àº ´ÙÀ½ °æ¿ì¿¡ ¹ß»ıÇÕ´Ï´Ù.
1. À¥ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ¼¼¼Ç ÄíÅ°¸¦ »ç¿ëÇÕ´Ï´Ù.

2. ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ÇØ´ç ¿äÃ»ÀÌ »ç¿ëÀÚÀÇ µ¿ÀÇ ÇÏ¿¡ ÀÌ·ç¾îÁ³´ÂÁö È®ÀÎÇÏÁö ¾Ê°í HTTP ¿äÃ»¿¡ ´ëÇØ ÀÛ¾÷ÇÕ´Ï´Ù.



Nonce´Â ÀçÀü¼Û °ø°İÀ» ¸·±â À§ÇØ ¸Ş½ÃÁö¿Í ÇÔ²² Àü¼ÛµÈ ¾ÏÈ£È­ ¹«ÀÛÀ§ °ªÀÔ´Ï´Ù. ¿äÃ»¿¡ ÃâÃ³¸¦ Áõ¸íÇÏ´Â Á¤º¸°¡ Æ÷ÇÔµÇ¾î ÀÖÁö ¾ÊÀº °æ¿ì, ÇØ´ç ¿äÃ»À» Ã³¸®ÇÏ´Â ÄÚµå´Â CSRF °ø°İ¿¡ Ãë¾àÇÕ´Ï´Ù(ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ »óÅÂ¸¦ º¯°æÇÏÁö ¾Ê´Â °æ¿ì Á¦¿Ü). ÀÌ´Â °ø°İÀÚ°¡ »ç¿ëÀÚ·Î ÇÏ¿©±İ ÇãÀ§ ¿äÃ»À» Á¦ÃâÇÏµµ·Ï ¼ÓÀÌÁö ¸øÇÏ°Ô ÇÏ·Á¸é ¼¼¼Ç ÄíÅ°¸¦ »ç¿ëÇÏ´Â À¥ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ Æ¯º°ÇÑ ¿¹¹æ Á¶Ä¡¸¦ ÃëÇØ¾ß ÇÑ´Ù´Â ÀÇ¹ÌÀÔ´Ï´Ù. °ü¸®ÀÚ°¡ ´ÙÀ½°ú °°Àº ÆûÀ» Á¦ÃâÇÏ¿© »õ·Î¿î °èÁ¤À» »ı¼ºÇÏµµ·Ï Çã¿ëÇÏ´Â À¥ ÀÀ¿ë ÇÁ·Î±×·¥À» »ó»óÇØ º¸½Ê½Ã¿À.


<form method="POST" action="/new_user" >
  Name of new user: <input type="text" name="username">
  Password for new user: <input type="password" name="user_passwd">
    <input type="submit" name="action" value="Create User">
</form>


°ø°İÀÚ´Â ´ÙÀ½°ú °°ÀÌ À¥ »çÀÌÆ®¸¦ ¼³Á¤ÇÒ ¼öµµ ÀÖ½À´Ï´Ù.


<form method="POST" action="http://www.example.com/new_user">
  <input type="hidden" name="username" value="hacker">
  <input type="hidden" name="user_passwd" value="hacked">
</form>
<script>
  document.usr_form.submit();
</script>


¿¹¸¦ µé¾î example.comÀÇ °ü¸®ÀÚ°¡ »çÀÌÆ®¿¡¼­ ¼¼¼ÇÀ» È°¼ºÈ­ÇÑ »óÅÂ¿¡¼­ ¾Ç¼º ÆäÀÌÁö¸¦ ¹æ¹®ÇÏ´Â °æ¿ì ¹«ÀÇ½ÄÀûÀ¸·Î °ø°İÀÚ¸¦ À§ÇÑ °èÁ¤À» ¸¸µé°Ô µË´Ï´Ù. ÀÌ°ÍÀÌ CSRF °ø°İÀÔ´Ï´Ù. ÀÌ´Â ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ÇØ´ç ¿äÃ»ÀÇ ÃâÃ³¸¦ È®ÀÎÇÏ´Â ¹æ¹ıÀ» °¡Áö°í ÀÖÁö ¾Ê±â ¶§¹®ÀÔ´Ï´Ù. ¸ğµç ¿äÃ»Àº »ç¿ëÀÚ°¡ ¼±ÅÃÇÑ Àû¹ıÇÑ ÀÛ¾÷ÀÌ°Å³ª °ø°İÀÚ°¡ ¼³Á¤ÇÑ ÇãÀ§ ÀÛ¾÷ÀÏ °¡´É¼ºÀÌ ÀÖ½À´Ï´Ù. °ø°İÀÚ´Â ÇãÀ§ ¿äÃ»ÀÌ »ı¼ºÇÏ´Â À¥ ÆäÀÌÁö¸¦ º¸Áö ¸øÇÏ¹Ç·Î ÀÌ °ø°İ ±â¹ıÀº ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ »óÅÂ¸¦ º¯°æÇÏ´Â ¿äÃ»ÀÇ °æ¿ì¿¡¸¸ À¯¿ëÇÕ´Ï´Ù.

ÇÏÁö¸¸ ¼¼¼Ç ID¸¦ ÄíÅ°°¡ ¾Æ´Ñ URL¿¡¼­ Àü´ŞÇÏ´Â ÀÀ¿ë ÇÁ·Î±×·¥Àº °ø°İÀÚ°¡ ¼¼¼Ç ID¿¡ Á¢±ÙÇÏ¿© ÇãÀ§ ¿äÃ»ÀÇ ÀÏºÎ·Î Æ÷ÇÔ½ÃÅ³ ¹æ¹ıÀÌ ¾øÀ¸¹Ç·Î CSRF ¹®Á¦°¡ ¹ß»ıÇÏÁö ¾Ê½À´Ï´Ù.

CSRF´Â 2007 OWASP Top 10 ¸ñ·Ï¿¡¼­ Á¦ 5À§ÀÔ´Ï´Ù.,¼¼¼Ç ÄíÅ°¸¦ »ç¿ëÇÏ´Â ÀÀ¿ë ÇÁ·Î±×·¥Àº ¹é¿£µå ÄÚµå°¡ ¿äÃ»ÀÇ ÃâÃ³¸¦ °ËÁõÇÏ´Â µ¥ »ç¿ëÇÏ´Â ¸ğµç Æû °Ô½Ã¿¡ ¾à°£ÀÇ Á¤º¸¸¦ Æ÷ÇÔ½ÃÄÑ¾ß ÇÕ´Ï´Ù. ÀÌ·¸°Ô ÇÏ´Â ¹æ¹ı Áß ÇÏ³ª´Â ´ÙÀ½°ú °°ÀÌ ÀÓÀÇÀÇ ¿äÃ» ID ¶Ç´Â Nonce¸¦ Æ÷ÇÔ½ÃÅ°´Â °ÍÀÔ´Ï´Ù.


  RequestBuilder rb = new RequestBuilder(RequestBuilder.POST, "/new_user");
  body = addToPost(body, new_username);
  body = addToPost(body, new_passwd);
  body = addToPost(body, request_id);
  rb.sendRequest(body, new NewAccountCallback(callback));


ÀÌ·¸°Ô ÇÏ¸é ³ª¸ÓÁö Æû µ¥ÀÌÅÍ¸¦ Ã³¸®ÇÏ±â Àü¿¡ ¹é¿£µå ·ÎÁ÷ÀÌ ¿äÃ» ID¸¦ °ËÁõÇÒ ¼ö ÀÖ½À´Ï´Ù. °¡´ÉÇÑ °æ¿ì ¿äÃ» ID´Â Æ¯Á¤ ¼¼¼ÇÀÇ ¸ğµç ¿äÃ»¿¡¼­ °øÀ¯µÇ´Â °ÍÀÌ ¾Æ´Ï¶ó °¢ ¼­¹ö ¿äÃ»¿¡ ´ëÇØ °íÀ¯ÇØ¾ß ÇÕ´Ï´Ù. ¼¼¼Ç ID¸¦ »ç¿ëÇÏ¸é °ø°İÀÚ°¡ ¿äÃ» ID¸¦ ÃßÃøÇÏ±â ¾î·Á¿öÁö¸ç CSRF °ø°İÀ» ¼º°øÀûÀ¸·Î ¼öÇàÇÏ±â°¡ ¾î·Á¿öÁı´Ï´Ù. ÅäÅ«Àº ½±°Ô ÃßÃøÇÒ ¼ö ¾ø¾î¾ß ÇÏ¸ç ¼¼¼Ç ÅäÅ«À» º¸È£ÇÏ´Â °Í°ú µ¿ÀÏÇÑ ¹æ½Ä(¿¹: SSLv3 »ç¿ë)À¸·Î º¸È£µÇ¾î¾ß ÇÕ´Ï´Ù.

Ãß°¡ÀûÀÎ ¿ÏÈ­ ±â¹ı¿¡´Â ´ÙÀ½ÀÌ Æ÷ÇÔµË´Ï´Ù.

ÇÁ·¹ÀÓ¿öÅ© º¸È£: ´ëºÎºĞÀÇ ÃÖ½Å À¥ ÀÀ¿ë ÇÁ·Î±×·¥ ÇÁ·¹ÀÓ¿öÅ©´Â CSRF º¸È£¸¦ Æ÷ÇÔÇÏ¸ç CSRF ÅäÅ«À» ÀÚµ¿À¸·Î Æ÷ÇÔÇÏ°í È®ÀÎÇÕ´Ï´Ù.
Ã§¸°Áö-ÀÀ´ä Á¦¾î »ç¿ë: °í°´¿¡°Ô ¼­¹ö¿¡¼­ Àü¼ÛµÈ Ã§¸°Áö¿¡ ÀÀ´äÇÏµµ·Ï ¿ä±¸ÇÏ´Â °ÍÀº CSRF¿¡ ´ëÇÑ °­·ÂÇÑ ´ëºñÃ¥ÀÔ´Ï´Ù. ÀÌ ¿ëµµ·Î »ç¿ëÇÒ ¼ö ÀÖ´Â Ã§¸°Áö¿¡´Â CAPTCHA, ¾ÏÈ£ ÀçÀÎÁõ, ÀÏÈ¸¿ë ÅäÅ« µîÀÌ ÀÖ½À´Ï´Ù.
HTTP Referer/Origin Çì´õ °Ë»ç: °ø°İÀÚ°¡ CSRF °ø°İÀ» ½ÇÇàÇÏ´Â µ¿¾È ÀÌ·¯ÇÑ Çì´õ¸¦ ½ºÇªÇÎÇÒ ¼ö ¾ø½À´Ï´Ù. µû¶ó¼­ ÀÌ·¯ÇÑ Çì´õ°¡ CSRF °ø°İÀ» ¹æÁöÇÏ´Â À¯¿ëÇÑ ¹æ¹ıÀÌ µË´Ï´Ù.
¼¼¼Ç ÄíÅ° Áßº¹ Àü¼Û: ½ÇÁ¦ ¼¼¼Ç ID ÄíÅ°¿Í ÇÔ²² ¼û°ÜÁø Æû °ªÀ¸·Î ¼¼¼Ç ID ÄíÅ°¸¦ Àü¼ÛÇÏ¸é CSRF °ø°İ¿¡ ´ëÇØ ÀûÀıÇÑ º¸È£¸¦ Á¦°øÇÒ ¼ö ÀÖ½À´Ï´Ù. ¼­¹ö¿¡¼­´Â Æû µ¥ÀÌÅÍÀÇ ´Ù¸¥ °ªÀ» Ã³¸®ÇÏ±â Àü¿¡ µÎ °ªÀ» ¸ğµÎ °Ë»çÇÏ¿© µ¿ÀÏÇÑÁö È®ÀÎÇÕ´Ï´Ù. °ø°İÀÚ°¡ »ç¿ëÀÚ¸¦ °¡ÀåÇÏ¿© ÆûÀ» Àü¼ÛÇÏ´Â °æ¿ì µ¿ÀÏ ÃâÃ³ Á¤Ã¥¿¡ µû¶ó ¼¼¼Ç ID ÄíÅ° °ªÀ» ¼öÁ¤ÇÒ ¼ö ¾ø½À´Ï´Ù.
¼¼¼Ç ¼ö¸í Á¦ÇÑ: CSRF °ø°İÀ» »ç¿ëÇÏ¿© º¸È£µÈ ¸®¼Ò½º¿¡ Á¢±ÙÇÒ ¶§ °ø°İÀÇ ÀÏºÎ·Î Àü¼ÛÇÑ ¼¼¼Ç ID°¡ ¼­¹ö¿¡¼­ À¯È¿ÇÑ µ¿¾È¿¡¸¸ °ø°İÀÌ À¯È¿ÇÏ°Ô µË´Ï´Ù. µû¶ó¼­ ¼¼¼Ç ¼ö¸íÀ» Á¦ÇÑÇÏ¸é °ø°İ ¼º°ø °¡´É¼ºÀÌ ÁÙ¾îµì´Ï´Ù.

¿©±â¿¡¼­ ¼³¸íÇÏ´Â ±â¹ıÀº XSS °ø°İÀ¸·Î ¹«·ÂÈ­µË´Ï´Ù. È¿°úÀûÀÎ CSRF ¿ÏÈ­ ±â¹ı¿¡´Â XSS ¿ÏÈ­ ±â¹ıÀÌ Æ÷ÇÔµË´Ï´Ù.
,1. Fortify Static Code Analyzer´Â GET ¶Ç´Â POST ÀÛ¾÷À» ¼öÇàÇÒ °¡´É¼ºÀÌ ÀÖ´Â ¸ğµç HTML ¾ç½Ä ¹× XMLHttpRequest °³Ã¼¿¡ ÇÃ·¡±×¸¦ ÁöÁ¤ÇÕ´Ï´Ù. °¨»çÀÚ´Â °¢ ¾ç½ÄÀÌ °ø°İÀÚ¿¡°Ô CSRF ´ë»óÀ¸·Î¼­ °¡Ä¡°¡ ÀÖ´ÂÁö ¿©ºÎ¿Í ÇØ´çÇÏ´Â ¿ÏÈ­ ±â¹ıÀ» »ç¿ëÇÏ´ÂÁö ¿©ºÎ¸¦ È®ÀÎÇØ¾ß ÇÕ´Ï´Ù.,94FAB8D7062649FD7643BA144C209D75,78E0700E-56FE-45A2-A11B-6A560F730576,,,,2024-02-13,
Low,Low,Encapsulation,Cross-Site Request Forgery,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),register.html,register.html,,        <center><h1>?”¨?ˆ·ä¿¡æ¯</h1></center><br/>
    <br/><br/>
    <form action="register.do" method="POST">
    <span>å­??·: <input onmouseout = "SnoCheck()"  id="Sno"  type="text" name="Sno" /><p id="1"></p><br/><br/></span>
    <span>è´??·: <input onmouseout = "UserCheck()" id="User" type="text" name="LoginUser" ></input><p id="2"></p><br/><br/></span>,Function: doPost(),register.html ÆÄÀÏÀÇ 36 ÁÙ¿¡ ÀÖ´Â Æû °Ô½Ã¿¡´Â °ø°İÀÚÀÇ ¹«´Ü ¿äÃ»À» ¸·±â À§ÇÑ »ç¿ëÀÚ Æ¯Á¤ ±â¹ĞÀÌ Æ÷ÇÔµÇ¾î ÀÖ¾î¾ß ÇÕ´Ï´Ù.,login.html ÆÄÀÏÀÇ 16 ÁÙ¿¡ ÀÖ´Â Æû °Ô½Ã¿¡´Â °ø°İÀÚÀÇ ¹«´Ü ¿äÃ»À» ¸·±â À§ÇÑ »ç¿ëÀÚ Æ¯Á¤ ±â¹ĞÀÌ Æ÷ÇÔµÇ¾î ÀÖ¾î¾ß ÇÕ´Ï´Ù.,CSRF(cross-site request forgery) Ãë¾àÁ¡Àº ´ÙÀ½ °æ¿ì¿¡ ¹ß»ıÇÕ´Ï´Ù.
1. À¥ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ¼¼¼Ç ÄíÅ°¸¦ »ç¿ëÇÕ´Ï´Ù.

2. ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ÇØ´ç ¿äÃ»ÀÌ »ç¿ëÀÚÀÇ µ¿ÀÇ ÇÏ¿¡ ÀÌ·ç¾îÁ³´ÂÁö È®ÀÎÇÏÁö ¾Ê°í HTTP ¿äÃ»¿¡ ´ëÇØ ÀÛ¾÷ÇÕ´Ï´Ù.



Nonce´Â ÀçÀü¼Û °ø°İÀ» ¸·±â À§ÇØ ¸Ş½ÃÁö¿Í ÇÔ²² Àü¼ÛµÈ ¾ÏÈ£È­ ¹«ÀÛÀ§ °ªÀÔ´Ï´Ù. ¿äÃ»¿¡ ÃâÃ³¸¦ Áõ¸íÇÏ´Â Á¤º¸°¡ Æ÷ÇÔµÇ¾î ÀÖÁö ¾ÊÀº °æ¿ì, ÇØ´ç ¿äÃ»À» Ã³¸®ÇÏ´Â ÄÚµå´Â CSRF °ø°İ¿¡ Ãë¾àÇÕ´Ï´Ù(ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ »óÅÂ¸¦ º¯°æÇÏÁö ¾Ê´Â °æ¿ì Á¦¿Ü). ÀÌ´Â °ø°İÀÚ°¡ »ç¿ëÀÚ·Î ÇÏ¿©±İ ÇãÀ§ ¿äÃ»À» Á¦ÃâÇÏµµ·Ï ¼ÓÀÌÁö ¸øÇÏ°Ô ÇÏ·Á¸é ¼¼¼Ç ÄíÅ°¸¦ »ç¿ëÇÏ´Â À¥ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ Æ¯º°ÇÑ ¿¹¹æ Á¶Ä¡¸¦ ÃëÇØ¾ß ÇÑ´Ù´Â ÀÇ¹ÌÀÔ´Ï´Ù. °ü¸®ÀÚ°¡ ´ÙÀ½°ú °°Àº ÆûÀ» Á¦ÃâÇÏ¿© »õ·Î¿î °èÁ¤À» »ı¼ºÇÏµµ·Ï Çã¿ëÇÏ´Â À¥ ÀÀ¿ë ÇÁ·Î±×·¥À» »ó»óÇØ º¸½Ê½Ã¿À.


<form method="POST" action="/new_user" >
  Name of new user: <input type="text" name="username">
  Password for new user: <input type="password" name="user_passwd">
    <input type="submit" name="action" value="Create User">
</form>


°ø°İÀÚ´Â ´ÙÀ½°ú °°ÀÌ À¥ »çÀÌÆ®¸¦ ¼³Á¤ÇÒ ¼öµµ ÀÖ½À´Ï´Ù.


<form method="POST" action="http://www.example.com/new_user">
  <input type="hidden" name="username" value="hacker">
  <input type="hidden" name="user_passwd" value="hacked">
</form>
<script>
  document.usr_form.submit();
</script>


¿¹¸¦ µé¾î example.comÀÇ °ü¸®ÀÚ°¡ »çÀÌÆ®¿¡¼­ ¼¼¼ÇÀ» È°¼ºÈ­ÇÑ »óÅÂ¿¡¼­ ¾Ç¼º ÆäÀÌÁö¸¦ ¹æ¹®ÇÏ´Â °æ¿ì ¹«ÀÇ½ÄÀûÀ¸·Î °ø°İÀÚ¸¦ À§ÇÑ °èÁ¤À» ¸¸µé°Ô µË´Ï´Ù. ÀÌ°ÍÀÌ CSRF °ø°İÀÔ´Ï´Ù. ÀÌ´Â ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ÇØ´ç ¿äÃ»ÀÇ ÃâÃ³¸¦ È®ÀÎÇÏ´Â ¹æ¹ıÀ» °¡Áö°í ÀÖÁö ¾Ê±â ¶§¹®ÀÔ´Ï´Ù. ¸ğµç ¿äÃ»Àº »ç¿ëÀÚ°¡ ¼±ÅÃÇÑ Àû¹ıÇÑ ÀÛ¾÷ÀÌ°Å³ª °ø°İÀÚ°¡ ¼³Á¤ÇÑ ÇãÀ§ ÀÛ¾÷ÀÏ °¡´É¼ºÀÌ ÀÖ½À´Ï´Ù. °ø°İÀÚ´Â ÇãÀ§ ¿äÃ»ÀÌ »ı¼ºÇÏ´Â À¥ ÆäÀÌÁö¸¦ º¸Áö ¸øÇÏ¹Ç·Î ÀÌ °ø°İ ±â¹ıÀº ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ »óÅÂ¸¦ º¯°æÇÏ´Â ¿äÃ»ÀÇ °æ¿ì¿¡¸¸ À¯¿ëÇÕ´Ï´Ù.

ÇÏÁö¸¸ ¼¼¼Ç ID¸¦ ÄíÅ°°¡ ¾Æ´Ñ URL¿¡¼­ Àü´ŞÇÏ´Â ÀÀ¿ë ÇÁ·Î±×·¥Àº °ø°İÀÚ°¡ ¼¼¼Ç ID¿¡ Á¢±ÙÇÏ¿© ÇãÀ§ ¿äÃ»ÀÇ ÀÏºÎ·Î Æ÷ÇÔ½ÃÅ³ ¹æ¹ıÀÌ ¾øÀ¸¹Ç·Î CSRF ¹®Á¦°¡ ¹ß»ıÇÏÁö ¾Ê½À´Ï´Ù.

CSRF´Â 2007 OWASP Top 10 ¸ñ·Ï¿¡¼­ Á¦ 5À§ÀÔ´Ï´Ù.,¼¼¼Ç ÄíÅ°¸¦ »ç¿ëÇÏ´Â ÀÀ¿ë ÇÁ·Î±×·¥Àº ¹é¿£µå ÄÚµå°¡ ¿äÃ»ÀÇ ÃâÃ³¸¦ °ËÁõÇÏ´Â µ¥ »ç¿ëÇÏ´Â ¸ğµç Æû °Ô½Ã¿¡ ¾à°£ÀÇ Á¤º¸¸¦ Æ÷ÇÔ½ÃÄÑ¾ß ÇÕ´Ï´Ù. ÀÌ·¸°Ô ÇÏ´Â ¹æ¹ı Áß ÇÏ³ª´Â ´ÙÀ½°ú °°ÀÌ ÀÓÀÇÀÇ ¿äÃ» ID ¶Ç´Â Nonce¸¦ Æ÷ÇÔ½ÃÅ°´Â °ÍÀÔ´Ï´Ù.


  RequestBuilder rb = new RequestBuilder(RequestBuilder.POST, "/new_user");
  body = addToPost(body, new_username);
  body = addToPost(body, new_passwd);
  body = addToPost(body, request_id);
  rb.sendRequest(body, new NewAccountCallback(callback));


ÀÌ·¸°Ô ÇÏ¸é ³ª¸ÓÁö Æû µ¥ÀÌÅÍ¸¦ Ã³¸®ÇÏ±â Àü¿¡ ¹é¿£µå ·ÎÁ÷ÀÌ ¿äÃ» ID¸¦ °ËÁõÇÒ ¼ö ÀÖ½À´Ï´Ù. °¡´ÉÇÑ °æ¿ì ¿äÃ» ID´Â Æ¯Á¤ ¼¼¼ÇÀÇ ¸ğµç ¿äÃ»¿¡¼­ °øÀ¯µÇ´Â °ÍÀÌ ¾Æ´Ï¶ó °¢ ¼­¹ö ¿äÃ»¿¡ ´ëÇØ °íÀ¯ÇØ¾ß ÇÕ´Ï´Ù. ¼¼¼Ç ID¸¦ »ç¿ëÇÏ¸é °ø°İÀÚ°¡ ¿äÃ» ID¸¦ ÃßÃøÇÏ±â ¾î·Á¿öÁö¸ç CSRF °ø°İÀ» ¼º°øÀûÀ¸·Î ¼öÇàÇÏ±â°¡ ¾î·Á¿öÁı´Ï´Ù. ÅäÅ«Àº ½±°Ô ÃßÃøÇÒ ¼ö ¾ø¾î¾ß ÇÏ¸ç ¼¼¼Ç ÅäÅ«À» º¸È£ÇÏ´Â °Í°ú µ¿ÀÏÇÑ ¹æ½Ä(¿¹: SSLv3 »ç¿ë)À¸·Î º¸È£µÇ¾î¾ß ÇÕ´Ï´Ù.

Ãß°¡ÀûÀÎ ¿ÏÈ­ ±â¹ı¿¡´Â ´ÙÀ½ÀÌ Æ÷ÇÔµË´Ï´Ù.

ÇÁ·¹ÀÓ¿öÅ© º¸È£: ´ëºÎºĞÀÇ ÃÖ½Å À¥ ÀÀ¿ë ÇÁ·Î±×·¥ ÇÁ·¹ÀÓ¿öÅ©´Â CSRF º¸È£¸¦ Æ÷ÇÔÇÏ¸ç CSRF ÅäÅ«À» ÀÚµ¿À¸·Î Æ÷ÇÔÇÏ°í È®ÀÎÇÕ´Ï´Ù.
Ã§¸°Áö-ÀÀ´ä Á¦¾î »ç¿ë: °í°´¿¡°Ô ¼­¹ö¿¡¼­ Àü¼ÛµÈ Ã§¸°Áö¿¡ ÀÀ´äÇÏµµ·Ï ¿ä±¸ÇÏ´Â °ÍÀº CSRF¿¡ ´ëÇÑ °­·ÂÇÑ ´ëºñÃ¥ÀÔ´Ï´Ù. ÀÌ ¿ëµµ·Î »ç¿ëÇÒ ¼ö ÀÖ´Â Ã§¸°Áö¿¡´Â CAPTCHA, ¾ÏÈ£ ÀçÀÎÁõ, ÀÏÈ¸¿ë ÅäÅ« µîÀÌ ÀÖ½À´Ï´Ù.
HTTP Referer/Origin Çì´õ °Ë»ç: °ø°İÀÚ°¡ CSRF °ø°İÀ» ½ÇÇàÇÏ´Â µ¿¾È ÀÌ·¯ÇÑ Çì´õ¸¦ ½ºÇªÇÎÇÒ ¼ö ¾ø½À´Ï´Ù. µû¶ó¼­ ÀÌ·¯ÇÑ Çì´õ°¡ CSRF °ø°İÀ» ¹æÁöÇÏ´Â À¯¿ëÇÑ ¹æ¹ıÀÌ µË´Ï´Ù.
¼¼¼Ç ÄíÅ° Áßº¹ Àü¼Û: ½ÇÁ¦ ¼¼¼Ç ID ÄíÅ°¿Í ÇÔ²² ¼û°ÜÁø Æû °ªÀ¸·Î ¼¼¼Ç ID ÄíÅ°¸¦ Àü¼ÛÇÏ¸é CSRF °ø°İ¿¡ ´ëÇØ ÀûÀıÇÑ º¸È£¸¦ Á¦°øÇÒ ¼ö ÀÖ½À´Ï´Ù. ¼­¹ö¿¡¼­´Â Æû µ¥ÀÌÅÍÀÇ ´Ù¸¥ °ªÀ» Ã³¸®ÇÏ±â Àü¿¡ µÎ °ªÀ» ¸ğµÎ °Ë»çÇÏ¿© µ¿ÀÏÇÑÁö È®ÀÎÇÕ´Ï´Ù. °ø°İÀÚ°¡ »ç¿ëÀÚ¸¦ °¡ÀåÇÏ¿© ÆûÀ» Àü¼ÛÇÏ´Â °æ¿ì µ¿ÀÏ ÃâÃ³ Á¤Ã¥¿¡ µû¶ó ¼¼¼Ç ID ÄíÅ° °ªÀ» ¼öÁ¤ÇÒ ¼ö ¾ø½À´Ï´Ù.
¼¼¼Ç ¼ö¸í Á¦ÇÑ: CSRF °ø°İÀ» »ç¿ëÇÏ¿© º¸È£µÈ ¸®¼Ò½º¿¡ Á¢±ÙÇÒ ¶§ °ø°İÀÇ ÀÏºÎ·Î Àü¼ÛÇÑ ¼¼¼Ç ID°¡ ¼­¹ö¿¡¼­ À¯È¿ÇÑ µ¿¾È¿¡¸¸ °ø°İÀÌ À¯È¿ÇÏ°Ô µË´Ï´Ù. µû¶ó¼­ ¼¼¼Ç ¼ö¸íÀ» Á¦ÇÑÇÏ¸é °ø°İ ¼º°ø °¡´É¼ºÀÌ ÁÙ¾îµì´Ï´Ù.

¿©±â¿¡¼­ ¼³¸íÇÏ´Â ±â¹ıÀº XSS °ø°İÀ¸·Î ¹«·ÂÈ­µË´Ï´Ù. È¿°úÀûÀÎ CSRF ¿ÏÈ­ ±â¹ı¿¡´Â XSS ¿ÏÈ­ ±â¹ıÀÌ Æ÷ÇÔµË´Ï´Ù.
,1. Fortify Static Code Analyzer´Â GET ¶Ç´Â POST ÀÛ¾÷À» ¼öÇàÇÒ °¡´É¼ºÀÌ ÀÖ´Â ¸ğµç HTML ¾ç½Ä ¹× XMLHttpRequest °³Ã¼¿¡ ÇÃ·¡±×¸¦ ÁöÁ¤ÇÕ´Ï´Ù. °¨»çÀÚ´Â °¢ ¾ç½ÄÀÌ °ø°İÀÚ¿¡°Ô CSRF ´ë»óÀ¸·Î¼­ °¡Ä¡°¡ ÀÖ´ÂÁö ¿©ºÎ¿Í ÇØ´çÇÏ´Â ¿ÏÈ­ ±â¹ıÀ» »ç¿ëÇÏ´ÂÁö ¿©ºÎ¸¦ È®ÀÎÇØ¾ß ÇÕ´Ï´Ù.,F9BBA322F3EF4182501DBA402388E4E9,78E0700E-56FE-45A2-A11B-6A560F730576,,,,2024-02-13,
Low,Low,API Abuse,Missing Check against Null,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),login.jsp,login.jsp,,<body>

	<% String f = (String)request.getAttribute("res"); 
		if(f.substring(0, 1).equals("1")){
			,f = getAttribute(...) : ServletRequest.getAttribute may return NULL(),login.jspÀÇ _jspService() ¸Ş¼­µå´Â getAttribute()ÀÇ ¹İÈ¯ °ªÀ» È®ÀÎÇÏÁö ¾Ê¾Æ 16 ÁÙÀÇ null Æ÷ÀÎÅÍ¸¦ ¿ªÂüÁ¶ÇÒ ¼ö ÀÖÀ¸¹Ç·Î nullÀ» ¹İÈ¯ÇÒ ¼öµµ ÀÖ½À´Ï´Ù.,login.jspÀÇ _jspService() ¸Ş¼­µå´Â getAttribute()ÀÇ ¹İÈ¯ °ªÀ» È®ÀÎÇÏÁö ¾Ê¾Æ 16 ÁÙÀÇ null Æ÷ÀÎÅÍ¸¦ ¿ªÂüÁ¶ÇÒ ¼ö ÀÖÀ¸¹Ç·Î nullÀ» ¹İÈ¯ÇÒ ¼öµµ ÀÖ½À´Ï´Ù.,¼ÒÇÁÆ®¿ş¾î¿¡ ´ëÇÑ ´ëºÎºĞÀÇ ½É°¢ÇÑ °ø°İÀº ÇÁ·Î±×·¡¸ÓÀÇ °¡Á¤ À§¹İ¿¡¼­ ºñ·ÔµË´Ï´Ù. °ø°İ ÈÄ, ÇÁ·Î±×·¡¸ÓÀÇ °¡Á¤Àº Ãë¾àÇÏ°í ±Ù°Å°¡ ºó¾àÇØ º¸ÀÌÁö¸¸ °ø°İ Àü¿¡´Â ¸¹Àº ÇÁ·Î±×·¡¸Ó°¡ ¿­½ÉÈ÷ ÀÚ½ÅÀÇ °¡Á¤À» ¿ËÈ£ÇÏ°Ô ¸¶·ÃÀÔ´Ï´Ù.

ÄÚµå¿¡¼­ ÈçÈ÷ ¹ß°ßµÇ´Â µÎ °¡Áö ÀÇ½É½º·± °¡Á¤Àº "ÀÌ ÇÔ¼ö È£ÃâÀº Àı´ë ½ÇÆĞÇÏÁö ¾Ê´Â´Ù" ¹× "ÀÌ ÇÔ¼ö È£ÃâÀÌ ½ÇÆĞÇØµµ »ó°ü ¾ø´Ù"ÀÔ´Ï´Ù. ÇÁ·Î±×·¡¸Ó°¡ ÇÔ¼öÀÇ ¹İÈ¯ °ªÀ» ¹«½ÃÇÏ´Â °æ¿ì ¾Ï½ÃÀûÀ¸·Î ÀÌ °¡Á¤ Áß ÇÏ³ª¿¡ µû¶ó µ¿ÀÛÇÏ´Â °ÍÀ¸·Î º¼ ¼ö ÀÖ½À´Ï´Ù.



¿¹Á¦ 1:  ´ÙÀ½ ÄÚµå´Â ¸â¹ö ÇÔ¼ö compareTo()¸¦ È£ÃâÇÏ±â Àü¿¡ getParameter()°¡ ¹İÈ¯ÇÑ ¹®ÀÚ¿­ÀÌ nullÀÎÁö °Ë»çÇÏÁö ¾Ê±â ¶§¹®¿¡ null dereference°¡ ¹ß»ıÇÒ ¼ö ÀÖ½À´Ï´Ù.


String itemName = request.getParameter(ITEM_NAME);
	if (itemName.compareTo(IMPORTANT_ITEM)) {
		...
	}
	...


¿¹Á¦ 2: ´ÙÀ½ ÄÚµå´Â null·Î ¼³Á¤µÇ¸é ÇØ´ç ¼Ó¼ºÀÌ Ç×»ó Á¤ÀÇµÈ´Ù´Â Àß¸øµÈ °¡Á¤À» ÇÏ´Â ÇÁ·Î±×·¡¸Ó°¡ ¿ªÂüÁ¶ÇÏ´Â ½Ã½ºÅÛ ¼Ó¼ºÀ» º¸¿©Áİ´Ï´Ù.


System.clearProperty("os.name");
...
String os = System.getProperty("os.name");
if (os.equalsIgnoreCase("Windows 95") )
	System.out.println("Not supported");


ÀÌ ÄÚµù ¿À·ù¿¡ ´ëÇÑ ÀüÇüÀûÀÎ º¯¸íÀº ÀÌ·¸½À´Ï´Ù. 

¡°¿äÃ»ÇÑ °ªÀÌ Ç×»ó Á¸ÀçÇÑ´Ù´Â °ÍÀ» ¾Ë°í ÀÖ½À´Ï´Ù. ¿Ö³ÄÇÏ¸é... °ªÀÌ Á¸ÀçÇÏÁö ¾Ê´Â °æ¿ì, ÇÁ·Î±×·¥ÀÌ ÇÊ¿äÇÑ µ¿ÀÛÀ» ¼öÇàÇÒ ¼ö ¾ø±â ¶§¹®¿¡ ¿À·ù Ã³¸® ¿©ºÎ°¡ Áß¿äÇÏÁö ¾Ê°Å³ª ÇÁ·Î±×·¥ÀÌ null °ªÀ» ¿ªÂüÁ¶ÇÏ´Ù°¡ ÁßÁöÇØµµ »ó°ü ¾ø½À´Ï´Ù.¡±

ÇÏÁö¸¸ °ø°İÀÚ´Â ÇÁ·Î±×·¥¿¡¼­ ¿¹±âÄ¡ ¸øÇÑ °æ·Î¸¦ Ã£¾Æ³»´Â µ¥ ´É¼÷ÇÏ¸ç ¿¹¿Ü¿Í °ü·ÃÀÌ ÀÖ´Â °æ¿ì°¡ ´ëÇ¥ÀûÀÎ ¿¹ÀÔ´Ï´Ù.,ÇÔ¼ö°¡ ¿À·ù ÄÚµå¸¦ ¹İÈ¯ÇÏ°Å³ª ´Ù¸¥ ¼º°ø ¶Ç´Â ½ÇÆĞÀÇ Áõ°Å¸¦ ¹İÈ¯ÇÏ´Â °æ¿ì, ¿À·ù°¡ ¹ß»ıÇÏ´Â È®½ÇÇÑ ¹æ¹ıÀÌ ¾ø´Â °æ¿ì¿¡µµ Ç×»ó ¿À·ù Á¶°ÇÀ» °Ë»çÇÏ½Ê½Ã¿À. º¸¾È ¿À·ù¸¦ ¿¹¹æÇÏ´Â °Íµµ Áß¿äÇÏÁö¸¸ ÃÊ±â¿¡ ÀÇ½É½º·¯¿î ¼ö¸¹Àº ¹ö±×°¡ °á±¹ unchecked return value¿Í ÇÔ²² ¸Ş¼Òµå È£Ãâ ½ÇÆĞ·Î ÀÌ¾îÁı´Ï´Ù.

ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­ ½ÇÆĞ¸¦ ÇØ°áÇÏ±â À§ÇØ »ç¿ëÇÏ±â ½¬¿î Ç¥ÁØ ¹æ¹ıÀ» ¸¸µå½Ê½Ã¿À. ¿À·ù Ã³¸®°¡ ´Ü¼ø¸í·áÇÏ´Ù¸é ÇÁ·Î±×·¡¸Ó°¡ ¿À·ù Ã³¸®¸¦ »ı·«ÇÏÁö ¾ÊÀ» °ÍÀÔ´Ï´Ù. ¿À·ù Ã³¸®¸¦ Ç¥ÁØÈ­ÇÏ´Â ÇÑ °¡Áö Á¢±Ù ¹æ½ÄÀº ÀÚÁÖ »ç¿ëÇÏ´Â ÇÔ¼ö ÁÖÀ§¿¡ Ãß°¡ ÇÁ·Î±×·¡¸Ó °³ÀÔ ¾øÀÌ ¿À·ù Á¶°ÇÀ» °Ë»çÇÏ°í Ã³¸®ÇÏ´Â ·¡ÆÛ¸¦ ÀÛ¼ºÇÏ´Â °ÍÀÔ´Ï´Ù. ·¡ÆÛ¸¦ ±¸ÇöÇÏ¿© Àû¿ëÇÏ¸é »ç¿ëÀÚ ÁöÁ¤ ±ÔÄ¢À» »ç¿ëÇÏ¿© ·¡ÆÛ ¾ø´Â ÇÔ¼ö¸¦ »ç¿ëÇÏ´Â °ÍÀ» ±İÁöÇÏ°í °­Á¦ÇÒ ¼ö ÀÖ½À´Ï´Ù. 

¿¹Á¦ 3: ´ÙÀ½ ÄÚµå´Â getParameter()ÀÇ ¹İÈ¯ °ªÀÌ nullÀÌ ¾Æ´ÑÁö °Ë»çÇÏ°í ¿äÃ»ÇÑ ¸Å°³ º¯¼ö°¡ Á¤ÀÇµÇ¾î ÀÖÁö ¾ÊÀº °æ¿ì ±âº»°ªÀ» »ç¿ëÇÏ´Â ·¡ÆÛ¸¦ getParameter() ¼Ó¼º ÁÖÀ§¿¡ ±¸ÇöÇÕ´Ï´Ù.


String safeGetParameter (HttpRequest request, String name)
{
    String value = request.getParameter(name);
    if (value == null) {
        return getDefaultValue(name)
    }
    return value;
}
,1. "±×·± ÀÏÀº Àı´ë ÀÏ¾î³¯ ¼ö ¾ø½À´Ï´Ù. ¿Ö³ÄÇÏ¸é..."ÀÌ¶ó°í ¸»ÇÏ¸é¼­ ÀÌ ÀÌ½´¸¦ µ¤¾îµÎ·Á´Â ÇÁ·Î±×·¡¸Ó¸¦ Á¶½ÉÇÏ½Ê½Ã¿À. ÀÌµéÀº °³¹ß ¿öÅ©½ºÅ×ÀÌ¼ÇÀ» »ç¿ëÇÏ¿© ½Ã½ºÅÛ µ¿ÀÛ ¹æ½Ä¿¡ ´ëÇÑ Á÷°ü·ÂÀ» Å°¿üÀ» °¡´É¼ºÀÌ Å®´Ï´Ù. ¼ÒÇÁÆ®¿ş¾î¸¦ ´Ù¸¥ ¿î¿µ Ã¼Á¦, ´Ù¸¥ ¿î¿µ Ã¼Á¦ ¹öÀü, ´Ù¸¥ ÇÏµå¿ş¾î ±¸¼º ¶Ç´Â ´Ù¸¥ ·±Å¸ÀÓ È¯°æ¿¡¼­ ½ÇÇàÇÏ°Ô µÇ¸é ÀÌµéÀÇ Á÷°ü·ÂÀº ¹«¿ëÁö¹°ÀÌ µÉ ¼ö ÀÖ½À´Ï´Ù.,3C32B62872F71A75A0DC74034AEFC341,4280F38B-9FDB-454E-B495-89CF45CD51B7,,,,2024-02-13,
Low,Low,API Abuse,Missing Check against Null,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),register.jsp,register.jsp,,</head>
<body >
	<% String f = (String)request.getAttribute("res");
		if(f.equals("true")){
	%>,f = getAttribute(...) : ServletRequest.getAttribute may return NULL(),register.jspÀÇ _jspService() ¸Ş¼­µå´Â getAttribute()ÀÇ ¹İÈ¯ °ªÀ» È®ÀÎÇÏÁö ¾Ê¾Æ 12 ÁÙÀÇ null Æ÷ÀÎÅÍ¸¦ ¿ªÂüÁ¶ÇÒ ¼ö ÀÖÀ¸¹Ç·Î nullÀ» ¹İÈ¯ÇÒ ¼öµµ ÀÖ½À´Ï´Ù.,login.jspÀÇ _jspService() ¸Ş¼­µå´Â getAttribute()ÀÇ ¹İÈ¯ °ªÀ» È®ÀÎÇÏÁö ¾Ê¾Æ 16 ÁÙÀÇ null Æ÷ÀÎÅÍ¸¦ ¿ªÂüÁ¶ÇÒ ¼ö ÀÖÀ¸¹Ç·Î nullÀ» ¹İÈ¯ÇÒ ¼öµµ ÀÖ½À´Ï´Ù.,¼ÒÇÁÆ®¿ş¾î¿¡ ´ëÇÑ ´ëºÎºĞÀÇ ½É°¢ÇÑ °ø°İÀº ÇÁ·Î±×·¡¸ÓÀÇ °¡Á¤ À§¹İ¿¡¼­ ºñ·ÔµË´Ï´Ù. °ø°İ ÈÄ, ÇÁ·Î±×·¡¸ÓÀÇ °¡Á¤Àº Ãë¾àÇÏ°í ±Ù°Å°¡ ºó¾àÇØ º¸ÀÌÁö¸¸ °ø°İ Àü¿¡´Â ¸¹Àº ÇÁ·Î±×·¡¸Ó°¡ ¿­½ÉÈ÷ ÀÚ½ÅÀÇ °¡Á¤À» ¿ËÈ£ÇÏ°Ô ¸¶·ÃÀÔ´Ï´Ù.

ÄÚµå¿¡¼­ ÈçÈ÷ ¹ß°ßµÇ´Â µÎ °¡Áö ÀÇ½É½º·± °¡Á¤Àº "ÀÌ ÇÔ¼ö È£ÃâÀº Àı´ë ½ÇÆĞÇÏÁö ¾Ê´Â´Ù" ¹× "ÀÌ ÇÔ¼ö È£ÃâÀÌ ½ÇÆĞÇØµµ »ó°ü ¾ø´Ù"ÀÔ´Ï´Ù. ÇÁ·Î±×·¡¸Ó°¡ ÇÔ¼öÀÇ ¹İÈ¯ °ªÀ» ¹«½ÃÇÏ´Â °æ¿ì ¾Ï½ÃÀûÀ¸·Î ÀÌ °¡Á¤ Áß ÇÏ³ª¿¡ µû¶ó µ¿ÀÛÇÏ´Â °ÍÀ¸·Î º¼ ¼ö ÀÖ½À´Ï´Ù.



¿¹Á¦ 1:  ´ÙÀ½ ÄÚµå´Â ¸â¹ö ÇÔ¼ö compareTo()¸¦ È£ÃâÇÏ±â Àü¿¡ getParameter()°¡ ¹İÈ¯ÇÑ ¹®ÀÚ¿­ÀÌ nullÀÎÁö °Ë»çÇÏÁö ¾Ê±â ¶§¹®¿¡ null dereference°¡ ¹ß»ıÇÒ ¼ö ÀÖ½À´Ï´Ù.


String itemName = request.getParameter(ITEM_NAME);
	if (itemName.compareTo(IMPORTANT_ITEM)) {
		...
	}
	...


¿¹Á¦ 2: ´ÙÀ½ ÄÚµå´Â null·Î ¼³Á¤µÇ¸é ÇØ´ç ¼Ó¼ºÀÌ Ç×»ó Á¤ÀÇµÈ´Ù´Â Àß¸øµÈ °¡Á¤À» ÇÏ´Â ÇÁ·Î±×·¡¸Ó°¡ ¿ªÂüÁ¶ÇÏ´Â ½Ã½ºÅÛ ¼Ó¼ºÀ» º¸¿©Áİ´Ï´Ù.


System.clearProperty("os.name");
...
String os = System.getProperty("os.name");
if (os.equalsIgnoreCase("Windows 95") )
	System.out.println("Not supported");


ÀÌ ÄÚµù ¿À·ù¿¡ ´ëÇÑ ÀüÇüÀûÀÎ º¯¸íÀº ÀÌ·¸½À´Ï´Ù. 

¡°¿äÃ»ÇÑ °ªÀÌ Ç×»ó Á¸ÀçÇÑ´Ù´Â °ÍÀ» ¾Ë°í ÀÖ½À´Ï´Ù. ¿Ö³ÄÇÏ¸é... °ªÀÌ Á¸ÀçÇÏÁö ¾Ê´Â °æ¿ì, ÇÁ·Î±×·¥ÀÌ ÇÊ¿äÇÑ µ¿ÀÛÀ» ¼öÇàÇÒ ¼ö ¾ø±â ¶§¹®¿¡ ¿À·ù Ã³¸® ¿©ºÎ°¡ Áß¿äÇÏÁö ¾Ê°Å³ª ÇÁ·Î±×·¥ÀÌ null °ªÀ» ¿ªÂüÁ¶ÇÏ´Ù°¡ ÁßÁöÇØµµ »ó°ü ¾ø½À´Ï´Ù.¡±

ÇÏÁö¸¸ °ø°İÀÚ´Â ÇÁ·Î±×·¥¿¡¼­ ¿¹±âÄ¡ ¸øÇÑ °æ·Î¸¦ Ã£¾Æ³»´Â µ¥ ´É¼÷ÇÏ¸ç ¿¹¿Ü¿Í °ü·ÃÀÌ ÀÖ´Â °æ¿ì°¡ ´ëÇ¥ÀûÀÎ ¿¹ÀÔ´Ï´Ù.,ÇÔ¼ö°¡ ¿À·ù ÄÚµå¸¦ ¹İÈ¯ÇÏ°Å³ª ´Ù¸¥ ¼º°ø ¶Ç´Â ½ÇÆĞÀÇ Áõ°Å¸¦ ¹İÈ¯ÇÏ´Â °æ¿ì, ¿À·ù°¡ ¹ß»ıÇÏ´Â È®½ÇÇÑ ¹æ¹ıÀÌ ¾ø´Â °æ¿ì¿¡µµ Ç×»ó ¿À·ù Á¶°ÇÀ» °Ë»çÇÏ½Ê½Ã¿À. º¸¾È ¿À·ù¸¦ ¿¹¹æÇÏ´Â °Íµµ Áß¿äÇÏÁö¸¸ ÃÊ±â¿¡ ÀÇ½É½º·¯¿î ¼ö¸¹Àº ¹ö±×°¡ °á±¹ unchecked return value¿Í ÇÔ²² ¸Ş¼Òµå È£Ãâ ½ÇÆĞ·Î ÀÌ¾îÁı´Ï´Ù.

ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­ ½ÇÆĞ¸¦ ÇØ°áÇÏ±â À§ÇØ »ç¿ëÇÏ±â ½¬¿î Ç¥ÁØ ¹æ¹ıÀ» ¸¸µå½Ê½Ã¿À. ¿À·ù Ã³¸®°¡ ´Ü¼ø¸í·áÇÏ´Ù¸é ÇÁ·Î±×·¡¸Ó°¡ ¿À·ù Ã³¸®¸¦ »ı·«ÇÏÁö ¾ÊÀ» °ÍÀÔ´Ï´Ù. ¿À·ù Ã³¸®¸¦ Ç¥ÁØÈ­ÇÏ´Â ÇÑ °¡Áö Á¢±Ù ¹æ½ÄÀº ÀÚÁÖ »ç¿ëÇÏ´Â ÇÔ¼ö ÁÖÀ§¿¡ Ãß°¡ ÇÁ·Î±×·¡¸Ó °³ÀÔ ¾øÀÌ ¿À·ù Á¶°ÇÀ» °Ë»çÇÏ°í Ã³¸®ÇÏ´Â ·¡ÆÛ¸¦ ÀÛ¼ºÇÏ´Â °ÍÀÔ´Ï´Ù. ·¡ÆÛ¸¦ ±¸ÇöÇÏ¿© Àû¿ëÇÏ¸é »ç¿ëÀÚ ÁöÁ¤ ±ÔÄ¢À» »ç¿ëÇÏ¿© ·¡ÆÛ ¾ø´Â ÇÔ¼ö¸¦ »ç¿ëÇÏ´Â °ÍÀ» ±İÁöÇÏ°í °­Á¦ÇÒ ¼ö ÀÖ½À´Ï´Ù. 

¿¹Á¦ 3: ´ÙÀ½ ÄÚµå´Â getParameter()ÀÇ ¹İÈ¯ °ªÀÌ nullÀÌ ¾Æ´ÑÁö °Ë»çÇÏ°í ¿äÃ»ÇÑ ¸Å°³ º¯¼ö°¡ Á¤ÀÇµÇ¾î ÀÖÁö ¾ÊÀº °æ¿ì ±âº»°ªÀ» »ç¿ëÇÏ´Â ·¡ÆÛ¸¦ getParameter() ¼Ó¼º ÁÖÀ§¿¡ ±¸ÇöÇÕ´Ï´Ù.


String safeGetParameter (HttpRequest request, String name)
{
    String value = request.getParameter(name);
    if (value == null) {
        return getDefaultValue(name)
    }
    return value;
}
,1. "±×·± ÀÏÀº Àı´ë ÀÏ¾î³¯ ¼ö ¾ø½À´Ï´Ù. ¿Ö³ÄÇÏ¸é..."ÀÌ¶ó°í ¸»ÇÏ¸é¼­ ÀÌ ÀÌ½´¸¦ µ¤¾îµÎ·Á´Â ÇÁ·Î±×·¡¸Ó¸¦ Á¶½ÉÇÏ½Ê½Ã¿À. ÀÌµéÀº °³¹ß ¿öÅ©½ºÅ×ÀÌ¼ÇÀ» »ç¿ëÇÏ¿© ½Ã½ºÅÛ µ¿ÀÛ ¹æ½Ä¿¡ ´ëÇÑ Á÷°ü·ÂÀ» Å°¿üÀ» °¡´É¼ºÀÌ Å®´Ï´Ù. ¼ÒÇÁÆ®¿ş¾î¸¦ ´Ù¸¥ ¿î¿µ Ã¼Á¦, ´Ù¸¥ ¿î¿µ Ã¼Á¦ ¹öÀü, ´Ù¸¥ ÇÏµå¿ş¾î ±¸¼º ¶Ç´Â ´Ù¸¥ ·±Å¸ÀÓ È¯°æ¿¡¼­ ½ÇÇàÇÏ°Ô µÇ¸é ÀÌµéÀÇ Á÷°ü·ÂÀº ¹«¿ëÁö¹°ÀÌ µÉ ¼ö ÀÖ½À´Ï´Ù.,4B46D0EFD19B8C2C48CC00079DB08926,4280F38B-9FDB-454E-B495-89CF45CD51B7,,,,2024-02-13,
Low,Low,API Abuse,Missing Check against Null,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),login.jsp,login.jsp,,			
	%>
	<p>Hello, <%= ((String)request.getAttribute("res")).substring(1) %></p>
	<% }else{
		%>,getAttribute(...) : ServletRequest.getAttribute may return NULL(),login.jspÀÇ _jspService() ¸Ş¼­µå´Â getAttribute()ÀÇ ¹İÈ¯ °ªÀ» È®ÀÎÇÏÁö ¾Ê¾Æ 19 ÁÙÀÇ null Æ÷ÀÎÅÍ¸¦ ¿ªÂüÁ¶ÇÒ ¼ö ÀÖÀ¸¹Ç·Î nullÀ» ¹İÈ¯ÇÒ ¼öµµ ÀÖ½À´Ï´Ù.,login.jspÀÇ _jspService() ¸Ş¼­µå´Â getAttribute()ÀÇ ¹İÈ¯ °ªÀ» È®ÀÎÇÏÁö ¾Ê¾Æ 16 ÁÙÀÇ null Æ÷ÀÎÅÍ¸¦ ¿ªÂüÁ¶ÇÒ ¼ö ÀÖÀ¸¹Ç·Î nullÀ» ¹İÈ¯ÇÒ ¼öµµ ÀÖ½À´Ï´Ù.,¼ÒÇÁÆ®¿ş¾î¿¡ ´ëÇÑ ´ëºÎºĞÀÇ ½É°¢ÇÑ °ø°İÀº ÇÁ·Î±×·¡¸ÓÀÇ °¡Á¤ À§¹İ¿¡¼­ ºñ·ÔµË´Ï´Ù. °ø°İ ÈÄ, ÇÁ·Î±×·¡¸ÓÀÇ °¡Á¤Àº Ãë¾àÇÏ°í ±Ù°Å°¡ ºó¾àÇØ º¸ÀÌÁö¸¸ °ø°İ Àü¿¡´Â ¸¹Àº ÇÁ·Î±×·¡¸Ó°¡ ¿­½ÉÈ÷ ÀÚ½ÅÀÇ °¡Á¤À» ¿ËÈ£ÇÏ°Ô ¸¶·ÃÀÔ´Ï´Ù.

ÄÚµå¿¡¼­ ÈçÈ÷ ¹ß°ßµÇ´Â µÎ °¡Áö ÀÇ½É½º·± °¡Á¤Àº "ÀÌ ÇÔ¼ö È£ÃâÀº Àı´ë ½ÇÆĞÇÏÁö ¾Ê´Â´Ù" ¹× "ÀÌ ÇÔ¼ö È£ÃâÀÌ ½ÇÆĞÇØµµ »ó°ü ¾ø´Ù"ÀÔ´Ï´Ù. ÇÁ·Î±×·¡¸Ó°¡ ÇÔ¼öÀÇ ¹İÈ¯ °ªÀ» ¹«½ÃÇÏ´Â °æ¿ì ¾Ï½ÃÀûÀ¸·Î ÀÌ °¡Á¤ Áß ÇÏ³ª¿¡ µû¶ó µ¿ÀÛÇÏ´Â °ÍÀ¸·Î º¼ ¼ö ÀÖ½À´Ï´Ù.



¿¹Á¦ 1:  ´ÙÀ½ ÄÚµå´Â ¸â¹ö ÇÔ¼ö compareTo()¸¦ È£ÃâÇÏ±â Àü¿¡ getParameter()°¡ ¹İÈ¯ÇÑ ¹®ÀÚ¿­ÀÌ nullÀÎÁö °Ë»çÇÏÁö ¾Ê±â ¶§¹®¿¡ null dereference°¡ ¹ß»ıÇÒ ¼ö ÀÖ½À´Ï´Ù.


String itemName = request.getParameter(ITEM_NAME);
	if (itemName.compareTo(IMPORTANT_ITEM)) {
		...
	}
	...


¿¹Á¦ 2: ´ÙÀ½ ÄÚµå´Â null·Î ¼³Á¤µÇ¸é ÇØ´ç ¼Ó¼ºÀÌ Ç×»ó Á¤ÀÇµÈ´Ù´Â Àß¸øµÈ °¡Á¤À» ÇÏ´Â ÇÁ·Î±×·¡¸Ó°¡ ¿ªÂüÁ¶ÇÏ´Â ½Ã½ºÅÛ ¼Ó¼ºÀ» º¸¿©Áİ´Ï´Ù.


System.clearProperty("os.name");
...
String os = System.getProperty("os.name");
if (os.equalsIgnoreCase("Windows 95") )
	System.out.println("Not supported");


ÀÌ ÄÚµù ¿À·ù¿¡ ´ëÇÑ ÀüÇüÀûÀÎ º¯¸íÀº ÀÌ·¸½À´Ï´Ù. 

¡°¿äÃ»ÇÑ °ªÀÌ Ç×»ó Á¸ÀçÇÑ´Ù´Â °ÍÀ» ¾Ë°í ÀÖ½À´Ï´Ù. ¿Ö³ÄÇÏ¸é... °ªÀÌ Á¸ÀçÇÏÁö ¾Ê´Â °æ¿ì, ÇÁ·Î±×·¥ÀÌ ÇÊ¿äÇÑ µ¿ÀÛÀ» ¼öÇàÇÒ ¼ö ¾ø±â ¶§¹®¿¡ ¿À·ù Ã³¸® ¿©ºÎ°¡ Áß¿äÇÏÁö ¾Ê°Å³ª ÇÁ·Î±×·¥ÀÌ null °ªÀ» ¿ªÂüÁ¶ÇÏ´Ù°¡ ÁßÁöÇØµµ »ó°ü ¾ø½À´Ï´Ù.¡±

ÇÏÁö¸¸ °ø°İÀÚ´Â ÇÁ·Î±×·¥¿¡¼­ ¿¹±âÄ¡ ¸øÇÑ °æ·Î¸¦ Ã£¾Æ³»´Â µ¥ ´É¼÷ÇÏ¸ç ¿¹¿Ü¿Í °ü·ÃÀÌ ÀÖ´Â °æ¿ì°¡ ´ëÇ¥ÀûÀÎ ¿¹ÀÔ´Ï´Ù.,ÇÔ¼ö°¡ ¿À·ù ÄÚµå¸¦ ¹İÈ¯ÇÏ°Å³ª ´Ù¸¥ ¼º°ø ¶Ç´Â ½ÇÆĞÀÇ Áõ°Å¸¦ ¹İÈ¯ÇÏ´Â °æ¿ì, ¿À·ù°¡ ¹ß»ıÇÏ´Â È®½ÇÇÑ ¹æ¹ıÀÌ ¾ø´Â °æ¿ì¿¡µµ Ç×»ó ¿À·ù Á¶°ÇÀ» °Ë»çÇÏ½Ê½Ã¿À. º¸¾È ¿À·ù¸¦ ¿¹¹æÇÏ´Â °Íµµ Áß¿äÇÏÁö¸¸ ÃÊ±â¿¡ ÀÇ½É½º·¯¿î ¼ö¸¹Àº ¹ö±×°¡ °á±¹ unchecked return value¿Í ÇÔ²² ¸Ş¼Òµå È£Ãâ ½ÇÆĞ·Î ÀÌ¾îÁı´Ï´Ù.

ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­ ½ÇÆĞ¸¦ ÇØ°áÇÏ±â À§ÇØ »ç¿ëÇÏ±â ½¬¿î Ç¥ÁØ ¹æ¹ıÀ» ¸¸µå½Ê½Ã¿À. ¿À·ù Ã³¸®°¡ ´Ü¼ø¸í·áÇÏ´Ù¸é ÇÁ·Î±×·¡¸Ó°¡ ¿À·ù Ã³¸®¸¦ »ı·«ÇÏÁö ¾ÊÀ» °ÍÀÔ´Ï´Ù. ¿À·ù Ã³¸®¸¦ Ç¥ÁØÈ­ÇÏ´Â ÇÑ °¡Áö Á¢±Ù ¹æ½ÄÀº ÀÚÁÖ »ç¿ëÇÏ´Â ÇÔ¼ö ÁÖÀ§¿¡ Ãß°¡ ÇÁ·Î±×·¡¸Ó °³ÀÔ ¾øÀÌ ¿À·ù Á¶°ÇÀ» °Ë»çÇÏ°í Ã³¸®ÇÏ´Â ·¡ÆÛ¸¦ ÀÛ¼ºÇÏ´Â °ÍÀÔ´Ï´Ù. ·¡ÆÛ¸¦ ±¸ÇöÇÏ¿© Àû¿ëÇÏ¸é »ç¿ëÀÚ ÁöÁ¤ ±ÔÄ¢À» »ç¿ëÇÏ¿© ·¡ÆÛ ¾ø´Â ÇÔ¼ö¸¦ »ç¿ëÇÏ´Â °ÍÀ» ±İÁöÇÏ°í °­Á¦ÇÒ ¼ö ÀÖ½À´Ï´Ù. 

¿¹Á¦ 3: ´ÙÀ½ ÄÚµå´Â getParameter()ÀÇ ¹İÈ¯ °ªÀÌ nullÀÌ ¾Æ´ÑÁö °Ë»çÇÏ°í ¿äÃ»ÇÑ ¸Å°³ º¯¼ö°¡ Á¤ÀÇµÇ¾î ÀÖÁö ¾ÊÀº °æ¿ì ±âº»°ªÀ» »ç¿ëÇÏ´Â ·¡ÆÛ¸¦ getParameter() ¼Ó¼º ÁÖÀ§¿¡ ±¸ÇöÇÕ´Ï´Ù.


String safeGetParameter (HttpRequest request, String name)
{
    String value = request.getParameter(name);
    if (value == null) {
        return getDefaultValue(name)
    }
    return value;
}
,1. "±×·± ÀÏÀº Àı´ë ÀÏ¾î³¯ ¼ö ¾ø½À´Ï´Ù. ¿Ö³ÄÇÏ¸é..."ÀÌ¶ó°í ¸»ÇÏ¸é¼­ ÀÌ ÀÌ½´¸¦ µ¤¾îµÎ·Á´Â ÇÁ·Î±×·¡¸Ó¸¦ Á¶½ÉÇÏ½Ê½Ã¿À. ÀÌµéÀº °³¹ß ¿öÅ©½ºÅ×ÀÌ¼ÇÀ» »ç¿ëÇÏ¿© ½Ã½ºÅÛ µ¿ÀÛ ¹æ½Ä¿¡ ´ëÇÑ Á÷°ü·ÂÀ» Å°¿üÀ» °¡´É¼ºÀÌ Å®´Ï´Ù. ¼ÒÇÁÆ®¿ş¾î¸¦ ´Ù¸¥ ¿î¿µ Ã¼Á¦, ´Ù¸¥ ¿î¿µ Ã¼Á¦ ¹öÀü, ´Ù¸¥ ÇÏµå¿ş¾î ±¸¼º ¶Ç´Â ´Ù¸¥ ·±Å¸ÀÓ È¯°æ¿¡¼­ ½ÇÇàÇÏ°Ô µÇ¸é ÀÌµéÀÇ Á÷°ü·ÂÀº ¹«¿ëÁö¹°ÀÌ µÉ ¼ö ÀÖ½À´Ï´Ù.,2FE6DD40847D6E8E121FE9262C1ED052,4280F38B-9FDB-454E-B495-89CF45CD51B7,,,,2024-02-13,
Low,Low,Encapsulation,Poor Logging Practice: Use of a System Output Stream,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/MyContextListener.java,MyContextListener.java,,			Connection conn = DriverManager.getConnection(url, user, pass);
			sc.setAttribute("conn", conn);
			System.out.println("Connect Succeed!");
		}
		catch(Exception e){,FunctionCall: println(),Àü¿ë ·Î±ë ±â´É ´ë½Å println()À» »ç¿ëÇÏ¸é ÇÁ·Î±×·¥ µ¿ÀÛÀ» ¸ğ´ÏÅÍ¸µÇÏ±â°¡ ¾î·Æ½À´Ï´Ù.,Àü¿ë ·Î±ë ±â´É ´ë½Å println()À» »ç¿ëÇÏ¸é ÇÁ·Î±×·¥ µ¿ÀÛÀ» ¸ğ´ÏÅÍ¸µÇÏ±â°¡ ¾î·Æ½À´Ï´Ù.,¿¹Á¦ 1: °³¹ßÀÚ°¡ ¹è¿ì´Â °úÁ¤¿¡¼­ ÀÛ¼ºÇÏ´Â Ã¹ Java ÇÁ·Î±×·¥Àº ´ÙÀ½°ú °°½À´Ï´Ù.


public class MyClass
  ...
    System.out.println("hello world");
  ...
}


´ëºÎºĞÀÇ ÇÁ·Î±×·¡¸Ó°¡ JavaÀÇ ¼ö¸¹Àº ³ëÇÏ¿ì¿Í ¼¼ºÎ »çÇ×À» ¹è¿ì°Ô µÇÁö¸¸ »ó´ç¼öÀÇ ÇÁ·Î±×·¡¸Ó°¡ ÀÌ Ã¹ ¼ö¾÷¿¡ ÁıÂøÇÑ ³ª¸ÓÁö System.out.println()À» »ç¿ëÇÏ¿© Ç¥ÁØ Ãâ·Â¿¡ ¸Ş½ÃÁö¸¦ ¾²´Â °ÍÀ» ±×¸¸µÎÁö ¾Ê½À´Ï´Ù.

¹®Á¦´Â Ç¥ÁØ Ãâ·ÂÀÌ³ª Ç¥ÁØ ¿À·ù¿¡ Á÷Á¢ ¾²´Â °ÍÀÌ ±¸Á¶È­µÇÁö ¾ÊÀº Çü½ÄÀÇ ·Î±ëÀ¸·Î ÀÌ¿ëµÇ´Â ÀÏÀÌ Àæ´Ù´Â Á¡ÀÔ´Ï´Ù. ±¸Á¶È­µÈ ·Î±ë ±â´ÉÀº ·Î±ë ¼öÁØ, ´ÜÀÏ ¼­½Ä, ·Î°Å ID, Å¸ÀÓ½ºÅÆÇÁ ¹× ¹«¾ùº¸´Ù Áß¿äÇÑ, ·Î±× ¸Ş½ÃÁö¸¦ ¿Ã¹Ù¸¥ À§Ä¡¿¡ º¸³»´Â ±â´É µîÀÇ ±â´ÉÀ» Á¦°øÇÕ´Ï´Ù. ½Ã½ºÅÛ Ãâ·Â ½ºÆ®¸² »ç¿ëÀÌ ·Î°Å¸¦ ¿Ã¹Ù·Î »ç¿ëÇÏ´Â ÄÚµå¿Í È¥ÇÕµÇ¸é Àß ±â·ÏµÇ±ä ÇßÁö¸¸ Áß¿äÇÑ Á¤º¸°¡ ´©¶ôµÈ ·Î±×°¡ »ı¼ºµË´Ï´Ù.

°³¹ßÀÚ´Â ±¸Á¶È­µÈ ·Î±ëÀÇ ÇÊ¿ä¼ºÀ» Æø³Ğ°Ô ÀÌÇØÇÏÁö¸¸ »ó´ç¼ö°¡ "¿î¿ë Àü" °³¹ß ´Ü°è¿¡¼­ ½Ã½ºÅÛ Ãâ·Â ½ºÆ®¸²À» °è¼Ó »ç¿ëÇÕ´Ï´Ù. °ËÅä ÁßÀÎ ÄÚµå°¡ ÃÊ±â °³¹ß ´Ü°è¸¦ Áö³­ °æ¿ì, System.out ¶Ç´Â System.err »ç¿ëÀÌ ¹ß°ßµÇ¸é ÀÌ´Â ±¸Á¶È­µÈ ·Î±ë ½Ã½ºÅÛÀ¸·Î ¿Å°Ü°¡´Â µµÁß ½Ç¼öÇÑ °ÍÀÏ ¼ö ÀÖ½À´Ï´Ù.,System.out ¶Ç´Â System.err ´ë½Å Java ·Î±ë ±â´ÉÀ» »ç¿ëÇÏ½Ê½Ã¿À. 

¿¹Á¦ 2: ¿¹¸¦ µé¾î, Example 1ÀÇ ¡°hello world¡± ÇÁ·Î±×·¥Àº log4j¸¦ »ç¿ëÇÏ¿© ´ÙÀ½°ú °°ÀÌ ´Ù½Ã ÀÛ¼ºÇÒ ¼ö ÀÖ½À´Ï´Ù.


import org.apache.log4j.Logger;
import org.apache.log4j.BasicConfigurator;

public class MyClass {
  private final static Logger logger =
            Logger.getLogger(MyClass.class);

  ...
    BasicConfigurator.configure();
    logger.info("hello world");
  ...
}
,1. Fortify Static Code Analyzer¿¡¼­´Â ¿¹¿ÜÀûÀ¸·Î System.out ¶Ç´Â System.errÀ» main() ¹× ¸Ş¼­µå(main() ÀÇ È£Ãâ °èÃş)¿¡ »ç¿ëÇÒ ¼ö ÀÖÀ¸¸ç ÀÌ·¯ÇÑ »ç¿ëÀ» Poor Logging Practice:  Use of a System Output Stream ÀÌ½´·Î º¸°íÇÏÁö ¾Ê½À´Ï´Ù.,88008082069DDB8934BAC242EE9E27DD,F972FE42-6C15-47D2-BD5C-448166A574C2,,,,2024-02-13,
Low,Low,Encapsulation,Poor Logging Practice: Use of a System Output Stream,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/LoginServlet.java,LoginServlet.java,,	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		System.out.println("Login Test");
		String user = request.getParameter("user");
		String pass = request.getParameter("pass");,FunctionCall: println(),Àü¿ë ·Î±ë ±â´É ´ë½Å println()À» »ç¿ëÇÏ¸é ÇÁ·Î±×·¥ µ¿ÀÛÀ» ¸ğ´ÏÅÍ¸µÇÏ±â°¡ ¾î·Æ½À´Ï´Ù.,Àü¿ë ·Î±ë ±â´É ´ë½Å println()À» »ç¿ëÇÏ¸é ÇÁ·Î±×·¥ µ¿ÀÛÀ» ¸ğ´ÏÅÍ¸µÇÏ±â°¡ ¾î·Æ½À´Ï´Ù.,¿¹Á¦ 1: °³¹ßÀÚ°¡ ¹è¿ì´Â °úÁ¤¿¡¼­ ÀÛ¼ºÇÏ´Â Ã¹ Java ÇÁ·Î±×·¥Àº ´ÙÀ½°ú °°½À´Ï´Ù.


public class MyClass
  ...
    System.out.println("hello world");
  ...
}


´ëºÎºĞÀÇ ÇÁ·Î±×·¡¸Ó°¡ JavaÀÇ ¼ö¸¹Àº ³ëÇÏ¿ì¿Í ¼¼ºÎ »çÇ×À» ¹è¿ì°Ô µÇÁö¸¸ »ó´ç¼öÀÇ ÇÁ·Î±×·¡¸Ó°¡ ÀÌ Ã¹ ¼ö¾÷¿¡ ÁıÂøÇÑ ³ª¸ÓÁö System.out.println()À» »ç¿ëÇÏ¿© Ç¥ÁØ Ãâ·Â¿¡ ¸Ş½ÃÁö¸¦ ¾²´Â °ÍÀ» ±×¸¸µÎÁö ¾Ê½À´Ï´Ù.

¹®Á¦´Â Ç¥ÁØ Ãâ·ÂÀÌ³ª Ç¥ÁØ ¿À·ù¿¡ Á÷Á¢ ¾²´Â °ÍÀÌ ±¸Á¶È­µÇÁö ¾ÊÀº Çü½ÄÀÇ ·Î±ëÀ¸·Î ÀÌ¿ëµÇ´Â ÀÏÀÌ Àæ´Ù´Â Á¡ÀÔ´Ï´Ù. ±¸Á¶È­µÈ ·Î±ë ±â´ÉÀº ·Î±ë ¼öÁØ, ´ÜÀÏ ¼­½Ä, ·Î°Å ID, Å¸ÀÓ½ºÅÆÇÁ ¹× ¹«¾ùº¸´Ù Áß¿äÇÑ, ·Î±× ¸Ş½ÃÁö¸¦ ¿Ã¹Ù¸¥ À§Ä¡¿¡ º¸³»´Â ±â´É µîÀÇ ±â´ÉÀ» Á¦°øÇÕ´Ï´Ù. ½Ã½ºÅÛ Ãâ·Â ½ºÆ®¸² »ç¿ëÀÌ ·Î°Å¸¦ ¿Ã¹Ù·Î »ç¿ëÇÏ´Â ÄÚµå¿Í È¥ÇÕµÇ¸é Àß ±â·ÏµÇ±ä ÇßÁö¸¸ Áß¿äÇÑ Á¤º¸°¡ ´©¶ôµÈ ·Î±×°¡ »ı¼ºµË´Ï´Ù.

°³¹ßÀÚ´Â ±¸Á¶È­µÈ ·Î±ëÀÇ ÇÊ¿ä¼ºÀ» Æø³Ğ°Ô ÀÌÇØÇÏÁö¸¸ »ó´ç¼ö°¡ "¿î¿ë Àü" °³¹ß ´Ü°è¿¡¼­ ½Ã½ºÅÛ Ãâ·Â ½ºÆ®¸²À» °è¼Ó »ç¿ëÇÕ´Ï´Ù. °ËÅä ÁßÀÎ ÄÚµå°¡ ÃÊ±â °³¹ß ´Ü°è¸¦ Áö³­ °æ¿ì, System.out ¶Ç´Â System.err »ç¿ëÀÌ ¹ß°ßµÇ¸é ÀÌ´Â ±¸Á¶È­µÈ ·Î±ë ½Ã½ºÅÛÀ¸·Î ¿Å°Ü°¡´Â µµÁß ½Ç¼öÇÑ °ÍÀÏ ¼ö ÀÖ½À´Ï´Ù.,System.out ¶Ç´Â System.err ´ë½Å Java ·Î±ë ±â´ÉÀ» »ç¿ëÇÏ½Ê½Ã¿À. 

¿¹Á¦ 2: ¿¹¸¦ µé¾î, Example 1ÀÇ ¡°hello world¡± ÇÁ·Î±×·¥Àº log4j¸¦ »ç¿ëÇÏ¿© ´ÙÀ½°ú °°ÀÌ ´Ù½Ã ÀÛ¼ºÇÒ ¼ö ÀÖ½À´Ï´Ù.


import org.apache.log4j.Logger;
import org.apache.log4j.BasicConfigurator;

public class MyClass {
  private final static Logger logger =
            Logger.getLogger(MyClass.class);

  ...
    BasicConfigurator.configure();
    logger.info("hello world");
  ...
}
,1. Fortify Static Code Analyzer¿¡¼­´Â ¿¹¿ÜÀûÀ¸·Î System.out ¶Ç´Â System.errÀ» main() ¹× ¸Ş¼­µå(main() ÀÇ È£Ãâ °èÃş)¿¡ »ç¿ëÇÒ ¼ö ÀÖÀ¸¸ç ÀÌ·¯ÇÑ »ç¿ëÀ» Poor Logging Practice:  Use of a System Output Stream ÀÌ½´·Î º¸°íÇÏÁö ¾Ê½À´Ï´Ù.,62793514B5C14E58E34A6C82F6EAA2FC,F972FE42-6C15-47D2-BD5C-448166A574C2,,,,2024-02-13,
Low,Low,Encapsulation,Poor Logging Practice: Use of a System Output Stream,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/registerServlet.java,registerServlet.java,,			if(f){
				res = "true";
				System.out.println("f = true");
				sql = "insert into user values('" + sno + "', '" + user + "', '" + pass + "')";
				state.executeUpdate(sql);		,FunctionCall: println(),Àü¿ë ·Î±ë ±â´É ´ë½Å println()À» »ç¿ëÇÏ¸é ÇÁ·Î±×·¥ µ¿ÀÛÀ» ¸ğ´ÏÅÍ¸µÇÏ±â°¡ ¾î·Æ½À´Ï´Ù.,Àü¿ë ·Î±ë ±â´É ´ë½Å println()À» »ç¿ëÇÏ¸é ÇÁ·Î±×·¥ µ¿ÀÛÀ» ¸ğ´ÏÅÍ¸µÇÏ±â°¡ ¾î·Æ½À´Ï´Ù.,¿¹Á¦ 1: °³¹ßÀÚ°¡ ¹è¿ì´Â °úÁ¤¿¡¼­ ÀÛ¼ºÇÏ´Â Ã¹ Java ÇÁ·Î±×·¥Àº ´ÙÀ½°ú °°½À´Ï´Ù.


public class MyClass
  ...
    System.out.println("hello world");
  ...
}


´ëºÎºĞÀÇ ÇÁ·Î±×·¡¸Ó°¡ JavaÀÇ ¼ö¸¹Àº ³ëÇÏ¿ì¿Í ¼¼ºÎ »çÇ×À» ¹è¿ì°Ô µÇÁö¸¸ »ó´ç¼öÀÇ ÇÁ·Î±×·¡¸Ó°¡ ÀÌ Ã¹ ¼ö¾÷¿¡ ÁıÂøÇÑ ³ª¸ÓÁö System.out.println()À» »ç¿ëÇÏ¿© Ç¥ÁØ Ãâ·Â¿¡ ¸Ş½ÃÁö¸¦ ¾²´Â °ÍÀ» ±×¸¸µÎÁö ¾Ê½À´Ï´Ù.

¹®Á¦´Â Ç¥ÁØ Ãâ·ÂÀÌ³ª Ç¥ÁØ ¿À·ù¿¡ Á÷Á¢ ¾²´Â °ÍÀÌ ±¸Á¶È­µÇÁö ¾ÊÀº Çü½ÄÀÇ ·Î±ëÀ¸·Î ÀÌ¿ëµÇ´Â ÀÏÀÌ Àæ´Ù´Â Á¡ÀÔ´Ï´Ù. ±¸Á¶È­µÈ ·Î±ë ±â´ÉÀº ·Î±ë ¼öÁØ, ´ÜÀÏ ¼­½Ä, ·Î°Å ID, Å¸ÀÓ½ºÅÆÇÁ ¹× ¹«¾ùº¸´Ù Áß¿äÇÑ, ·Î±× ¸Ş½ÃÁö¸¦ ¿Ã¹Ù¸¥ À§Ä¡¿¡ º¸³»´Â ±â´É µîÀÇ ±â´ÉÀ» Á¦°øÇÕ´Ï´Ù. ½Ã½ºÅÛ Ãâ·Â ½ºÆ®¸² »ç¿ëÀÌ ·Î°Å¸¦ ¿Ã¹Ù·Î »ç¿ëÇÏ´Â ÄÚµå¿Í È¥ÇÕµÇ¸é Àß ±â·ÏµÇ±ä ÇßÁö¸¸ Áß¿äÇÑ Á¤º¸°¡ ´©¶ôµÈ ·Î±×°¡ »ı¼ºµË´Ï´Ù.

°³¹ßÀÚ´Â ±¸Á¶È­µÈ ·Î±ëÀÇ ÇÊ¿ä¼ºÀ» Æø³Ğ°Ô ÀÌÇØÇÏÁö¸¸ »ó´ç¼ö°¡ "¿î¿ë Àü" °³¹ß ´Ü°è¿¡¼­ ½Ã½ºÅÛ Ãâ·Â ½ºÆ®¸²À» °è¼Ó »ç¿ëÇÕ´Ï´Ù. °ËÅä ÁßÀÎ ÄÚµå°¡ ÃÊ±â °³¹ß ´Ü°è¸¦ Áö³­ °æ¿ì, System.out ¶Ç´Â System.err »ç¿ëÀÌ ¹ß°ßµÇ¸é ÀÌ´Â ±¸Á¶È­µÈ ·Î±ë ½Ã½ºÅÛÀ¸·Î ¿Å°Ü°¡´Â µµÁß ½Ç¼öÇÑ °ÍÀÏ ¼ö ÀÖ½À´Ï´Ù.,System.out ¶Ç´Â System.err ´ë½Å Java ·Î±ë ±â´ÉÀ» »ç¿ëÇÏ½Ê½Ã¿À. 

¿¹Á¦ 2: ¿¹¸¦ µé¾î, Example 1ÀÇ ¡°hello world¡± ÇÁ·Î±×·¥Àº log4j¸¦ »ç¿ëÇÏ¿© ´ÙÀ½°ú °°ÀÌ ´Ù½Ã ÀÛ¼ºÇÒ ¼ö ÀÖ½À´Ï´Ù.


import org.apache.log4j.Logger;
import org.apache.log4j.BasicConfigurator;

public class MyClass {
  private final static Logger logger =
            Logger.getLogger(MyClass.class);

  ...
    BasicConfigurator.configure();
    logger.info("hello world");
  ...
}
,1. Fortify Static Code Analyzer¿¡¼­´Â ¿¹¿ÜÀûÀ¸·Î System.out ¶Ç´Â System.errÀ» main() ¹× ¸Ş¼­µå(main() ÀÇ È£Ãâ °èÃş)¿¡ »ç¿ëÇÒ ¼ö ÀÖÀ¸¸ç ÀÌ·¯ÇÑ »ç¿ëÀ» Poor Logging Practice:  Use of a System Output Stream ÀÌ½´·Î º¸°íÇÏÁö ¾Ê½À´Ï´Ù.,3634AD4EBCD44C770289CB4C84EFC8FC,F972FE42-6C15-47D2-BD5C-448166A574C2,,,,2024-02-13,
Low,Low,Encapsulation,System Information Leak,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/LoginServlet.java,LoginServlet.java,,		}
		catch(Exception e){
			e.printStackTrace();
		}
	},printStackTrace(),LoginServlet.javaÀÇ doPost() ÇÔ¼ö´Â 54 ÁÙÀÇ printStackTrace()À»(¸¦) È£ÃâÇÏ¿© ½Ã½ºÅÛ µ¥ÀÌÅÍ ¶Ç´Â µğ¹ö±× Á¤º¸¸¦ ³ëÃâÇÕ´Ï´Ù. printStackTrace()¿¡ ÀÇÇØ ³ëÃâµÈ Á¤º¸´Â °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀ» ÁÙ ¼ö ÀÖ½À´Ï´Ù.,LoginServlet.javaÀÇ doPost() ÇÔ¼ö´Â 54 ÁÙÀÇ printStackTrace()À»(¸¦) È£ÃâÇÏ¿© ½Ã½ºÅÛ µ¥ÀÌÅÍ ¶Ç´Â µğ¹ö±× Á¤º¸¸¦ ³ëÃâÇÕ´Ï´Ù. printStackTrace()¿¡ ÀÇÇØ ³ëÃâµÈ Á¤º¸´Â °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀ» ÁÙ ¼ö ÀÖ½À´Ï´Ù.,Á¤º¸ ´©ÃâÀº ½Ã½ºÅÛ µ¥ÀÌÅÍ ¶Ç´Â µğ¹ö±× Á¤º¸°¡ Ãâ·Â ½ºÆ®¸²ÀÌ³ª ·Î±ë ÇÔ¼ö¸¦ ÅëÇØ ÇÁ·Î±×·¥À» ¹ş¾î³¯ ¶§ ¹ß»ıÇÕ´Ï´Ù.



¿¹Á¦ 1: ´ÙÀ½ ÄÚµå´Â Ç¥ÁØ ¿À·ù ½ºÆ®¸²¿¡ ¿¹¿Ü »çÇ×À» ÀÛ¼ºÇÕ´Ï´Ù.


try {
    ...
} catch (Exception e) {
    e.printStackTrace();
}


½Ã½ºÅÛ ±¸¼º¿¡ µû¶ó ÀÌ Á¤º¸´Â ÄÜ¼Ö¿¡ ´ıÇÁµÇ°Å³ª ·Î±× ÆÄÀÏ¿¡ ÀÛ¼ºµÇ°Å³ª ¿ø°İ »ç¿ëÀÚ¿¡°Ô ³ëÃâµÉ ¼ö ÀÖ½À´Ï´Ù. ¿¹¸¦ µé¾î, ½ºÅ©¸³ÆÃ ¸ŞÄ¿´ÏÁòÀ» »ç¿ëÇÏ¸é "Ç¥ÁØ ¿À·ù" ¶Ç´Â "Ç¥ÁØ Ãâ·Â"¿¡¼­ ÆÄÀÏÀÌ³ª ´Ù¸¥ ÇÁ·Î±×·¥À¸·Î Ãâ·Â Á¤º¸¸¦ °£´ÜÇÏ°Ô ¸®µğ·º¼ÇÇÒ ¼ö ÀÖ½À´Ï´Ù. ¶Ç´Â ÇÁ·Î±×·¥ÀÌ ½ÇÇàµÇ´Â ½Ã½ºÅÛ¿¡´Â ·Î±×¸¦ ¿ø°İ ÀåÄ¡·Î Àü¼ÛÇÏ´Â "syslog" ¼­¹ö¿Í °°Àº ¿ø°İ ·Î±ë ¸ŞÄ¿´ÏÁòÀÌ ÀÖÀ» ¼ö ÀÖ½À´Ï´Ù. °³¹ß ´Ü°è¿¡¼­´Â ÀÌ Á¤º¸°¡ ¾îµğ¿¡ Ç¥½ÃµÉÁö ¾Ë ¹æ¹ıÀÌ ¾ø½À´Ï´Ù.

°æ¿ì¿¡ µû¶ó ¿À·ù ¸Ş½ÃÁö°¡ °ø°İÀÚ¿¡°Ô ½Ã½ºÅÛÀÌ Ãë¾àÇÑ Á¤È®ÇÑ °ø°İ À¯ÇüÀ» ¾Ë·ÁÁÖ±âµµ ÇÕ´Ï´Ù. ¿¹¸¦ µé¾î, µ¥ÀÌÅÍº£ÀÌ½º ¿À·ù ¸Ş½ÃÁö°¡ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ SQL injection °ø°İ¿¡ Ãë¾àÇÏ´Ù´Â °ÍÀ» µå·¯³¾ ¼ö ÀÖ½À´Ï´Ù. ´Ù¸¥ ¿À·ù ¸Ş½ÃÁöµµ ºñ±³Àû ¸ğÈ£ÇÏÁö¸¸ ½Ã½ºÅÛ¿¡ ´ëÇÑ ´Ü¼­¸¦ Á¦°øÇÕ´Ï´Ù. Example 1¿¡¼­´Â ´©ÃâµÈ Á¤º¸°¡ ¿î¿µ Ã¼Á¦ÀÇ Á¾·ù, ½Ã½ºÅÛ¿¡ ¼³Ä¡µÈ ÀÀ¿ë ÇÁ·Î±×·¥ ¹× °ü¸®ÀÚ°¡ ÇÁ·Î±×·¥ ±¸¼º¿¡ µéÀÎ °ü½ÉÀÇ Á¤µµ¿¡ ´ëÇÑ Á¤º¸¸¦ ¾Ï½ÃÇÒ ¼ö ÀÖ½À´Ï´Ù.

¸ğ¹ÙÀÏ È¯°æ°ú °ü·ÃµÈ ½Ã³ª¸®¿À¸¦ ÇÏ³ª ´õ ¼Ò°³ÇÏ°Ú½À´Ï´Ù. ÇöÀç ´ëºÎºĞÀÇ ¸ğ¹ÙÀÏ ÀåÄ¡´Â ¹«¼± Åë½ÅÀ» »ç¿ëÇÏ´Â ÀåÄ¡ °£¿¡ Á¤º¸¸¦ ºü¸£°Ô ±³È¯ÇÒ ¼ö ÀÖµµ·Ï NFC(±Ù°Å¸® Åë½Å) ÇÁ·ÎÅäÄİÀ» ±¸ÇöÇÕ´Ï´Ù. NFC ÇÁ·ÎÅäÄİÀº ÀåÄ¡¸¦ ±ÙÁ¢ÇÏ°Ô ¶Ç´Â ¼­·Î Á¢ÃËÇÏµµ·Ï ¹èÄ¡ÇÏ´Â ¹æ½ÄÀ¸·Î ÀÛµ¿ÇÕ´Ï´Ù. NFCÀÇ Åë½Å ¹üÀ§´Â ºÒ°ú ¸î ¼¾Æ¼¹ÌÅÍ Á¤µµ·Î Á¦ÇÑµÇÁö¸¸ NFC¸¸ »ç¿ëÇØ¼­´Â º¸¾È Åë½ÅÀÌ º¸ÀåµÇÁö ¾ÊÀ¸¹Ç·Î µµÃ», µ¥ÀÌÅÍ ¼öÁ¤ ¹× ±âÅ¸ ´Ù¾çÇÑ À¯ÇüÀÇ °ø°İÀ» ÇÒ ¼ö ÀÖ½À´Ï´Ù.

¿¹Á¦ 2: Android ÇÃ·§Æû¿¡¼­´Â NFC°¡ Áö¿øµË´Ï´Ù. ´ÙÀ½ ÄÚµå´Â ¹üÀ§ ³»ÀÇ ´Ù¸¥ ÀåÄ¡·Î Çª½ÃµÇ´Â ¸Ş½ÃÁö¸¦ »ı¼ºÇÕ´Ï´Ù.

...
public static final String TAG = "NfcActivity";
private static final String DATA_SPLITTER = "__:DATA:__";
private static final String MIME_TYPE = "application/my.applications.mimetype";
...
public NdefMessage createNdefMessage(NfcEvent event) {
    TelephonyManager tm = (TelephonyManager)Context.getSystemService(Context.TELEPHONY_SERVICE);
    String VERSION = tm.getDeviceSoftwareVersion();
    String text = TAG + DATA_SPLITTER + VERSION;
    NdefRecord record = new NdefRecord(NdefRecord.TNF_MIME_MEDIA,
            MIME_TYPE.getBytes(), new byte[0], text.getBytes());
    NdefRecord[] records = { record };
    NdefMessage msg = new NdefMessage(records);
    return msg;
}
...


NDEF(NFC µ¥ÀÌÅÍ ±³È¯ Çü½Ä) ¸Ş½ÃÁö¿¡´Â Çü½ÄÈ­µÈ µ¥ÀÌÅÍ, URI ¶Ç´Â »ç¿ëÀÚ ÁöÁ¤ ÀÀ¿ë ÇÁ·Î±×·¥ ÆäÀÌ·Îµå°¡ Æ÷ÇÔµË´Ï´Ù. ¸Ş½ÃÁö¿¡ ÀÀ¿ë ÇÁ·Î±×·¥ ÀÌ¸§, MIME À¯Çü ¶Ç´Â ÀåÄ¡ ¼ÒÇÁÆ®¿ş¾î ¹öÀü °°Àº ÀÀ¿ë ÇÁ·Î±×·¥ °ü·Ã Á¤º¸°¡ Æ÷ÇÔµÇ¾î ÀÖÀ¸¸é µµÃ»ÀÚ¿¡°Ô ÇØ´ç Á¤º¸°¡ ³ëÃâµÉ ¼ö ÀÖ½À´Ï´Ù. Example 2¿¡¼­ Fortify Static Code Analyzer´Â return ¹®¿¡¼­ system information leak Ãë¾à¼ºÀ» º¸°íÇÕ´Ï´Ù.,¿À·ù ¸Ş½ÃÁö¸¦ ¾µ ¶§´Â Ç×»ó º¸¾ÈÀ» ¿°µÎ¿¡ µÎ¾î¾ß ÇÕ´Ï´Ù. ¿î¿µ È¯°æ¿¡¼­´Â ÀÚ¼¼ÇÑ ¿À·ù Á¤º¸ ´ë½Å °£´ÜÇÑ ¸Ş½ÃÁö¸¦ »ç¿ëÇÕ´Ï´Ù. °ü¸®ÀÚ¿Í ÇÁ·Î±×·¡¸Ó°¡ ¹®Á¦¸¦ Áø´ÜÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â »ó¼¼ÇÑ Ãâ·ÂÀÇ »ı¼º ¹× ÀúÀåÀº »ï°¡´Â °ÍÀÌ ÁÁ½À´Ï´Ù. µğ¹ö±ë ÃßÀûÀº ¶§¿¡ µû¶ó ¾û¶×ÇÑ °÷¿¡ ³ªÅ¸³¯ ¼ö ÀÖ½À´Ï´Ù(¿¹: ¿À·ù ÆäÀÌÁöÀÇ HTML¿¡¼­ ÁÖ¼®¿¡ Æ÷ÇÔµÊ).

½ºÅÃ ÃßÀûÀÌ³ª µ¥ÀÌÅÍº£ÀÌ½º ´ıÇÁ¸¦ ³ªÅ¸³»Áö ¾Ê´Â °£°áÇÑ ¿À·ù ¸Ş½ÃÁöµµ °ø°İÀÚ¿¡°Ô µµ¿òÀ» Áİ´Ï´Ù. ¿¹¸¦ µé¾î, "Á¢±Ù °ÅºÎ" ¸Ş½ÃÁö´Â ½Ã½ºÅÛ¿¡ ÆÄÀÏÀÌ³ª »ç¿ëÀÚ°¡ Á¸ÀçÇÑ´Ù´Â °ÍÀ» ³ªÅ¸³À´Ï´Ù.

Android ÀåÄ¡¿¡¼­ NFC¸¦ ÅëÇÑ ½Ã½ºÅÛ µ¥ÀÌÅÍ ´©ÃâÀÌ ¿°·ÁµÇ¸é ´ÙÀ½ÀÇ ¼¼ °¡Áö ÀÛ¾÷ Áß ÇÏ³ª¸¦ ¼öÇàÇÏ¸é µË´Ï´Ù. Áï ¹üÀ§ ³»¿¡ ÀÖ´Â ´Ù¸¥ ÀåÄ¡·Î Çª½ÃµÇ´Â ¸Ş½ÃÁö¿¡ ½Ã½ºÅÛ µ¥ÀÌÅÍ¸¦ Æ÷ÇÔÇÏÁö ¾Ê°Å³ª, ¸Ş½ÃÁö ÆäÀÌ·Îµå¸¦ ¾ÏÈ£È­ÇÏ°Å³ª, »óÀ§ °èÃş¿¡ º¸¾È Åë½Å Ã¤³ÎÀ» ¼³Á¤ÇÕ´Ï´Ù.,1. System information leakÀ» ¿¹¹æÇÏ´Â µ¥ ·¡ÆÛ ½ºÅ©¸³Æ®, È¸»ç IT Á¤Ã¥ ¶Ç´Â ºü¸¥ ÆÇ´Ü·ÂÀ» °¡Áø ½Ã½ºÅÛ °ü¸®ÀÚ¿¡¸¸ ÀÇÁ¸ÇÏÁö ¸¶½Ê½Ã¿À. ÀÚÃ¼ÀûÀ¸·Î ¾ÈÀüÇÑ ¼ÒÇÁÆ®¿ş¾î¸¦ ÀÛ¼ºÇØ¾ß ÇÕ´Ï´Ù.

2. ÀÌ Ä«Å×°í¸®ÀÇ Ãë¾àÁ¡Àº ¸ğµç À¯ÇüÀÇ ÇÁ·Î±×·¥¿¡ Àû¿ëµÇÁö ¾Ê½À´Ï´Ù. ¿¹¸¦ µé¾î, ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ °ø°İÀÚ°¡ ÀÌ¹Ì ½Ã½ºÅÛ Á¤º¸¸¦ È®º¸ÇÑ Å¬¶óÀÌ¾ğÆ® ½Ã½ºÅÛ¿¡¼­ ½ÇÇàµÇ°Å³ª ½Ã½ºÅÛ Á¤º¸¸¦ ½Å·ÚÇÒ ¼ö ÀÖ´Â ·Î±× ÆÄÀÏ¿¡¸¸ ÀÎ¼âÇÏ´Â °æ¿ì, Audit Guide¸¦ »ç¿ëÇÏ¿© ½ºÄµ °á°ú¿¡¼­ ÀÌ Ä«Å×°í¸®ÀÇ Ãë¾àÁ¡À» ÇÊÅÍ¸µÇÒ ¼ö ÀÖ½À´Ï´Ù.

3. Fortify AppDefender adds protection against this category.,08BD92B58521B0F455A66A26EE6288E1,FE4EADF2-7055-4C36-863E-5A01C4A0E1A4,,,,2024-02-13,
Low,Low,Encapsulation,System Information Leak,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/MyContextListener.java,MyContextListener.java,,		}
		catch(Exception e){
			e.printStackTrace();
		}
	},printStackTrace(),MyContextListener.javaÀÇ contextInitialized() ÇÔ¼ö´Â 33 ÁÙÀÇ printStackTrace()À»(¸¦) È£ÃâÇÏ¿© ½Ã½ºÅÛ µ¥ÀÌÅÍ ¶Ç´Â µğ¹ö±× Á¤º¸¸¦ ³ëÃâÇÕ´Ï´Ù. printStackTrace()¿¡ ÀÇÇØ ³ëÃâµÈ Á¤º¸´Â °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀ» ÁÙ ¼ö ÀÖ½À´Ï´Ù.,LoginServlet.javaÀÇ doPost() ÇÔ¼ö´Â 54 ÁÙÀÇ printStackTrace()À»(¸¦) È£ÃâÇÏ¿© ½Ã½ºÅÛ µ¥ÀÌÅÍ ¶Ç´Â µğ¹ö±× Á¤º¸¸¦ ³ëÃâÇÕ´Ï´Ù. printStackTrace()¿¡ ÀÇÇØ ³ëÃâµÈ Á¤º¸´Â °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀ» ÁÙ ¼ö ÀÖ½À´Ï´Ù.,Á¤º¸ ´©ÃâÀº ½Ã½ºÅÛ µ¥ÀÌÅÍ ¶Ç´Â µğ¹ö±× Á¤º¸°¡ Ãâ·Â ½ºÆ®¸²ÀÌ³ª ·Î±ë ÇÔ¼ö¸¦ ÅëÇØ ÇÁ·Î±×·¥À» ¹ş¾î³¯ ¶§ ¹ß»ıÇÕ´Ï´Ù.



¿¹Á¦ 1: ´ÙÀ½ ÄÚµå´Â Ç¥ÁØ ¿À·ù ½ºÆ®¸²¿¡ ¿¹¿Ü »çÇ×À» ÀÛ¼ºÇÕ´Ï´Ù.


try {
    ...
} catch (Exception e) {
    e.printStackTrace();
}


½Ã½ºÅÛ ±¸¼º¿¡ µû¶ó ÀÌ Á¤º¸´Â ÄÜ¼Ö¿¡ ´ıÇÁµÇ°Å³ª ·Î±× ÆÄÀÏ¿¡ ÀÛ¼ºµÇ°Å³ª ¿ø°İ »ç¿ëÀÚ¿¡°Ô ³ëÃâµÉ ¼ö ÀÖ½À´Ï´Ù. ¿¹¸¦ µé¾î, ½ºÅ©¸³ÆÃ ¸ŞÄ¿´ÏÁòÀ» »ç¿ëÇÏ¸é "Ç¥ÁØ ¿À·ù" ¶Ç´Â "Ç¥ÁØ Ãâ·Â"¿¡¼­ ÆÄÀÏÀÌ³ª ´Ù¸¥ ÇÁ·Î±×·¥À¸·Î Ãâ·Â Á¤º¸¸¦ °£´ÜÇÏ°Ô ¸®µğ·º¼ÇÇÒ ¼ö ÀÖ½À´Ï´Ù. ¶Ç´Â ÇÁ·Î±×·¥ÀÌ ½ÇÇàµÇ´Â ½Ã½ºÅÛ¿¡´Â ·Î±×¸¦ ¿ø°İ ÀåÄ¡·Î Àü¼ÛÇÏ´Â "syslog" ¼­¹ö¿Í °°Àº ¿ø°İ ·Î±ë ¸ŞÄ¿´ÏÁòÀÌ ÀÖÀ» ¼ö ÀÖ½À´Ï´Ù. °³¹ß ´Ü°è¿¡¼­´Â ÀÌ Á¤º¸°¡ ¾îµğ¿¡ Ç¥½ÃµÉÁö ¾Ë ¹æ¹ıÀÌ ¾ø½À´Ï´Ù.

°æ¿ì¿¡ µû¶ó ¿À·ù ¸Ş½ÃÁö°¡ °ø°İÀÚ¿¡°Ô ½Ã½ºÅÛÀÌ Ãë¾àÇÑ Á¤È®ÇÑ °ø°İ À¯ÇüÀ» ¾Ë·ÁÁÖ±âµµ ÇÕ´Ï´Ù. ¿¹¸¦ µé¾î, µ¥ÀÌÅÍº£ÀÌ½º ¿À·ù ¸Ş½ÃÁö°¡ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ SQL injection °ø°İ¿¡ Ãë¾àÇÏ´Ù´Â °ÍÀ» µå·¯³¾ ¼ö ÀÖ½À´Ï´Ù. ´Ù¸¥ ¿À·ù ¸Ş½ÃÁöµµ ºñ±³Àû ¸ğÈ£ÇÏÁö¸¸ ½Ã½ºÅÛ¿¡ ´ëÇÑ ´Ü¼­¸¦ Á¦°øÇÕ´Ï´Ù. Example 1¿¡¼­´Â ´©ÃâµÈ Á¤º¸°¡ ¿î¿µ Ã¼Á¦ÀÇ Á¾·ù, ½Ã½ºÅÛ¿¡ ¼³Ä¡µÈ ÀÀ¿ë ÇÁ·Î±×·¥ ¹× °ü¸®ÀÚ°¡ ÇÁ·Î±×·¥ ±¸¼º¿¡ µéÀÎ °ü½ÉÀÇ Á¤µµ¿¡ ´ëÇÑ Á¤º¸¸¦ ¾Ï½ÃÇÒ ¼ö ÀÖ½À´Ï´Ù.

¸ğ¹ÙÀÏ È¯°æ°ú °ü·ÃµÈ ½Ã³ª¸®¿À¸¦ ÇÏ³ª ´õ ¼Ò°³ÇÏ°Ú½À´Ï´Ù. ÇöÀç ´ëºÎºĞÀÇ ¸ğ¹ÙÀÏ ÀåÄ¡´Â ¹«¼± Åë½ÅÀ» »ç¿ëÇÏ´Â ÀåÄ¡ °£¿¡ Á¤º¸¸¦ ºü¸£°Ô ±³È¯ÇÒ ¼ö ÀÖµµ·Ï NFC(±Ù°Å¸® Åë½Å) ÇÁ·ÎÅäÄİÀ» ±¸ÇöÇÕ´Ï´Ù. NFC ÇÁ·ÎÅäÄİÀº ÀåÄ¡¸¦ ±ÙÁ¢ÇÏ°Ô ¶Ç´Â ¼­·Î Á¢ÃËÇÏµµ·Ï ¹èÄ¡ÇÏ´Â ¹æ½ÄÀ¸·Î ÀÛµ¿ÇÕ´Ï´Ù. NFCÀÇ Åë½Å ¹üÀ§´Â ºÒ°ú ¸î ¼¾Æ¼¹ÌÅÍ Á¤µµ·Î Á¦ÇÑµÇÁö¸¸ NFC¸¸ »ç¿ëÇØ¼­´Â º¸¾È Åë½ÅÀÌ º¸ÀåµÇÁö ¾ÊÀ¸¹Ç·Î µµÃ», µ¥ÀÌÅÍ ¼öÁ¤ ¹× ±âÅ¸ ´Ù¾çÇÑ À¯ÇüÀÇ °ø°İÀ» ÇÒ ¼ö ÀÖ½À´Ï´Ù.

¿¹Á¦ 2: Android ÇÃ·§Æû¿¡¼­´Â NFC°¡ Áö¿øµË´Ï´Ù. ´ÙÀ½ ÄÚµå´Â ¹üÀ§ ³»ÀÇ ´Ù¸¥ ÀåÄ¡·Î Çª½ÃµÇ´Â ¸Ş½ÃÁö¸¦ »ı¼ºÇÕ´Ï´Ù.

...
public static final String TAG = "NfcActivity";
private static final String DATA_SPLITTER = "__:DATA:__";
private static final String MIME_TYPE = "application/my.applications.mimetype";
...
public NdefMessage createNdefMessage(NfcEvent event) {
    TelephonyManager tm = (TelephonyManager)Context.getSystemService(Context.TELEPHONY_SERVICE);
    String VERSION = tm.getDeviceSoftwareVersion();
    String text = TAG + DATA_SPLITTER + VERSION;
    NdefRecord record = new NdefRecord(NdefRecord.TNF_MIME_MEDIA,
            MIME_TYPE.getBytes(), new byte[0], text.getBytes());
    NdefRecord[] records = { record };
    NdefMessage msg = new NdefMessage(records);
    return msg;
}
...


NDEF(NFC µ¥ÀÌÅÍ ±³È¯ Çü½Ä) ¸Ş½ÃÁö¿¡´Â Çü½ÄÈ­µÈ µ¥ÀÌÅÍ, URI ¶Ç´Â »ç¿ëÀÚ ÁöÁ¤ ÀÀ¿ë ÇÁ·Î±×·¥ ÆäÀÌ·Îµå°¡ Æ÷ÇÔµË´Ï´Ù. ¸Ş½ÃÁö¿¡ ÀÀ¿ë ÇÁ·Î±×·¥ ÀÌ¸§, MIME À¯Çü ¶Ç´Â ÀåÄ¡ ¼ÒÇÁÆ®¿ş¾î ¹öÀü °°Àº ÀÀ¿ë ÇÁ·Î±×·¥ °ü·Ã Á¤º¸°¡ Æ÷ÇÔµÇ¾î ÀÖÀ¸¸é µµÃ»ÀÚ¿¡°Ô ÇØ´ç Á¤º¸°¡ ³ëÃâµÉ ¼ö ÀÖ½À´Ï´Ù. Example 2¿¡¼­ Fortify Static Code Analyzer´Â return ¹®¿¡¼­ system information leak Ãë¾à¼ºÀ» º¸°íÇÕ´Ï´Ù.,¿À·ù ¸Ş½ÃÁö¸¦ ¾µ ¶§´Â Ç×»ó º¸¾ÈÀ» ¿°µÎ¿¡ µÎ¾î¾ß ÇÕ´Ï´Ù. ¿î¿µ È¯°æ¿¡¼­´Â ÀÚ¼¼ÇÑ ¿À·ù Á¤º¸ ´ë½Å °£´ÜÇÑ ¸Ş½ÃÁö¸¦ »ç¿ëÇÕ´Ï´Ù. °ü¸®ÀÚ¿Í ÇÁ·Î±×·¡¸Ó°¡ ¹®Á¦¸¦ Áø´ÜÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â »ó¼¼ÇÑ Ãâ·ÂÀÇ »ı¼º ¹× ÀúÀåÀº »ï°¡´Â °ÍÀÌ ÁÁ½À´Ï´Ù. µğ¹ö±ë ÃßÀûÀº ¶§¿¡ µû¶ó ¾û¶×ÇÑ °÷¿¡ ³ªÅ¸³¯ ¼ö ÀÖ½À´Ï´Ù(¿¹: ¿À·ù ÆäÀÌÁöÀÇ HTML¿¡¼­ ÁÖ¼®¿¡ Æ÷ÇÔµÊ).

½ºÅÃ ÃßÀûÀÌ³ª µ¥ÀÌÅÍº£ÀÌ½º ´ıÇÁ¸¦ ³ªÅ¸³»Áö ¾Ê´Â °£°áÇÑ ¿À·ù ¸Ş½ÃÁöµµ °ø°İÀÚ¿¡°Ô µµ¿òÀ» Áİ´Ï´Ù. ¿¹¸¦ µé¾î, "Á¢±Ù °ÅºÎ" ¸Ş½ÃÁö´Â ½Ã½ºÅÛ¿¡ ÆÄÀÏÀÌ³ª »ç¿ëÀÚ°¡ Á¸ÀçÇÑ´Ù´Â °ÍÀ» ³ªÅ¸³À´Ï´Ù.

Android ÀåÄ¡¿¡¼­ NFC¸¦ ÅëÇÑ ½Ã½ºÅÛ µ¥ÀÌÅÍ ´©ÃâÀÌ ¿°·ÁµÇ¸é ´ÙÀ½ÀÇ ¼¼ °¡Áö ÀÛ¾÷ Áß ÇÏ³ª¸¦ ¼öÇàÇÏ¸é µË´Ï´Ù. Áï ¹üÀ§ ³»¿¡ ÀÖ´Â ´Ù¸¥ ÀåÄ¡·Î Çª½ÃµÇ´Â ¸Ş½ÃÁö¿¡ ½Ã½ºÅÛ µ¥ÀÌÅÍ¸¦ Æ÷ÇÔÇÏÁö ¾Ê°Å³ª, ¸Ş½ÃÁö ÆäÀÌ·Îµå¸¦ ¾ÏÈ£È­ÇÏ°Å³ª, »óÀ§ °èÃş¿¡ º¸¾È Åë½Å Ã¤³ÎÀ» ¼³Á¤ÇÕ´Ï´Ù.,1. System information leakÀ» ¿¹¹æÇÏ´Â µ¥ ·¡ÆÛ ½ºÅ©¸³Æ®, È¸»ç IT Á¤Ã¥ ¶Ç´Â ºü¸¥ ÆÇ´Ü·ÂÀ» °¡Áø ½Ã½ºÅÛ °ü¸®ÀÚ¿¡¸¸ ÀÇÁ¸ÇÏÁö ¸¶½Ê½Ã¿À. ÀÚÃ¼ÀûÀ¸·Î ¾ÈÀüÇÑ ¼ÒÇÁÆ®¿ş¾î¸¦ ÀÛ¼ºÇØ¾ß ÇÕ´Ï´Ù.

2. ÀÌ Ä«Å×°í¸®ÀÇ Ãë¾àÁ¡Àº ¸ğµç À¯ÇüÀÇ ÇÁ·Î±×·¥¿¡ Àû¿ëµÇÁö ¾Ê½À´Ï´Ù. ¿¹¸¦ µé¾î, ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ °ø°İÀÚ°¡ ÀÌ¹Ì ½Ã½ºÅÛ Á¤º¸¸¦ È®º¸ÇÑ Å¬¶óÀÌ¾ğÆ® ½Ã½ºÅÛ¿¡¼­ ½ÇÇàµÇ°Å³ª ½Ã½ºÅÛ Á¤º¸¸¦ ½Å·ÚÇÒ ¼ö ÀÖ´Â ·Î±× ÆÄÀÏ¿¡¸¸ ÀÎ¼âÇÏ´Â °æ¿ì, Audit Guide¸¦ »ç¿ëÇÏ¿© ½ºÄµ °á°ú¿¡¼­ ÀÌ Ä«Å×°í¸®ÀÇ Ãë¾àÁ¡À» ÇÊÅÍ¸µÇÒ ¼ö ÀÖ½À´Ï´Ù.

3. Fortify AppDefender adds protection against this category.,0DD8B02E4BFE39436C2920BB34F94924,FE4EADF2-7055-4C36-863E-5A01C4A0E1A4,,,,2024-02-13,
Low,Low,Encapsulation,System Information Leak,src/adrui/registerServlet.java,registerServlet.java,,		//doGet(request, response);
		String sno = request.getParameter("Sno");
		String user = request.getParameter("LoginUser");
		String pass = request.getParameter("LoginPass");
		Connection conn = (Connection)(getServletContext().getAttribute("conn"));,javax.servlet.ServletRequest.getParameter(),src/adrui/registerServlet.java,registerServlet.java,,		}
		catch(Exception e){
			e.printStackTrace();
		}
	},printStackTrace(),registerServlet.javaÀÇ doPost() ÇÔ¼ö´Â 72 ÁÙÀÇ printStackTrace()À»(¸¦) È£ÃâÇÏ¿© ½Ã½ºÅÛ µ¥ÀÌÅÍ ¶Ç´Â µğ¹ö±× Á¤º¸¸¦ ³ëÃâÇÕ´Ï´Ù. printStackTrace()¿¡ ÀÇÇØ ³ëÃâµÈ Á¤º¸´Â °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀ» ÁÙ ¼ö ÀÖ½À´Ï´Ù.,LoginServlet.javaÀÇ doPost() ÇÔ¼ö´Â 54 ÁÙÀÇ printStackTrace()À»(¸¦) È£ÃâÇÏ¿© ½Ã½ºÅÛ µ¥ÀÌÅÍ ¶Ç´Â µğ¹ö±× Á¤º¸¸¦ ³ëÃâÇÕ´Ï´Ù. printStackTrace()¿¡ ÀÇÇØ ³ëÃâµÈ Á¤º¸´Â °ø°İÀÚ°¡ °ø°İÀ» °èÈ¹ÇÏ´Â µ¥ µµ¿òÀ» ÁÙ ¼ö ÀÖ½À´Ï´Ù.,Á¤º¸ ´©ÃâÀº ½Ã½ºÅÛ µ¥ÀÌÅÍ ¶Ç´Â µğ¹ö±× Á¤º¸°¡ Ãâ·Â ½ºÆ®¸²ÀÌ³ª ·Î±ë ÇÔ¼ö¸¦ ÅëÇØ ÇÁ·Î±×·¥À» ¹ş¾î³¯ ¶§ ¹ß»ıÇÕ´Ï´Ù.



¿¹Á¦ 1: ´ÙÀ½ ÄÚµå´Â Ç¥ÁØ ¿À·ù ½ºÆ®¸²¿¡ ¿¹¿Ü »çÇ×À» ÀÛ¼ºÇÕ´Ï´Ù.


try {
    ...
} catch (Exception e) {
    e.printStackTrace();
}


½Ã½ºÅÛ ±¸¼º¿¡ µû¶ó ÀÌ Á¤º¸´Â ÄÜ¼Ö¿¡ ´ıÇÁµÇ°Å³ª ·Î±× ÆÄÀÏ¿¡ ÀÛ¼ºµÇ°Å³ª ¿ø°İ »ç¿ëÀÚ¿¡°Ô ³ëÃâµÉ ¼ö ÀÖ½À´Ï´Ù. ¿¹¸¦ µé¾î, ½ºÅ©¸³ÆÃ ¸ŞÄ¿´ÏÁòÀ» »ç¿ëÇÏ¸é "Ç¥ÁØ ¿À·ù" ¶Ç´Â "Ç¥ÁØ Ãâ·Â"¿¡¼­ ÆÄÀÏÀÌ³ª ´Ù¸¥ ÇÁ·Î±×·¥À¸·Î Ãâ·Â Á¤º¸¸¦ °£´ÜÇÏ°Ô ¸®µğ·º¼ÇÇÒ ¼ö ÀÖ½À´Ï´Ù. ¶Ç´Â ÇÁ·Î±×·¥ÀÌ ½ÇÇàµÇ´Â ½Ã½ºÅÛ¿¡´Â ·Î±×¸¦ ¿ø°İ ÀåÄ¡·Î Àü¼ÛÇÏ´Â "syslog" ¼­¹ö¿Í °°Àº ¿ø°İ ·Î±ë ¸ŞÄ¿´ÏÁòÀÌ ÀÖÀ» ¼ö ÀÖ½À´Ï´Ù. °³¹ß ´Ü°è¿¡¼­´Â ÀÌ Á¤º¸°¡ ¾îµğ¿¡ Ç¥½ÃµÉÁö ¾Ë ¹æ¹ıÀÌ ¾ø½À´Ï´Ù.

°æ¿ì¿¡ µû¶ó ¿À·ù ¸Ş½ÃÁö°¡ °ø°İÀÚ¿¡°Ô ½Ã½ºÅÛÀÌ Ãë¾àÇÑ Á¤È®ÇÑ °ø°İ À¯ÇüÀ» ¾Ë·ÁÁÖ±âµµ ÇÕ´Ï´Ù. ¿¹¸¦ µé¾î, µ¥ÀÌÅÍº£ÀÌ½º ¿À·ù ¸Ş½ÃÁö°¡ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ SQL injection °ø°İ¿¡ Ãë¾àÇÏ´Ù´Â °ÍÀ» µå·¯³¾ ¼ö ÀÖ½À´Ï´Ù. ´Ù¸¥ ¿À·ù ¸Ş½ÃÁöµµ ºñ±³Àû ¸ğÈ£ÇÏÁö¸¸ ½Ã½ºÅÛ¿¡ ´ëÇÑ ´Ü¼­¸¦ Á¦°øÇÕ´Ï´Ù. Example 1¿¡¼­´Â ´©ÃâµÈ Á¤º¸°¡ ¿î¿µ Ã¼Á¦ÀÇ Á¾·ù, ½Ã½ºÅÛ¿¡ ¼³Ä¡µÈ ÀÀ¿ë ÇÁ·Î±×·¥ ¹× °ü¸®ÀÚ°¡ ÇÁ·Î±×·¥ ±¸¼º¿¡ µéÀÎ °ü½ÉÀÇ Á¤µµ¿¡ ´ëÇÑ Á¤º¸¸¦ ¾Ï½ÃÇÒ ¼ö ÀÖ½À´Ï´Ù.

¸ğ¹ÙÀÏ È¯°æ°ú °ü·ÃµÈ ½Ã³ª¸®¿À¸¦ ÇÏ³ª ´õ ¼Ò°³ÇÏ°Ú½À´Ï´Ù. ÇöÀç ´ëºÎºĞÀÇ ¸ğ¹ÙÀÏ ÀåÄ¡´Â ¹«¼± Åë½ÅÀ» »ç¿ëÇÏ´Â ÀåÄ¡ °£¿¡ Á¤º¸¸¦ ºü¸£°Ô ±³È¯ÇÒ ¼ö ÀÖµµ·Ï NFC(±Ù°Å¸® Åë½Å) ÇÁ·ÎÅäÄİÀ» ±¸ÇöÇÕ´Ï´Ù. NFC ÇÁ·ÎÅäÄİÀº ÀåÄ¡¸¦ ±ÙÁ¢ÇÏ°Ô ¶Ç´Â ¼­·Î Á¢ÃËÇÏµµ·Ï ¹èÄ¡ÇÏ´Â ¹æ½ÄÀ¸·Î ÀÛµ¿ÇÕ´Ï´Ù. NFCÀÇ Åë½Å ¹üÀ§´Â ºÒ°ú ¸î ¼¾Æ¼¹ÌÅÍ Á¤µµ·Î Á¦ÇÑµÇÁö¸¸ NFC¸¸ »ç¿ëÇØ¼­´Â º¸¾È Åë½ÅÀÌ º¸ÀåµÇÁö ¾ÊÀ¸¹Ç·Î µµÃ», µ¥ÀÌÅÍ ¼öÁ¤ ¹× ±âÅ¸ ´Ù¾çÇÑ À¯ÇüÀÇ °ø°İÀ» ÇÒ ¼ö ÀÖ½À´Ï´Ù.

¿¹Á¦ 2: Android ÇÃ·§Æû¿¡¼­´Â NFC°¡ Áö¿øµË´Ï´Ù. ´ÙÀ½ ÄÚµå´Â ¹üÀ§ ³»ÀÇ ´Ù¸¥ ÀåÄ¡·Î Çª½ÃµÇ´Â ¸Ş½ÃÁö¸¦ »ı¼ºÇÕ´Ï´Ù.

...
public static final String TAG = "NfcActivity";
private static final String DATA_SPLITTER = "__:DATA:__";
private static final String MIME_TYPE = "application/my.applications.mimetype";
...
public NdefMessage createNdefMessage(NfcEvent event) {
    TelephonyManager tm = (TelephonyManager)Context.getSystemService(Context.TELEPHONY_SERVICE);
    String VERSION = tm.getDeviceSoftwareVersion();
    String text = TAG + DATA_SPLITTER + VERSION;
    NdefRecord record = new NdefRecord(NdefRecord.TNF_MIME_MEDIA,
            MIME_TYPE.getBytes(), new byte[0], text.getBytes());
    NdefRecord[] records = { record };
    NdefMessage msg = new NdefMessage(records);
    return msg;
}
...


NDEF(NFC µ¥ÀÌÅÍ ±³È¯ Çü½Ä) ¸Ş½ÃÁö¿¡´Â Çü½ÄÈ­µÈ µ¥ÀÌÅÍ, URI ¶Ç´Â »ç¿ëÀÚ ÁöÁ¤ ÀÀ¿ë ÇÁ·Î±×·¥ ÆäÀÌ·Îµå°¡ Æ÷ÇÔµË´Ï´Ù. ¸Ş½ÃÁö¿¡ ÀÀ¿ë ÇÁ·Î±×·¥ ÀÌ¸§, MIME À¯Çü ¶Ç´Â ÀåÄ¡ ¼ÒÇÁÆ®¿ş¾î ¹öÀü °°Àº ÀÀ¿ë ÇÁ·Î±×·¥ °ü·Ã Á¤º¸°¡ Æ÷ÇÔµÇ¾î ÀÖÀ¸¸é µµÃ»ÀÚ¿¡°Ô ÇØ´ç Á¤º¸°¡ ³ëÃâµÉ ¼ö ÀÖ½À´Ï´Ù. Example 2¿¡¼­ Fortify Static Code Analyzer´Â return ¹®¿¡¼­ system information leak Ãë¾à¼ºÀ» º¸°íÇÕ´Ï´Ù.,¿À·ù ¸Ş½ÃÁö¸¦ ¾µ ¶§´Â Ç×»ó º¸¾ÈÀ» ¿°µÎ¿¡ µÎ¾î¾ß ÇÕ´Ï´Ù. ¿î¿µ È¯°æ¿¡¼­´Â ÀÚ¼¼ÇÑ ¿À·ù Á¤º¸ ´ë½Å °£´ÜÇÑ ¸Ş½ÃÁö¸¦ »ç¿ëÇÕ´Ï´Ù. °ü¸®ÀÚ¿Í ÇÁ·Î±×·¡¸Ó°¡ ¹®Á¦¸¦ Áø´ÜÇÏ´Â µ¥ µµ¿òÀÌ µÇ´Â »ó¼¼ÇÑ Ãâ·ÂÀÇ »ı¼º ¹× ÀúÀåÀº »ï°¡´Â °ÍÀÌ ÁÁ½À´Ï´Ù. µğ¹ö±ë ÃßÀûÀº ¶§¿¡ µû¶ó ¾û¶×ÇÑ °÷¿¡ ³ªÅ¸³¯ ¼ö ÀÖ½À´Ï´Ù(¿¹: ¿À·ù ÆäÀÌÁöÀÇ HTML¿¡¼­ ÁÖ¼®¿¡ Æ÷ÇÔµÊ).

½ºÅÃ ÃßÀûÀÌ³ª µ¥ÀÌÅÍº£ÀÌ½º ´ıÇÁ¸¦ ³ªÅ¸³»Áö ¾Ê´Â °£°áÇÑ ¿À·ù ¸Ş½ÃÁöµµ °ø°İÀÚ¿¡°Ô µµ¿òÀ» Áİ´Ï´Ù. ¿¹¸¦ µé¾î, "Á¢±Ù °ÅºÎ" ¸Ş½ÃÁö´Â ½Ã½ºÅÛ¿¡ ÆÄÀÏÀÌ³ª »ç¿ëÀÚ°¡ Á¸ÀçÇÑ´Ù´Â °ÍÀ» ³ªÅ¸³À´Ï´Ù.

Android ÀåÄ¡¿¡¼­ NFC¸¦ ÅëÇÑ ½Ã½ºÅÛ µ¥ÀÌÅÍ ´©ÃâÀÌ ¿°·ÁµÇ¸é ´ÙÀ½ÀÇ ¼¼ °¡Áö ÀÛ¾÷ Áß ÇÏ³ª¸¦ ¼öÇàÇÏ¸é µË´Ï´Ù. Áï ¹üÀ§ ³»¿¡ ÀÖ´Â ´Ù¸¥ ÀåÄ¡·Î Çª½ÃµÇ´Â ¸Ş½ÃÁö¿¡ ½Ã½ºÅÛ µ¥ÀÌÅÍ¸¦ Æ÷ÇÔÇÏÁö ¾Ê°Å³ª, ¸Ş½ÃÁö ÆäÀÌ·Îµå¸¦ ¾ÏÈ£È­ÇÏ°Å³ª, »óÀ§ °èÃş¿¡ º¸¾È Åë½Å Ã¤³ÎÀ» ¼³Á¤ÇÕ´Ï´Ù.,1. System information leakÀ» ¿¹¹æÇÏ´Â µ¥ ·¡ÆÛ ½ºÅ©¸³Æ®, È¸»ç IT Á¤Ã¥ ¶Ç´Â ºü¸¥ ÆÇ´Ü·ÂÀ» °¡Áø ½Ã½ºÅÛ °ü¸®ÀÚ¿¡¸¸ ÀÇÁ¸ÇÏÁö ¸¶½Ê½Ã¿À. ÀÚÃ¼ÀûÀ¸·Î ¾ÈÀüÇÑ ¼ÒÇÁÆ®¿ş¾î¸¦ ÀÛ¼ºÇØ¾ß ÇÕ´Ï´Ù.

2. ÀÌ Ä«Å×°í¸®ÀÇ Ãë¾àÁ¡Àº ¸ğµç À¯ÇüÀÇ ÇÁ·Î±×·¥¿¡ Àû¿ëµÇÁö ¾Ê½À´Ï´Ù. ¿¹¸¦ µé¾î, ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ °ø°İÀÚ°¡ ÀÌ¹Ì ½Ã½ºÅÛ Á¤º¸¸¦ È®º¸ÇÑ Å¬¶óÀÌ¾ğÆ® ½Ã½ºÅÛ¿¡¼­ ½ÇÇàµÇ°Å³ª ½Ã½ºÅÛ Á¤º¸¸¦ ½Å·ÚÇÒ ¼ö ÀÖ´Â ·Î±× ÆÄÀÏ¿¡¸¸ ÀÎ¼âÇÏ´Â °æ¿ì, Audit Guide¸¦ »ç¿ëÇÏ¿© ½ºÄµ °á°ú¿¡¼­ ÀÌ Ä«Å×°í¸®ÀÇ Ãë¾àÁ¡À» ÇÊÅÍ¸µÇÒ ¼ö ÀÖ½À´Ï´Ù.

3. Fortify AppDefender adds protection against this category.,53EE9CDA46A819785E847488896323C2,FE4EADF2-7055-4C36-863E-5A01C4A0E1A4,,,,2024-02-13,
Critical,Critical,Input Validation and Representation,Cross-Site Scripting: Persistent,src/adrui/LoginModel.java,LoginModel.java,,	public String check(Connection conn, String user, String pass) throws SQLException{
		state = conn.createStatement();
		rs = state.executeQuery(sql);
		while(rs.next()){
			if(rs.getString(2).equals(user)){,java.sql.Statement.executeQuery(),login.jsp,login.jsp,,			
	%>
	<p>Hello, <%= ((String)request.getAttribute("res")).substring(1) %></p>
	<% }else{
		%>,javax.servlet.jsp.JspWriter.print(),login.jspÀÇ _jspService() ¸Ş¼­µå°¡ 19 ÁÙÀÇ È®ÀÎµÇÁö ¾ÊÀº µ¥ÀÌÅÍ¸¦ À¥ ºê¶ó¿ìÀú¿¡ º¸³»¸é ºê¶ó¿ìÀú¿¡¼­ ¾Ç¼º ÄÚµå¸¦ ½ÇÇàÇÏ´Â °á°ú¸¦ ÃÊ·¡ÇÒ ¼ö ÀÖ½À´Ï´Ù.,login.jspÀÇ _jspService() ¸Ş¼­µå°¡ 19 ÁÙÀÇ È®ÀÎµÇÁö ¾ÊÀº µ¥ÀÌÅÍ¸¦ À¥ ºê¶ó¿ìÀú¿¡ º¸³»¸é ºê¶ó¿ìÀú¿¡¼­ ¾Ç¼º ÄÚµå¸¦ ½ÇÇàÇÏ´Â °á°ú¸¦ ÃÊ·¡ÇÒ ¼ö ÀÖ½À´Ï´Ù.,XSS(Cross-site scripting) Ãë¾àÁ¡Àº ´ÙÀ½ °æ¿ì¿¡ ¹ß»ıÇÕ´Ï´Ù.

1. ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º¸¦ ÅëÇØ µ¥ÀÌÅÍ°¡ À¥ ÀÀ¿ë ÇÁ·Î±×·¥¿¡ ÀÔ·ÂµË´Ï´Ù. Persistent(Stored ¶ó°íµµ ÇÔ) XSSÀÇ °æ¿ì ½Å·ÚÇÒ ¼ö ¾ø´Â ¼Ò½º´Â ÀÏ¹İÀûÀ¸·Î µ¥ÀÌÅÍº£ÀÌ½º ¶Ç´Â ´Ù¸¥ ¹é¿£µå µ¥ÀÌÅÍ ÀúÀå¼ÒÀÌÁö¸¸, Reflected XSSÀÇ °æ¿ì¿¡´Â ÀÏ¹İÀûÀ¸·Î À¥ ¿äÃ»ÀÔ´Ï´Ù.


2. µ¥ÀÌÅÍ´Â °ËÁõ ¾øÀÌ À¥ »ç¿ëÀÚ¿¡°Ô Àü´ŞµÈ µ¿Àû ÄÜÅÙÆ®¿¡ Æ÷ÇÔµË´Ï´Ù.

À¥ ºê¶ó¿ìÀú¿¡ Àü´ŞµÇ´Â ¾Ç¼º ÄÜÅÙÆ®´Â ÈçÈ÷ JavaScript ¼¼±×¸ÕÆ®ÀÇ ÇüÅÂ¸¦ ÃëÇÏÁö¸¸ HTML, Flash ¶Ç´Â ±âÅ¸ ºê¶ó¿ìÀú°¡ ½ÇÇàÇÏ´Â ´Ù¸¥ ¸ğµç À¯ÇüÀÇ ÄÚµå¸¦ Æ÷ÇÔÇÒ ¼öµµ ÀÖ½À´Ï´Ù. XSS ±â¹İÀÇ °ø°İÀº °ÅÀÇ ¹«Á¦ÇÑÀ¸·Î ´Ù¾çÇÏÁö¸¸, ÈçÈ÷ ÄíÅ° ¶Ç´Â ±âÅ¸ ¼¼¼Ç Á¤º¸¿Í °°Àº °³ÀÎ µ¥ÀÌÅÍ¸¦ °ø°İÀÚ¿¡°Ô Àü¼ÛÇÏ¿© ÇÇÇØÀÚ¸¦ °ø°İÀÚ°¡ Á¦¾îÇÏ´Â À¥ ÄÜÅÙÆ®¿¡ ¸®µğ·º¼ÇÇÏ°Å³ª ÇÇÇØ »çÀÌÆ®·Î À§ÀåÇÏ°í »ç¿ëÀÚ ÄÄÇ»ÅÍ¿¡ ±âÅ¸ ¾ÇÀÇÀûÀÎ ÀÛ¾÷À» ¼öÇàÇÏ´Â °ÍÀÌ °øÅëÀûÀÎ ¼ö¹ıÀÔ´Ï´Ù.


¿¹Á¦ 1: ´ÙÀ½ JSP ÄÚµå ¼¼±×¸ÕÆ®´Â ÁöÁ¤µÈ Á÷¿ø IDÀÇ Á÷¿ø¿¡ ´ëÇÑ µ¥ÀÌÅÍº£ÀÌ½º¸¦ Äõ¸®ÇÏ¿© ÇØ´ç Á÷¿øÀÇ ÀÌ¸§À» ÀÎ¼âÇÕ´Ï´Ù.


<%...
Statement stmt = conn.createStatement();
ResultSet rs = stmt.executeQuery("select * from emp where id="+eid);
if (rs != null) {
   rs.next();
   String name = rs.getString("name");
}
%>

Employee Name: <%= name %>



ÀÌ ÄÚµå´Â nameÀÇ °ªÀÌ ¿Ã¹Ù·Î µ¿ÀÛÇÒ ¶§´Â Á¤È®ÇÏ°Ô ±â´ÉÀ» ÇÏÁö¸¸ ±×·¸Áö ¾ÊÀ» ¶§´Â ÀÍ½ºÇÃ·ÎÀÌÆ®¸¦ ¹æÁöÇÏ±â À§ÇÑ ¾Æ¹« Á¶Ä¡µµ ÃëÇÏÁö ¾Ê½À´Ï´Ù. ÀÌ ÄÚµå´Â nameÀÇ °ªÀ» ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ÄÜÅÙÆ®¸¦ ºĞ¸íÇÏ°Ô °ü¸®ÇÏ´Â µ¥ÀÌÅÍº£ÀÌ½º¿¡¼­ ÀĞ±â ¶§¹®¿¡ À§ÇèÇÏÁö ¾ÊÀº °ÍÀ¸·Î º¸ÀÏ ¼ö ÀÖ½À´Ï´Ù. ÇÏÁö¸¸ nameÀÇ °ªÀÌ »ç¿ëÀÚ°¡ Á¦°øÇÏ´Â µ¥ÀÌÅÍ¿¡¼­ ¿À´Â °æ¿ì µ¥ÀÌÅÍº£ÀÌ½º´Â ¾Ç¼º ÄÜÅÙÆ®ÀÇ Åë·Î°¡ µÉ ¼ö ÀÖ½À´Ï´Ù. µ¥ÀÌÅÍº£ÀÌ½º¿¡ ÀúÀåµÈ ¸ğµç µ¥ÀÌÅÍ¿¡ ´ëÇÑ ÀûÀıÇÑ ÀÔ·Â°ª °ËÁõ ÀıÂ÷°¡ ¾øÀ¸¸é °ø°İÀÚ´Â »ç¿ëÀÚÀÇ À¥ ºê¶ó¿ìÀú¿¡¼­ ¾ÇÀÇÀûÀÎ ¸í·ÉÀ» ½ÇÇàÇÒ ¼ö ÀÖ½À´Ï´Ù. ÀÌ·± À¯ÇüÀÇ ÀÍ½ºÇÃ·ÎÀÌÆ®¸¦ Persistent(¶Ç´Â Stored) XSS¶ó°í ÇÏ´Âµ¥ µ¥ÀÌÅÍ ÀúÀå¼Ò°¡ »ç¿ëÇÏ´Â °£Á¢ ÂüÁ¶ ¶§¹®¿¡ À§ÇùÀ» ½Äº°ÇÏ±â ¾î·Æ°í °ø°İÀÌ ¿©·¯ »ç¿ëÀÚ¿¡°Ô °¡ÇØÁú °¡´É¼ºÀÌ Ä¿Áö±â ¶§¹®¿¡ ´õ¿í À§ÇèÇÕ´Ï´Ù. XSS´Â ¹æ¹®ÀÚ¿¡°Ô "¹æ¸í·Ï"À» Á¦°øÇÏ´Â À¥ »çÀÌÆ®¿¡¼­ ÀÌ·± ÇüÅÂ·Î ½ÃÀÛµÇ¾ú½À´Ï´Ù. °ø°İÀÚ°¡ ¹æ¸í·Ï Ç×¸ñ¿¡ JavaScript¸¦ »ğÀÔÇÏ¸é ÀÌÈÄ¿¡ ¹æ¸í·Ï ÆäÀÌÁö¸¦ ¹æ¹®ÇÏ´Â ¹æ¹®ÀÚ´Â ¸ğµÎ ¾Ç¼º ÄÚµå¸¦ ½ÇÇàÇÏ°Ô µË´Ï´Ù.


¿¹Á¦ 2: ´ÙÀ½ JSP ÄÚµå ¼¼±×¸ÕÆ®´Â HTTP ¿äÃ»¿¡¼­ Á÷¿ø IDÀÎ eid¸¦ ÀĞ¾î »ç¿ëÀÚ¿¡°Ô Ç¥½ÃÇÕ´Ï´Ù.


<% String eid = request.getParameter("eid"); %>
...
Employee ID: <%= eid %>



Example 1¿¡¼­Ã³·³ ÀÌ ÄÚµå´Â eid¿¡ Ç¥ÁØ ¿µ¼ıÀÚ ÅØ½ºÆ®¸¸ ÀÖÀ¸¸é ¿Ã¹Ù·Î µ¿ÀÛÇÕ´Ï´Ù. eid°¡ ¸ŞÅ¸ ¹®ÀÚ³ª ¼Ò½º ÄÚµå°¡ Æ÷ÇÔµÈ °ªÀ» °®´Â °æ¿ì, À¥ ºê¶ó¿ìÀú°¡ HTTP ÀÀ´äÀ» Ç¥½ÃÇÒ ¶§ ÄÚµå¸¦ ½ÇÇàÇÕ´Ï´Ù.

Ã³À½¿¡´Â ÀÌ°ÍÀÌ Å« Ãë¾àÁ¡À¸·Î º¸ÀÌÁö ¾ÊÀ» ¼öµµ ÀÖ½À´Ï´Ù. °á±¹ ´©±º°¡ URLÀ» ÀÔ·ÂÇÏ¿© ÀÚ½ÅÀÇ ÄÄÇ»ÅÍ¿¡¼­ ¾Ç¼º ÄÚµå°¡ ½ÇÇàµÇ°Ô ÇÏ´Â ÀÌÀ¯´Â ¹«¾ùÀÔ´Ï±î? Á¤¸» À§ÇèÇÑ ÀÏÀº °ø°İÀÚ°¡ ¾Ç¼º URLÀ» ¸¸µç ´ÙÀ½ ÀüÀÚ ¸ŞÀÏ ¶Ç´Â »çÈ¸ °øÇĞ ¼ÓÀÓ¼ö¸¦ »ç¿ëÇÏ¿© ÇÇÇØÀÚ°¡ URLÀÇ ¸µÅ©¸¦ ¹æ¹®ÇÏµµ·Ï ¸¸µå´Â °ÍÀÔ´Ï´Ù. ÇÇÇØÀÚ°¡ ¸µÅ©¸¦ Å¬¸¯ÇÏ¸é ¸ğ¸£´Â »çÀÌ¿¡ Ãë¾àÇÑ À¥ ÀÀ¿ë ÇÁ·Î±×·¥À» ÅëÇØ ÇØ·Î¿î ³»¿ëÀ» º»ÀÎÀÇ ÄÄÇ»ÅÍ·Î Àü´ŞÇÏ°Ô µË´Ï´Ù. Ãë¾àÇÑ À¥ ÀÀ¿ë ÇÁ·Î±×·¥À» ÀÍ½ºÇÃ·ÎÀÌÆ®ÇÏ´Â ¸ŞÄ¿´ÏÁòÀ» Reflected XSS ¶ó°í ÇÕ´Ï´Ù.

¸ğ¹ÙÀÏ È¯°æ¿¡¼­´Â Cross-Site Scripting°ú °°Àº ÀüÇüÀûÀÎ À¥ ÀÀ¿ë ÇÁ·Î±×·¥ Ãë¾à¼ºÀÌ ¹ß»ıÇÏÁö ¾Ê´Â´Ù°í »ı°¢ÇÏ´Â »ç¿ëÀÚµµ ÀÖ½À´Ï´Ù. ÀÚ±â ÀÚ½ÅÀ» °ø°İÇÏ´Â »ç¿ëÀÚ´Â ¾øÀ» °ÍÀÌ¶ó ¿©±â±â ¶§¹®ÀÔ´Ï´Ù. ±×·¯³ª ¸ğ¹ÙÀÏ ÇÃ·§ÆûÀÇ ÇÙ½É ¿ä¼Ò´Â ´Ù¾çÇÑ ¼Ò½º¿¡¼­ ´Ù¿î·ÎµåµÇ¾î °°Àº ÀåÄ¡¿¡¼­ ÇÔ²² ½ÇÇàµÇ´Â ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ¶ó´Â Á¡À» À¯³äÇØ¾ß ÇÕ´Ï´Ù. Áï ±İÀ¶ ÀÀ¿ë ÇÁ·Î±×·¥°ú ¸È¿ş¾î¸¦ ÇÔ²² ½ÇÇàÇÒ °¡´É¼ºÀÌ ³ôÀ¸¹Ç·Î ÇÁ·Î¼¼½º °£ Åë½ÅÀ» Æ÷ÇÔÇÏµµ·Ï ¸ğ¹ÙÀÏ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ °ø°İ Ç¥¸éÀ» È®ÀåÇØ¾ß ÇÕ´Ï´Ù.

¿¹Á¦ 3: ´ÙÀ½ ÄÚµå´Â AndroidÀÇ WebView¿¡¼­ JavaScript¸¦ È°¼ºÈ­(±âº»ÀûÀ¸·Î JavaScript´Â ºñÈ°¼ºÈ­µÊ)ÇÏ°í Android ÀÎÅÙÆ®¿¡¼­ ¹ŞÀº °ªÀ» ±âÁØÀ¸·Î ÆäÀÌÁö¸¦ ·ÎµåÇÕ´Ï´Ù.


...
        WebView webview = (WebView) findViewById(R.id.webview);
        webview.getSettings().setJavaScriptEnabled(true);
        String url = this.getIntent().getExtras().getString("url");
        webview.loadUrl(url);
...


url °ªÀÌ javascript:·Î ½ÃÀÛÇÏ¸é ±× µÚ¿¡ ¿À´Â JavaScript ÄÚµå°¡ WebView ³»¿¡ ÀÖ´Â À¥ ÆäÀÌÁöÀÇ ÄÁÅØ½ºÆ®¿¡¼­ ½ÇÇàµË´Ï´Ù.

¿¹Á¦¿¡¼­Ã³·³, XSS Ãë¾àÁ¡Àº HTTP ÀÀ´ä¿¡ È®ÀÎµÇÁö ¾ÊÀº µ¥ÀÌÅÍ°¡ Æ÷ÇÔµÈ ÄÚµå ¶§¹®¿¡ ¹ß»ıÇÕ´Ï´Ù. XSS °ø°İÀÌ ÇÇÇØÀÚ¿¡°Ô °¡ÇØÁö´Â ¹æ½ÄÀº ¼¼ °¡Áö°¡ ÀÖ½À´Ï´Ù.

- Example 1¿¡¼­Ã³·³ ÀÀ¿ë ÇÁ·Î±×·¥Àº µ¥ÀÌÅÍº£ÀÌ½º ¶Ç´Â ´Ù¸¥ ½Å·ÚÇÒ ¼ö ÀÖ´Â µ¥ÀÌÅÍ ÀúÀå¼Ò¿¡ µ¥ÀÌÅÍ¸¦ ÀúÀåÇÕ´Ï´Ù. ±×·¯¸é À§ÇèÇÑ µ¥ÀÌÅÍ´Â ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ´Ù½Ã ÀĞ¾î µé¿© µ¿Àû ÄÜÅÙÆ®¿¡ Æ÷ÇÔ½ÃÅµ´Ï´Ù. Persistent XSS ÀÍ½ºÇÃ·ÎÀÌÆ®´Â °ø°İÀÚ°¡ À§ÇèÇÑ ÄÜÅÙÆ®¸¦ µ¥ÀÌÅÍ ÀúÀå¼Ò¿¡ »ğÀÔÇÏ°í ÀÌ ÄÜÅÙÆ®¸¦ ³ªÁß¿¡ ÀĞ¾î µé¿© µ¿Àû ÄÜÅÙÆ®¿¡ Æ÷ÇÔ½ÃÅ³ ¶§ ¹ß»ıÇÕ´Ï´Ù. °ø°İÀÚÀÇ °üÁ¡¿¡¼­ ¾Ç¼º ÄÜÅÙÆ®¸¦ »ğÀÔÇÒ ÃÖÀûÀÇ Àå¼Ò´Â ¸¹Àº »ç¿ëÀÚ³ª Æ¯È÷ °ü·Ã »ç¿ëÀÚ¿¡°Ô Ç¥½ÃµÇ´Â Àå¼ÒÀÔ´Ï´Ù. ÀÏ¹İÀûÀ¸·Î °ü·Ã »ç¿ëÀÚ´Â ÀÀ¿ë ÇÁ·Î±×·¥¿¡ ±ÇÇÑÀ» ³ôÀÌ°Å³ª °ø°İÀÚ°¡ ¿øÇÏ´Â ¹Î°¨ÇÑ µ¥ÀÌÅÍ¿Í »óÈ£ ÀÛ¿ëÇÕ´Ï´Ù. ÀÌ·± »ç¿ëÀÚ°¡ ¾Ç¼º ÄÜÅÙÆ®¸¦ ½ÇÇàÇÏ¸é °ø°İÀÚ´Â »ç¿ëÀÚ ´ë½Å ±ÇÇÑ ÀÖ´Â ÀÛ¾÷À» ½ÇÇàÇÏ°Å³ª »ç¿ëÀÚ ¼ÒÀ¯ÀÇ ¹Î°¨ÇÑ µ¥ÀÌÅÍ¿¡ Á¢±ÙÇÒ ¼ö ÀÖ½À´Ï´Ù.

- Example 2¿¡¼­Ã³·³ µ¥ÀÌÅÍ¸¦ HTTP ¿äÃ»¿¡¼­ Á÷Á¢ ÀĞ¾î µé¿© HTTP ÀÀ´ä¿¡ ´Ù½Ã Àû¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. Àû¿ëµÈ XSS ÀÍ½ºÇÃ·ÎÀÌÆ®´Â °ø°İÀÚ°¡ »ç¿ëÀÚ·Î ÇÏ¿©±İ À§ÇèÇÑ ÄÜÅÙÆ®¸¦ Ãë¾àÇÑ À¥ ÀÀ¿ë ÇÁ·Î±×·¥¿¡ Á¦°øÇÏµµ·Ï ¸¸µå´Â °ÍÀÔ´Ï´Ù. ÀÌ À§ÇèÇÑ ÄÜÅÙÆ®´Â ´Ù½Ã »ç¿ëÀÚ¿¡°Ô µ¹¾Æ°¡°í À¥ ºê¶ó¿ìÀú°¡ ÀÌ¸¦ ½ÇÇàÇÕ´Ï´Ù. ¾Ç¼º ÄÜÅÙÆ®¸¦ Á¦°øÇÏ´Â °¡Àå ÀÏ¹İÀûÀÎ ¸ŞÄ¿´ÏÁòÀº ÄÜÅÙÆ®¸¦ °ø¿ëÀ¸·Î °Ô½ÃÇÏ°Å³ª ÇÇÇØÀÚ¿¡°Ô Á÷Á¢ ÀüÀÚ ¸ŞÀÏ·Î º¸³»Áö´Â URLÀÇ ¸Å°³ º¯¼ö·Î Æ÷ÇÔÇÏ´Â °ÍÀÔ´Ï´Ù. ÀÌ·± ½ÄÀ¸·Î »ı¼ºµÈ URLÀº ¸¹Àº °ø°İÀÚ°¡ ÇÇÇØÀÚ¸¦ ¼Ó¿© ÇÇÇØ »çÀÌÆ®¸¦ ÂüÁ¶ÇÏ´Â URLÀ» ¹æ¹®ÇÏ°Ô ÇÏ´Â ÇÇ½Ì ±â¹ıÀÇ ±Ù°£À» ÀÌ·ì´Ï´Ù. »çÀÌÆ®°¡ °ø°İÀÚÀÇ ÄÜÅÙÆ®¸¦ »ç¿ëÀÚ¿¡°Ô º¸³»¸é, ÄÜÅÙÆ®°¡ ½ÇÇàµÇ°í ¼¼¼Ç Á¤º¸°¡ µé¾îÀÖ´Â ÄíÅ° µîÀÇ °³ÀÎ Á¤º¸°¡ »ç¿ëÀÚÀÇ ÄÄÇ»ÅÍ¿¡¼­ °ø°İÀÚ¿¡°Ô Àü¼ÛµÇ°Å³ª ´Ù¸¥ ¾ÇÀÇÀûÀÎ ÀÛ¾÷ÀÌ ¼öÇàµË´Ï´Ù.

- Example 3°ú °°ÀÌ ÀÀ¿ë ÇÁ·Î±×·¥ ¿ÜºÎÀÇ ¼Ò½º¿¡¼­ µ¥ÀÌÅÍº£ÀÌ½º ¶Ç´Â ±âÅ¸ µ¥ÀÌÅÍ ÀúÀå¼Ò¿¡ À§ÇèÇÑ µ¥ÀÌÅÍ¸¦ ÀúÀåÇÏ°í À§ÇèÇÑ µ¥ÀÌÅÍ¸¦ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ½Å·ÚÇÒ ¼ö ÀÖ´Â µ¥ÀÌÅÍ·Î ÀĞ¾î µé¿© µ¥ÀÌÅÍ°¡ µ¿Àû ÄÜÅÙÆ®¿¡ Æ÷ÇÔµË´Ï´Ù.


¸¹Àº ÃÖ½Å À¥ ÇÁ·¹ÀÓ¿öÅ©´Â »ç¿ëÀÚ ÀÔ·ÂÀÇ °ËÁõÀ» ¼öÇàÇÏ±â À§ÇÑ ¸ŞÄ¿´ÏÁòÀ» Á¦°øÇÕ´Ï´Ù(Struts ¹× Spring MVC Æ÷ÇÔ). È®ÀÎµÇÁö ¾ÊÀº ÀÔ·ÂÀÇ ¼Ò½º¸¦ °­Á¶ÇÏ±â À§ÇØ, Fortify º¸¾È ÄÚµù ±ÔÄ¢ ÆÑÀº ¾Ç¿ë °¡´É¼ºÀ» ³·Ãß°í ÇÁ·¹ÀÓ¿öÅ© °ËÁõ ¸ŞÄ¿´ÏÁòÀÌ »ç¿ë ÁßÀÏ ¶§¸¶´Ù Áö¿øÇÏ´Â Áõ°Å¿¡ Æ÷ÀÎÅÍ¸¦ Á¦°øÇÏ¿© Fortify Static Code Analyzer¿¡¼­ º¸°íÇÑ ¹®Á¦ÀÇ ¿ì¼± ¼øÀ§¸¦ µ¿ÀûÀ¸·Î ÀçÁöÁ¤ÇÕ´Ï´Ù. ÀÌ ±â´ÉÀ» Context-Sensitive Ranking(ÄÁÅØ½ºÆ® °¨Áö ¼øÀ§)ÀÌ¶ó°í ºÎ¸¨´Ï´Ù. Fortify »ç¿ëÀÚÀÇ °¨»ç ÇÁ·Î¼¼½º¸¦ Áö¿øÇÏ±â À§ÇØ, Fortify Software Security Research GroupÀº ÀÔ·Â ¼Ò½º¿¡ Àû¿ëµÈ °ËÁõ ¸ŞÄ¿´ÏÁò¿¡ µû¶ó ¹®Á¦¸¦ Æú´õ·Î ±×·ìÈ­ÇÏ´Â µ¥ÀÌÅÍ À¯È¿¼º ÇÁ·ÎÁ§Æ® ÅÛÇÃ¸´À» »ç¿ë °¡´ÉÇÏ°Ô ¸¸µì´Ï´Ù.
,XSS ¹æÁö¸¦ À§ÇÑ ÇØ°á ¹æ¹ıÀº ÇÊ¿äÇÑ À§Ä¡¿¡¼­ À¯È¿¼º °Ë»ç°¡ ¼öÇàµÇµµ·Ï ÇÏ°í Ãë¾à¼ºÀ» ¹æÁöÇÏµµ·Ï °ü·Ã ¼Ó¼ºÀ» ¼³Á¤ÇÏ´Â °ÍÀÔ´Ï´Ù.

XSS Ãë¾àÁ¡Àº ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ Ãâ·Â¿¡ ¾Ç¼º µ¥ÀÌÅÍ¸¦ Æ÷ÇÔÇÒ ¶§ ¹ß»ıÇÏ±â ¶§¹®¿¡ ÇÑ °¡Áö ³í¸®ÀûÀÎ Á¢±Ù ¹æ½ÄÀº µ¥ÀÌÅÍ°¡ ÀÀ¿ë ÇÁ·Î±×·¥À» ¹ş¾î³ª±â Á÷Àü¿¡ µ¥ÀÌÅÍ¸¦ È®ÀÎÇÏ´Â °ÍÀÔ´Ï´Ù. ÇÏÁö¸¸ À¥ ÀÀ¿ë ÇÁ·Î±×·¥¿¡ µ¿Àû ÄÜÅÙÆ® »ı¼ºÀ» À§ÇÑ º¹ÀâÇÏ°í ±î´Ù·Î¿î ÄÚµå°¡ ÀÖ±â ¶§¹®¿¡ ÀÌ ¹æ¹ıÀº »ı·«(°ËÁõ ´©¶ô) ¿À·ù°¡ ¹ß»ıÇÒ °¡´É¼ºÀÌ Å®´Ï´Ù. ÀÌ·± À§ÇèÀ» ¿ÏÈ­ÇÏ´Â È¿°úÀûÀÎ ¹æ¹ı ¿ª½Ã XSSÀÇ ÀÔ·Â°ª °ËÁõÀ» ¼öÇàÇÏ´Â °ÍÀÔ´Ï´Ù.

À¥ ÀÀ¿ë ÇÁ·Î±×·¥Àº SQL injection°ú °°Àº ´Ù¸¥ Ãë¾àÁ¡À» ¹æÁöÇÏ±â À§ÇØ ¸ğµç ÀÔ·ÂÀ» È®ÀÎÇØ¾ß ÇÕ´Ï´Ù. µû¶ó¼­ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ ±âÁ¸ ÀÔ·Â°ª °ËÁõ ¸ŞÄ¿´ÏÁò¿¡ XSS °Ë»ç¸¦ Æ÷ÇÔÇÏµµ·Ï È®´ëÇÏ´Â °ÍÀÌ ºñ±³Àû ½±½À´Ï´Ù. XSSÀÇ ÀÔ·Â°ª °ËÁõÀÌ ¾Æ¹«¸® ¶Ù¾î³ª´õ¶óµµ ¾ö°İÇÑ Ãâ·Â °ËÁõÀ» ´ë½ÅÇÒ ¼ö´Â ¾ø½À´Ï´Ù. ÀÀ¿ë ÇÁ·Î±×·¥Àº °øÀ¯ µ¥ÀÌÅÍ ÀúÀå¼Ò ¶Ç´Â ±âÅ¸ ½Å·ÚÇÒ ¼ö ÀÖ´Â ¼Ò½º¸¦ ÅëÇØ ÀÔ·ÂÀ» ¹Ş´Âµ¥ ±× µ¥ÀÌÅÍ ÀúÀå¼Ò°¡ ÀûÀıÇÑ ÀÔ·Â°ª °ËÁõÀ» ¼öÇàÇÏÁö ¾Ê´Â ¼Ò½º¿¡¼­ ÀÔ·ÂÀ» ¹ŞÀ» ¼ö ÀÖ½À´Ï´Ù. µû¶ó¼­ ÀÀ¿ë ÇÁ·Î±×·¥Àº ¾î¶² °æ¿ì¿¡µµ ÀÌ·± Àú·± µ¥ÀÌÅÍÀÇ ¾ÈÀüÀ» ½Å·ÚÇÒ ¼ö ¾ø½À´Ï´Ù. Áï, XSS Ãë¾àÁ¡À» ¿¹¹æÇÏ´Â ÃÖ¼±ÀÇ ¹æ¹ıÀº ÀÀ¿ë ÇÁ·Î±×·¥¿¡ µé¾î°¡°í ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­ »ç¿ëÀÚ¿¡°Ô Àü´ŞµÇ´Â ÀÔ·ÂÀ» ¸ğµÎ È®ÀÎÇÏ´Â °ÍÀÔ´Ï´Ù.

°¡Àå ¾ÈÀüÇÑ XSS °ËÁõ ¹æ¹ıÀº HTTP ÄÁÅÙÃ÷¿¡ »ç¿ëÇÒ ¼ö ÀÖ´Â ¾ÈÀüÇÑ ¹®ÀÚÀÇ Çã¿ë ¸ñ·ÏÀ» ¸¸µé¾î ÀÌ ½ÂÀÎµÈ ÁıÇÕÀÇ ¹®ÀÚ¸¸À¸·Î ÀÌ·ç¾îÁø ÀÔ·Â¸¸ ¹Ş´Â °ÍÀÔ´Ï´Ù. ¿¹¸¦ µé¾î, ¿Ã¹Ù¸¥ »ç¿ëÀÚ ÀÌ¸§Àº ¿µ¼ıÀÚ¸¸ Æ÷ÇÔÇÏ°Å³ª ÀüÈ­ ¹øÈ£´Â ¼ıÀÚ 0-9¸¸ Æ÷ÇÔÇÏµµ·Ï ÇÕ´Ï´Ù. ÇÏÁö¸¸ ÀÌ ¹æ¹ıÀº ¹®ÀÚ¸¦ ÀÎÄÚµùÇÑ ÈÄ ºê¶ó¿ìÀú¿¡ Æ¯º°ÇÑ ÀÇ¹Ì°¡ ÀÖ´Â ¸¹Àº ¹®ÀÚ¸¦ ¿Ã¹Ù¸¥ ÀÔ·ÂÀ¸·Î °£ÁÖÇØ¾ß ÇÏ´Â À¥ ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­´Â ½ÇÈ¿¼ºÀÌ ¶³¾îÁı´Ï´Ù. ±× ¿¹·Î »ç¿ëÀÚ·ÎºÎÅÍ HTML ÄÚµå¸¦ ÀÔ·Â¹Ş¾Æ¾ß ÇÏ´Â À¥ µğÀÚÀÎ °Ô½ÃÆÇÀ» µé ¼ö ÀÖ½À´Ï´Ù.

º¸´Ù À¯¿¬ÇÏÁö¸¸ ¾ÈÀü¼ºÀÌ ¶³¾îÁö´Â Á¢±Ù ¹æ½ÄÀº °ÅºÎ ¸ñ·ÏÀ» ±¸ÇöÇÏ´Â °ÍÀÔ´Ï´Ù. °ÅºÎ ¸ñ·Ï ¹æ½ÄÀº ÀÔ·ÂÀ» »ç¿ëÇÏ±â Àü¿¡ À§ÇèÇÑ ¹®ÀÚ¸¦ ¼±º°ÀûÀ¸·Î °ÅºÎÇÏ°Å³ª ÀÌ½ºÄÉÀÌÇÁ Ã³¸®ÇÕ´Ï´Ù. ¸®½ºÆ®¸¦ ¸¸µé·Á¸é ¸ÕÀú À¥ ºê¶ó¿ìÀú¿¡ Æ¯º°ÇÑ ÀÇ¹Ì°¡ ÀÖ´Â ¹®ÀÚ ÁıÇÕÀ» ÀÌÇØÇØ¾ß ÇÕ´Ï´Ù. HTML Ç¥ÁØ¿¡ Æ¯º°ÇÑ ÀÇ¹Ì°¡ ÀÖ´Â ¹®ÀÚ°¡ Á¤ÀÇµÇ¾î ÀÖ´Âµ¥µµ ¸¹Àº À¥ ºê¶ó¿ìÀú°¡ HTML¿¡¼­ ÈçÈ÷ ¹ß»ıÇÏ´Â ½Ç¼ö¸¦ ¼öÁ¤ÇÏ·Á°í ÇÏ°í ´Ù¸¥ ¹®ÀÚ¸¦ »óÈ²¿¡ µû¶ó Æ¯º°ÇÑ ÀÇ¹Ì·Î Ã³¸®ÇÒ ¼ö ÀÖ½À´Ï´Ù. ±×·¯¹Ç·Î °ÅºÎ ¸ñ·ÏÀ» »ç¿ëÇÏ¿© XSS¸¦ ¹æÁöÇÏÁö ¾Ê´Â °ÍÀÌ ÁÁ½À´Ï´Ù. Ä«³×±â ¸á·Ğ ´ëÇĞ SEI(Software Engineering Institute)ÀÇ CERT(R) Coordination Center¿¡¼­´Â ´ÙÀ½°ú °°ÀÌ ¿©·¯ »óÈ²¿¡¼­ Æ¯¼ö ¹®ÀÚ¿¡ ´ëÇÑ ¼¼ºÎ Á¤º¸¸¦ Á¦°øÇÕ´Ï´Ù[1].

Block-level element Ç×¸ñ(ÅØ½ºÆ® ´Ü¶ô Áß°£):

- "<"´Â ÅÂ±×°¡ ½ÃÀÛµÇ´Â Ç¥½ÃÀÌ±â ¶§¹®¿¡ Æ¯¼öÇÕ´Ï´Ù.

- "&"´Â ¹®ÀÚ ¿£ÅÍÆ¼°¡ ½ÃÀÛµÇ´Â Ç¥½ÃÀÌ±â ¶§¹®¿¡ Æ¯¼öÇÕ´Ï´Ù.

- ">"´Â ÀÏºÎ ºê¶ó¿ìÀú¿¡¼­ ÆäÀÌÁö ÀÛ¼ºÀÚ°¡ ¿©´Â "<"¸¦ Æ÷ÇÔÇÒ °èÈ¹ÀÌ¾úÁö¸¸ ½Ç¼ö·Î ´©¶ôÇß´Ù´Â °¡Á¤ÇÏ¿¡ Æ¯¼öÇÏ°Ô Ã³¸®µÇ±â ¶§¹®¿¡ Æ¯¼öÇÕ´Ï´Ù.

´ÙÀ½ ¿øÄ¢Àº ¼Ó¼º °ª¿¡ Àû¿ëµË´Ï´Ù.

- Å«µû¿ÈÇ¥·Î ¹­Àº ¼Ó¼º °ª¿¡¼­ Å«µû¿ÈÇ¥´Â ¼Ó¼º °ªÀÇ ³¡À» ³ªÅ¸³»±â ¶§¹®¿¡ Æ¯¼öÇÕ´Ï´Ù.

- ÀÛÀºµû¿ÈÇ¥·Î ¹­Àº ¼Ó¼º °ª¿¡¼­ ÀÛÀºµû¿ÈÇ¥´Â ¼Ó¼º °ªÀÇ ³¡À» ³ªÅ¸³»±â ¶§¹®¿¡ Æ¯¼öÇÕ´Ï´Ù.

- µû¿ÈÇ¥°¡ ¾ø´Â ¼Ó¼º °ª¿¡¼­ °ø¹é ¹× ÅÇ°ú °°Àº °ø¹é ¹®ÀÚ´Â Æ¯¼ö ¹®ÀÚÀÔ´Ï´Ù.

- "&"´Â Æ¯Á¤ ¼Ó¼º°ú ÇÔ²² »ç¿ëµÉ ¶§ ¹®ÀÚ ¿£ÅÍÆ¼°¡ ½ÃÀÛµÇ´Â °÷ÀÌ±â ¶§¹®¿¡ Æ¯¼öÇÕ´Ï´Ù. 

¿¹¸¦ µé¾î, URL¿¡¼­ °Ë»ö ¿£ÁøÀº °á°ú ÆäÀÌÁö ³»¿¡ »ç¿ëÀÚ°¡ Å¬¸¯¸¸ ÇÏ¸é °Ë»öÀ» ´Ù½Ã ½ÇÇàÇÒ ¼ö ÀÖ´Â ¸µÅ©¸¦ Á¦°øÇÕ´Ï´Ù. ÀÌ´Â URL ³»¿¡ °Ë»ö Äõ¸®¸¦ ÀÎÄÚµùÇÏ¿© ±¸ÇöÇÒ ¼ö ÀÖ´Âµ¥ Æ¯¼ö ¹®ÀÚ¸¦ Ãß°¡·Î µµÀÔÇÏ°Ô µË´Ï´Ù.

- °ø¹é, ÅÇ ¹× ÁÙ ¹Ù²ŞÀº URL ³¡À» ³ªÅ¸³»±â ¶§¹®¿¡ Æ¯¼öÇÕ´Ï´Ù.

- "&"´Â ¹®ÀÚ ¿£ÅÍÆ¼ÀÇ ½ÃÀÛÀ» ³ªÅ¸³»°Å³ª CGI ¸Å°³ º¯¼ö¸¦ ±¸ºĞÇÏ±â ¶§¹®¿¡ Æ¯¼öÇÕ´Ï´Ù.

- ASCII°¡ ¾Æ´Ñ ¹®ÀÚ(Áï, ISO-8859-1 ÀÎÄÚµù¿¡¼­ 127º¸´Ù Å« ¸ğµç ¹®ÀÚ)´Â URL¿¡ »ç¿ëÇÒ ¼ö ¾ø±â ¶§¹®¿¡ ÀÌ »óÈ²¿¡¼­ Æ¯¼ö ¹®ÀÚ·Î °£ÁÖµË´Ï´Ù.

- "%" ±âÈ£´Â HTTP ÀÌ½ºÄÉÀÌÇÁ ½ÃÄö½º·Î ÀÎÄÚµùµÈ ¸Å°³ º¯¼ö°¡ ¼­¹ö ÂÊ ÄÚµå·Î µğÄÚµùµÇ´Â °æ¿ì ÀÔ·Â¿¡¼­ ÇÊÅÍ¸µÇØ¾ß ÇÕ´Ï´Ù. ¿¹¸¦ µé¾î, "%"´Â "%68%65%6C%6C%6F"¿Í °°Àº ÀÔ·ÂÀÌ À¥ ÆäÀÌÁö¿¡ ³ªÅ¸³¯ ¶§ "hello"°¡ µÇ´Â °æ¿ì ÇÊÅÍ¸µÇØ¾ß ÇÕ´Ï´Ù.


<SCRIPT> </SCRIPT>ÀÇ º»¹® ³»¿¡¼­:

- ¼¼¹ÌÄİ·Ğ, °ıÈ£, Áß°ıÈ£ ¹× ÁÙ ¹Ù²Ş ¹®ÀÚ´Â ÅØ½ºÆ®¸¦ ÀÌÀüºÎÅÍ Á¸ÀçÇÏ´Â ½ºÅ©¸³Æ® ÅÂ±×¿¡ ¹Ù·Î »ğÀÔÇÏ´Â °æ¿ì ÇÊÅÍ¸µÇØ¾ß ÇÕ´Ï´Ù.

¼­¹ö ÂÊ ½ºÅ©¸³Æ®:

- ÀÔ·ÂÀÇ ´À³¦Ç¥(!)¸¦ Ãâ·ÂÀÇ Å«µû¿ÈÇ¥(")·Î º¯È¯ÇÏ´Â ¼­¹ö ÂÊ ½ºÅ©¸³Æ®¿¡´Â Ãß°¡ ÇÊÅÍ¸µÀÌ ÇÊ¿äÇÕ´Ï´Ù. 

±âÅ¸ °¡´É¼º:

- °ø°İÀÚ°¡ UTF-7·Î ¿äÃ»À» Á¦ÃâÇÏ´Â °æ¿ì Æ¯¼ö ¹®ÀÚ "<"°¡ '+ADw-'·Î ³ªÅ¸³ª°í ÇÊÅÍ¸µÀÌ ¹«½ÃµÉ ¼ö ÀÖ½À´Ï´Ù. Ãâ·Â¿¡ ÀÎÄÚµù Çü½ÄÀ» ¸í½ÃÀûÀ¸·Î ÁöÁ¤ÇÏÁö ¾Ê´Â ÆäÀÌÁö°¡ Æ÷ÇÔµÈ °æ¿ì ÀÏºÎ ºê¶ó¿ìÀú´Â ÄÜÅÙÆ®(ÀÌ °æ¿ì, UTF-7)¿¡ ±âÃÊÇÏ¿© ÇÕ¸®ÀûÀ¸·Î ÀÎÄÚµùÀ» ½Äº°ÇÏ·Á°í ½ÃµµÇÕ´Ï´Ù.

ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­ XSS °ø°İÀ» È®ÀÎÇÏ´Â Á¤È®ÇÑ ÁöÁ¡°ú È®ÀÎ °úÁ¤¿¡¼­ °í·ÁÇØ¾ß ÇÏ´Â Æ¯¼ö ¹®ÀÚ¸¦ ½Äº°ÇÑ ÈÄ ´ÙÀ½ °úÁ¦´Â È®ÀÎ °úÁ¤¿¡¼­ Æ¯¼ö ¹®ÀÚ¸¦ Ã³¸®ÇÏ´Â ¹æ¹ıÀ» ¾Ë¾Æ³»´Â °ÍÀÔ´Ï´Ù. Æ¯¼ö ¹®ÀÚ¸¦ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ ¿Ã¹Ù¸¥ ÀÔ·ÂÀ¸·Î °£ÁÖÇÏÁö ¾Ê´Â °æ¿ì, Æ¯¼ö ¹®ÀÚ°¡ µé¾î ÀÖ´Â ¸ğµç ÀÔ·ÂÀ» Àß¸øµÈ °ÍÀ¸·Î ÆÇ´ÜÇÏ°í °ÅºÎÇÒ ¼ö ÀÖ½À´Ï´Ù. µÎ ¹øÂ° ¿É¼ÇÀº ÇÊÅÍ¸µÀ¸·Î Æ¯¼ö ¹®ÀÚ¸¦ Á¦°ÅÇÏ´Â °ÍÀÔ´Ï´Ù. ÇÏÁö¸¸ ÇÊÅÍ¸µÀº ÇÊÅÍ¸µµÈ ÄÜÅÙÆ®ÀÇ Ç¥ÇöÀ» º¯°æ½ÃÅ°´Â ºÎÀÛ¿ëÀÌ ÀÖ±â ¶§¹®¿¡ ÀÔ·Â ³»¿ëÀ» ±×´ë·Î º¸Á¸ÇÏ¿© Ç¥½ÃÇØ¾ß ÇÏ´Â °æ¿ì¿¡´Â Çã¿ëÇÒ ¼ö ¾ø½À´Ï´Ù.

Æ¯¼ö ¹®ÀÚ°¡ ÀÖ´Â ÀÔ·ÂÀ» ¹Ş¾Æµé¿© ±×´ë·Î Ç¥½ÃÇØ¾ß ÇÏ´Â °æ¿ì, °ËÁõ ÀÛ¾÷¿¡¼­ Æ¯¼ö ¹®ÀÚ¸¦ ÀÎÄÚµùÇÏ¿© Æ¯¼öÇÑ ÀÇ¹Ì¸¦ Á¦°ÅÇØ¾ß ÇÕ´Ï´Ù. ISO 8859-1 Æ¯¼ö ¹®ÀÚÀÇ ÀÎÄÚµùµÈ °ªÀÇ ¿ÏÀüÇÑ ¸ñ·ÏÀÌ °ø½Ä HTML ±Ô°İÀÇ ÀÏºÎ·Î Á¦°øµË´Ï´Ù[2].

¸¹Àº ÀÀ¿ë ÇÁ·Î±×·¥ ¼­¹ö°¡ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ Cross-Site Scripting °ø°İ¿¡ ÇÊ¼öÀûÀÎ ¹®ÀÚ°¡ ÀÖ´ÂÁö È®ÀÎÇÏ´Â Æ¯Á¤ HTTP ÀÀ´ä ÄÜÅÙÆ® ¼³Á¤À» ´ã´çÇÏ´Â ±â´ÉÀ» ±¸ÇöÇÏ¿© Cross-Site Scripting Ãë¾àÁ¡¿¡ ³ëÃâµÇ´Â °ÍÀ» ¸·À¸·Á°í ÇÕ´Ï´Ù. ÀÀ¿ë ÇÁ·Î±×·¥À» ½ÇÇàÇÏ´Â ¼­¹ö¿¡ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ º¸¾ÈÀ» ¸Ã±æ ¼ö ¾ø½À´Ï´Ù. °³¹ßµÈ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ ¼ö¸í µ¿¾È ¾î¶² ¼­¹ö¿¡¼­ ½ÇÇàµÉÁö ¾Ë ¼ö ¾ø±â ¶§¹®ÀÔ´Ï´Ù. Ç¥ÁØ ¹× ¾Ë·ÁÁø ÀÍ½ºÇÃ·ÎÀÌÆ®ÀÇ ÁøÈ­ ¼Óµµ¿¡ µû¶ó ÀÀ¿ë ÇÁ·Î±×·¥ ¼­¹ö°¡ °è¼Ó ÁøÈ­ÇÑ´Ù´Â º¸ÀåÀÌ ¾ø½À´Ï´Ù.,1. µ¥ÀÌÅÍº£ÀÌ½º¿¡ ½Å·ÚÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍ¸¦ ¾²¸é Fortify Secure Coding Rulepacks¿¡¼­ SQL Injection °ü·Ã °æ°í¸¦ Ç¥½ÃÇÏ¸ç, µ¥ÀÌÅÍº£ÀÌ½º¸¦ ½Å·ÚÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍÀÇ ¼Ò½º·Î Ã³¸®ÇÏ¹Ç·Î XSS Ãë¾à¼ºÀÌ ¹ß»ıÇÒ ¼ö ÀÖ½À´Ï´Ù. µ¥ÀÌÅÍº£ÀÌ½º°¡ »ç¿ëÀÚ È¯°æ¿¡¼­ ½Å·ÚÇÒ ¼ö ÀÖ´Â ¸®¼Ò½ºÀÎ °æ¿ì, »ç¿ëÀÚ ÁöÁ¤ ÇÊÅÍ¸¦ »ç¿ëÇÏ¿© DATABASE °¨¿° ÇÃ·¡±×¸¦ Æ÷ÇÔÇÏ°í µ¥ÀÌÅÍº£ÀÌ½º ¼Ò½º¿¡¼­ ¹ß»ıÇÏ´Â µ¥ÀÌÅÍ Èå¸§ ÀÌ½´¸¦ ÇÊÅÍ¸µÇÏ½Ê½Ã¿À. ±×·¯³ª µ¥ÀÌÅÍº£ÀÌ½º¿¡¼­ ÀĞ´Â ¸ğµç ³»¿ëÀ» È®ÀÎÇÏ´Â °ÍÀÌ ¿©ÀüÈ÷ È¿°úÀûÀÎ °æ¿ì°¡ ¸¹½À´Ï´Ù.

2. ºñ·Ï ½Å·ÚÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍ¿¡ ´ëÇÑ URL ÀÎÄÚµùÀÌ ¸¹Àº XSS °ø°İÀ» ¸·¾ÆÁÖ±ä ÇÏÁö¸¸, ÀÏºÎ ºê¶ó¿ìÀú(Æ¯È÷ Internet Explorer 6 ¹× 7 ±× ¿Ü ´Ù¸¥ ºê¶ó¿ìÀúµé)´Â JavaScript ÀÎÅÍÇÁ¸®ÅÍ·Î Àü¼ÛÇÏ±â Àü¿¡ DOM(Document Object Model) ³»ÀÇ Æ¯Á¤ ÁöÁ¡¿¡¼­ ÀÚµ¿À¸·Î ³»¿ëÀ» ÇØµ¶ÇÕ´Ï´Ù. ÀÌ·¯ÇÑ À§ÇèÀ» ¹İ¿µÇÏ±â À§ÇØ ·êÆÑÀº ´õ ÀÌ»ó Cross-Site ScriptingÀ» ¹æÁöÇÏ´Â µ¥ ÃæºĞÇÑ URL ÀÎÄÚµù ·çÆ¾À» Ã³¸®ÇÏÁö ¾Ê½À´Ï´Ù. URL ¾ÏÈ£È­ ÀÌÈÄ µµÃâµÇ´Â µ¥ÀÌÅÍ °ªÀ¸·Î Fortify´Â Cross-Site Scripting, Poor Validation Ãë¾àÁ¡À» º¸°íÇÒ ¼ö ÀÖ½À´Ï´Ù.

3. Fortify AppDefender adds protection against this category.,B096458EEBEC91D30EA97721FF2F280D,4D69E4E2-959C-4EF8-84F4-A6489B288ABF,,,,2024-02-13,
Low,Low,API Abuse,J2EE Bad Practices: getConnection(),src/adrui/LoginModel.java,LoginModel.java,,	public String check(Connection conn, String user, String pass) throws SQLException{
		state = conn.createStatement();
		rs = state.executeQuery(sql);
		while(rs.next()){
			if(rs.getString(2).equals(user)){,java.sql.Statement.executeQuery(),src/adrui/MyContextListener.java,MyContextListener.java,,		try{
			Class.forName(driver);//?Š è½½é©±?Š¨ç¨‹åºç±?, é«˜ç‰ˆ?œ¬jdbc?¯ä»¥çœ?», ?›¸?…³?¯?‡ªè¡Œç™¾åº?
			Connection conn = DriverManager.getConnection(url, user, pass);
			sc.setAttribute("conn", conn);
			System.out.println("Connect Succeed!");,getConnection(),J2EE Ç¥ÁØÀº Á÷Á¢ÀûÀÎ ¿¬°á °ü¸®¸¦ ±İÁöÇÕ´Ï´Ù.,J2EE Ç¥ÁØÀº Á÷Á¢ÀûÀÎ ¿¬°á °ü¸®¸¦ ±İÁöÇÕ´Ï´Ù.,J2EE Ç¥ÁØ¿¡ µû¸£¸é ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ÄÁÅ×ÀÌ³ÊÀÇ ¸®¼Ò½º °ü¸® ±â´ÉÀ» »ç¿ëÇÏ¿© ¸®¼Ò½º ¿¬°áÀ» È®º¸ÇØ¾ß ÇÕ´Ï´Ù. 

¿¹¸¦ µé¾î, J2EE ÀÀ¿ë ÇÁ·Î±×·¥Àº ´ÙÀ½°ú °°ÀÌ µ¥ÀÌÅÍº£ÀÌ½º¿¡ ¿¬°áÇØ¾ß ÇÕ´Ï´Ù.


ctx = new InitialContext();
datasource = (DataSource)ctx.lookup(DB_DATASRC_REF);
conn = datasource.getConnection();


¶ÇÇÑ ´ÙÀ½°ú °°Àº ¹æ½ÄÀ¸·Î ¿¬°áÇÏ´Â °ÍÀº ÇÇÇØ¾ß ÇÕ´Ï´Ù.


conn = DriverManager.getConnection(CONNECT_STRING);


¸ğµç ÁÖ¿ä À¥ ÀÀ¿ë ÇÁ·Î±×·¥ ÄÁÅ×ÀÌ³Ê´Â ¸®¼Ò½º °ü¸® ÇÁ·¹ÀÓ¿öÅ©ÀÇ ÀÏºÎ·Î °ø¿ë µ¥ÀÌÅÍº£ÀÌ½º ¿¬°á °ü¸® ±â´ÉÀ» Á¦°øÇÕ´Ï´Ù. ÀÀ¿ë ÇÁ·Î±×·¥¿¡ ÀÌ ±â´ÉÀ» º¹Á¦ÇÏ´Â °ÍÀº ¾î·Á¿î ÀÛ¾÷ÀÌ°í ¿À·ù°¡ ¹ß»ıÇÏ±â ½±±â ¶§¹®¿¡ J2EE Ç¥ÁØ¿¡¼­ ±İÁöÇÕ´Ï´Ù.,DriverManager.getConnection()ÀÇ Á÷Á¢ È£ÃâÀ» ÀûÀıÇÑ ¿¬°á ÆÑÅä¸®ÀÇ JNDI Á¶È¸·Î ´ëÃ¼ÇÏ¿© ¿¬°á ÆÑÅä¸®¸¦ ÅëÇØ ¿¬°áÇÕ´Ï´Ù.,1. »ç¿ë ÁßÀÎ ¸®¼Ò½º °ü¸® ½ºÅ°¸¶ÀÇ º¹Àâ¼º¿¡ µû¶ó µ¶Á¡ ¿¬°á °ü¸® ÀÎÇÁ¶ó¿¡¼­ Æ¯Á¤ ¿À·ù¸¦ ½Äº°ÇÏ´Â °ÍÀÌ ¾î·Á¿ï ¼ö ÀÖ½À´Ï´Ù. ¹ö±×¸¦ Ã£À¸·Á ÇÏ´Â ´ë½Å ÄÁÅ×ÀÌ³Ê¿¡¼­ Á¦°øÇÏ´Â ¿¬°á Ç® °ü¸®ÀÚ·Î ÀÀ¿ë ÇÁ·Î±×·¥À» ¸¶ÀÌ±×·¹ÀÌ¼ÇÇÏµµ·Ï ÇÕ´Ï´Ù.

2. ¾ß±âµÉ °¡´É¼ºÀÌ ÀÖ´Â ´õ ¸¹Àº ÀÏ¹İÀûÀÎ ¼º´É ¹®Á¦ ¿Ü¿¡µµ µ¶Á¡ ¿¬°á °ü¸®´Â ºñ¹Ğ¹øÈ£ °ü¸® ½Ç¼ö·Î ÀÌ¾îÁö´Â °æ¿ì°¡ ¸¹½À´Ï´Ù. ÀÚÃ¼ µ¥ÀÌÅÍº£ÀÌ½º ¿¬°áÀ» °ü¸®ÇÏ´Â ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­´Â Áï½Ã »ç¿ëÇÒ ¼ö ÀÖ´Â ´ë¾ÈÀÌ ¾ø±â ¶§¹®¿¡ ÀÏ¹İ ÅØ½ºÆ® ±¸¼º ÆÄÀÏ¿¡ ÇÏµåÄÚµåµÇ°Å³ª ÀúÀåµÈ ºñ¹Ğ¹øÈ£¸¦ Ã£´Â °ÍÀÌ ÀÏ¹İÀûÀÔ´Ï´Ù. ÀÌ·¯ÇÑ À¯ÇüÀÇ µ¿ÀÛ ¿¹´Â ÀÀ¿ë ÇÁ·Î±×·¥ ¼­¹ö °ü¸® ¿¬°á Ç®·Î ÀÌµ¿ÇÏ±â À§ÇÑ ÀÎ¼ö¿¡ Á¤º¸¸¦ Ãß°¡ÇÏ´Â ¿ªÇÒÀ» ÇØ¾ß ÇÕ´Ï´Ù.

3. J2EE°¡ ¾Æ´Ñ Java ÀÀ¿ë ÇÁ·Î±×·¥À» °¨»çÇÏ´Â °æ¿ì J2EEÀÇ ºÎÀûÀıÇÑ »ç·Ê ¹üÁÖ°¡ »ç¿ëÀÚ È¯°æ¿¡ Àû¿ëµÇÁö ¾ÊÀ» ¼ö ÀÖ½À´Ï´Ù. ÀÌ·± °æ¿ì Audit Guide¸¦ »ç¿ëÇÏ¿© ÀÌ·¯ÇÑ ¹®Á¦¸¦ ¾ïÁ¦ÇÒ ¼ö ÀÖ½À´Ï´Ù.,E4385F2C90FC80BDADB7174333CB0B19,EDD8E0B5-D8F2-4F56-A20B-549E3880318B,,,,2024-02-13,
Low,Low,Environment,J2EE Misconfiguration: Excessive Session Timeout,src/adrui/LoginModel.java,LoginModel.java,,	public String check(Connection conn, String user, String pass) throws SQLException{
		state = conn.createStatement();
		rs = state.executeQuery(sql);
		while(rs.next()){
			if(rs.getString(2).equals(user)){,java.sql.Statement.executeQuery(),WEB-INF/web.xml,web.xml,,<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">
  <display-name>LoginProject</display-name>
  <welcome-file-list>,getConnection(),Áö³ªÄ¡°Ô ±ä ¼¼¼Ç ½Ã°£ ÃÊ°ú´Â °ø°İÀÚ¿¡°Ô »ç¿ëÀÚ °èÁ¤À» ÀáÀçÀûÀ¸·Î ¼Õ»ó½ÃÅ³ ¼ö ÀÖ´Â ½Ã°£À» ´õ ¸¹ÀÌ Á¦°øÇÕ´Ï´Ù.,Áö³ªÄ¡°Ô ±ä ¼¼¼Ç ½Ã°£ ÃÊ°ú´Â °ø°İÀÚ¿¡°Ô »ç¿ëÀÚ °èÁ¤À» ÀáÀçÀûÀ¸·Î ¼Õ»ó½ÃÅ³ ¼ö ÀÖ´Â ½Ã°£À» ´õ ¸¹ÀÌ Á¦°øÇÕ´Ï´Ù.,¼¼¼ÇÀ» ´õ ¿À·¡ ¿­¾îµÑ¼ö·Ï, °ø°İÀÚ°¡ »ç¿ëÀÚ °èÁ¤À» ¼Õ»ó½ÃÅ³ ¼ö ÀÖ´Â ±âÈ¸´Â ´õ Ä¿Áı´Ï´Ù. ¼¼¼ÇÀÌ È°¼ºÈ­ »óÅÂ¶ó¸é °ø°İÀÚ´Â »ç¿ëÀÚÀÇ ¾ÏÈ£¸¦ ¹«Â÷º° ´ëÀÔÇÏ°Å³ª »ç¿ëÀÚÀÇ ¹«¼± ¾ÏÈ£È­ Å°¸¦ ºÒ¹ıÀ¸·Î º¹Á¦ÇÏ°Å³ª ¿­·Á ÀÖ´Â ºê¶ó¿ìÀú¿¡¼­ ¼¼¼ÇÀ» Á¦¸Ú´ë·Î ¾µ ¼öµµ ÀÖ½À´Ï´Ù. ¶ÇÇÑ ¼¼¼Ç ÃÊ°ú ½Ã°£ÀÌ ´õ ±æ¾îÁö¸é ¸Ş¸ğ¸®°¡ ÇØÁ¦µÇÁö ¸øÇÏµµ·Ï ÇÏ¿© °á±¹ ÃæºĞÈ÷ ¸¹Àº ¼¼¼ÇÀÌ ¸¸µé¾îÁö´Â °æ¿ì Denial of Service°¡ ¹ß»ıµË´Ï´Ù.

¿¹Á¦ 1: ¼¼¼Ç ½Ã°£ ÃÊ°ú°¡ 0 ¶Ç´Â 0 ¹Ì¸¸ÀÏ °æ¿ì, ¼¼¼ÇÀº ¸¸·áµÇÁö ¾Ê½À´Ï´Ù. ´ÙÀ½ ¿¹´Â -1·Î ¼³Á¤µÈ ¼¼¼Ç ½Ã°£ ÃÊ°ú¸¦ º¸¿©ÁÖ¸ç ÀÌ·Î ÀÎÇØ ¼¼¼ÇÀº ¹«±âÇÑÀ¸·Î È°¼ºÈ­ »óÅÂ°¡ µË´Ï´Ù.

<session-config>
    <session-timeout>-1</session-timeout>
</session-config>


<session-timeout> ÅÂ±×´Â À¥ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ ¸ğµç ¼¼¼Ç¿¡ ´ëÇØ ±âº» ¼¼¼Ç ½Ã°£ ÃÊ°ú °£°İÀ» Á¤ÀÇÇÕ´Ï´Ù. <session-timeout> ÅÂ±×°¡ ´©¶ôµÈ °æ¿ì, ±âº» ½Ã°£ ÃÊ°ú¸¦ ¼³Á¤ÇÏµµ·Ï ÄÁÅ×ÀÌ³Ê¿¡ ¸Ã°ÜÁı´Ï´Ù.
ÀÌ Ä«Å×°í¸®´Â Cigital Java Rulepack¿¡¼­ ºñ·ÔµÇ¾ú½À´Ï´Ù.,¼¼¼Ç ½Ã°£ ÃÊ°ú¸¦ 30ºĞ ÀÌÇÏ·Î ¼³Á¤ÇÏ½Ê½Ã¿À. ±×·¯¸é »ç¿ëÀÚ°¡ ÀÏÁ¤ ±â°£ µ¿¾È ÀÀ¿ë ÇÁ·Î±×·¥°ú »óÈ£ ÀÛ¿ëÇÒ ¼ö ÀÖÀ» »Ó ¾Æ´Ï¶ó °ø°İ ±â°£¿¡ ´ëÇÑ ÇÕ¸®ÀûÀÎ °æ°è°¡ Á¦°øµË´Ï´Ù.

¿¹Á¦ 2: ´ÙÀ½ ¿¹Á¦´Â ¼¼¼Ç ½Ã°£ ÃÊ°ú¸¦ 20ºĞÀ¸·Î ¼³Á¤ÇÕ´Ï´Ù.

<session-config>
  <session-timeout>20</session-timeout>
</session-config>
,,C2F39B963AB1AFACD8D57325EEAF747F,B7ED276F-524D-444B-8930-7D77535BF0D0,,,,2024-02-13,
Low,Low,Environment,J2EE Misconfiguration: Missing Error Handling,src/adrui/LoginModel.java,LoginModel.java,,	public String check(Connection conn, String user, String pass) throws SQLException{
		state = conn.createStatement();
		rs = state.executeQuery(sql);
		while(rs.next()){
			if(rs.getString(2).equals(user)){,java.sql.Statement.executeQuery(),WEB-INF/web.xml,web.xml,,<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">
  <display-name>LoginProject</display-name>
  <welcome-file-list>,/web-app(),À¥ ÀÀ¿ë ÇÁ·Î±×·¥Àº ±âº» ¿À·ù ÆäÀÌÁö¸¦ Á¤ÀÇÇÏ¿© °ø°İÀÚ°¡ ÀÀ¿ë ÇÁ·Î±×·¥ ÄÁÅ×ÀÌ³ÊÀÇ ±âº» Á¦°ø ¿À·ù ÀÀ´äÀÇ Á¤º¸¸¦ »©³»´Â °ÍÀ» ¹æÁöÇØ¾ß ÇÕ´Ï´Ù.,À¥ ÀÀ¿ë ÇÁ·Î±×·¥Àº ±âº» ¿À·ù ÆäÀÌÁö¸¦ Á¤ÀÇÇÏ¿© °ø°İÀÚ°¡ ÀÀ¿ë ÇÁ·Î±×·¥ ÄÁÅ×ÀÌ³ÊÀÇ ±âº» Á¦°ø ¿À·ù ÀÀ´äÀÇ Á¤º¸¸¦ »©³»´Â °ÍÀ» ¹æÁöÇØ¾ß ÇÕ´Ï´Ù.,°ø°İÀÚ°¡ À¥ »çÀÌÆ®¿¡¼­ Ãë¾àÁ¡À» Ã£±â À§ÇØ Å½»öÇÒ ¶§ »çÀÌÆ®°¡ Á¦°øÇÏ´Â Á¤º¸ÀÇ ¾çÀÌ °ø°İ ½ÃµµÀÇ ¼ºÆĞ¸¦ °áÁ¤Áş´Â ÇÙ½É ¿ä¼ÒÀÔ´Ï´Ù. ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ °ø°İÀÚ¿¡°Ô ½ºÅÃ ÃßÀûÀ» º¸¿©ÁÖ¸é °ø°İÀÚÀÇ °ø°İÀ» ¾ÆÁÖ ½±°Ô ¸¸µå´Â Á¤º¸¸¦ Á¦°øÇÏ´Â ¼ÀÀÌ µË´Ï´Ù. ¿¹¸¦ µé¾î, ½ºÅÃ ÃßÀûÀº °ø°İÀÚ¿¡°Ô Àß¸øµÈ SQL Äõ¸® ¹®ÀÚ¿­, »ç¿ë ÁßÀÎ µ¥ÀÌÅÍº£ÀÌ½º À¯Çü ¹× ÀÀ¿ë ÇÁ·Î±×·¥ ÄÁÅ×ÀÌ³Ê ¹öÀüÀ» º¸¿©ÁÙ ¼ö ÀÖ½À´Ï´Ù. °ø°İÀÚ´Â ÀÌ Á¤º¸¸¦ »ç¿ëÇÏ¿© ÀÌ ±¸¼º ¿ä¼ÒÀÇ ¾Ë·ÁÁø Ãë¾àÁ¡À» °ø·«ÇÕ´Ï´Ù.

ÀÀ¿ë ÇÁ·Î±×·¥ ±¸¼ºÀº ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ¿À·ù ¸Ş½ÃÁö¸¦ °ø°İÀÚ¿¡°Ô ´©ÃâÇÏÁö ¾Ê´Â´Ù´Â °ÍÀ» º¸ÀåÇÏ±â À§ÇØ ±âº» ¿À·ù ÆäÀÌÁö¸¦ ÁöÁ¤ÇØ¾ß ÇÕ´Ï´Ù. Ç¥ÁØ HTTP ¿À·ù ÄÚµå¸¦ Ã³¸®ÇÏ´Â °ÍÀº ¹Ù¶÷Á÷ÇÑ º¸¾È °üÇàÀÏ »Ó¸¸ ¾Æ´Ï¶ó À¯¿ëÇÏ°í »ç¿ëÀÚ Ä£È­ÀûÀÔ´Ï´Ù. ¶ÇÇÑ ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­ ¹ß»ıÇÒ ¼ö ÀÖ´Â ¿¹¿Ü¸¦ Æ÷ÂøÇÏ´Â ¸¶Áö¸· ¿À·ù Ã³¸®±âµµ Á¤ÀÇÇØ¾ß ÁÁÀº ±¸¼ºÀÌ¶ó°í ÇÒ ¼ö ÀÖ½À´Ï´Ù.,À¥ ÀÀ¿ë ÇÁ·Î±×·¥Àº ±âº» ¿À·ù ÆäÀÌÁö¿Í ÇÔ²² ±¸¼ºÇØ¾ß ÇÕ´Ï´Ù. web.xml¿¡ ÃÖ¼ÒÇÑ ´ÙÀ½ Ç×¸ñÀÌ Æ÷ÇÔµÇ¾î¾ß ÇÕ´Ï´Ù.


<error-page>
   <exception-type>java.lang.Throwable</exception-type>
<location>/error.jsp</location>
</error-page>
<error-page>
   <error-code>404</error-code>
<location>/error.jsp</location>
</error-page>
<error-page>
   <error-code>500</error-code>
<location>/error.jsp</location>
</error-page>
,,399A248E35AE0FBB04255DE45FA9754C,749BCC9F-FE61-4DC0-9EF2-5EF1872C7717,,,,2024-02-13,
Low,Low,Security Features,Password Management,src/adrui/MyContextListener.java,MyContextListener.java,,		String url = sc.getInitParameter("url");
		String user = sc.getInitParameter("user");
		String pass = sc.getInitParameter("pass");
		try{
			Class.forName(driver);//?Š è½½é©±?Š¨ç¨‹åºç±?, é«˜ç‰ˆ?œ¬jdbc?¯ä»¥çœ?», ?›¸?…³?¯?‡ªè¡Œç™¾åº?,javax.servlet.ServletContext.getInitParameter(),src/adrui/MyContextListener.java,MyContextListener.java,,		try{
			Class.forName(driver);//?Š è½½é©±?Š¨ç¨‹åºç±?, é«˜ç‰ˆ?œ¬jdbc?¯ä»¥çœ?», ?›¸?…³?¯?‡ªè¡Œç™¾åº?
			Connection conn = DriverManager.getConnection(url, user, pass);
			sc.setAttribute("conn", conn);
			System.out.println("Connect Succeed!");,java.sql.DriverManager.getConnection(),MyContextListener.javaÀÇ contextInitialized() ¸Ş¼­µå´Â 28 ÁÙÀÇ ÀÏ¹İ ÅØ½ºÆ® ¾ÏÈ£¸¦ »ç¿ëÇÕ´Ï´Ù. ¾ÏÈ£¸¦ ÀÏ¹İ ÅØ½ºÆ®·Î ÀúÀåÇÏ¸é ½Ã½ºÅÛ Ä§ÇØ°¡ ¹ß»ıÇÒ ¼ö ÀÖ½À´Ï´Ù.,MyContextListener.javaÀÇ contextInitialized() ¸Ş¼­µå´Â 28 ÁÙÀÇ ÀÏ¹İ ÅØ½ºÆ® ¾ÏÈ£¸¦ »ç¿ëÇÕ´Ï´Ù. ¾ÏÈ£¸¦ ÀÏ¹İ ÅØ½ºÆ®·Î ÀúÀåÇÏ¸é ½Ã½ºÅÛ Ä§ÇØ°¡ ¹ß»ıÇÒ ¼ö ÀÖ½À´Ï´Ù.,Password management ÀÌ½´´Â ¾ÏÈ£¸¦ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ ¼Ó¼º ¶Ç´Â ±¸¼º ÆÄÀÏ¿¡ ÀÏ¹İ ÅØ½ºÆ®·Î ÀúÀåÇÒ ¶§ ¹ß»ıÇÕ´Ï´Ù. 

¿¹Á¦ 1: ´ÙÀ½ ÄÚµå´Â ¼Ó¼º ÆÄÀÏ¿¡¼­ ¾ÏÈ£¸¦ ÀĞ¾î ÀÌ ¾ÏÈ£¸¦ »ç¿ëÇÏ¿© µ¥ÀÌÅÍº£ÀÌ½º¿¡ ¿¬°áÇÕ´Ï´Ù.


...
Properties prop = new Properties();
prop.load(new FileInputStream("config.properties"));
String password = prop.getProperty("password");

DriverManager.getConnection(url, usr, password);
...


ÀÌ ÄÚµå´Â ¿Ã¹Ù·Î ½ÇÇàµÇÁö¸¸ config.properties¿¡ ´ëÇÑ ¾×¼¼½º ±ÇÇÑÀÌ ÀÖ´Â »ç¿ëÀÚ¸é ´©±¸³ª passwordÀÇ °ªÀ» ÀĞÀ» ¼ö ÀÖ½À´Ï´Ù. ºñ¾ç½ÉÀûÀÎ Á÷¿øÀÌ ÀÌ Á¤º¸¿¡ ´ëÇÑ ¾×¼¼½º ±ÇÇÑÀ» °®°Ô µÇ¸é ÀÌ¸¦ »ç¿ëÇÏ¿© ½Ã½ºÅÛ¿¡ Ä§ÀÔÇÒ ¼ö ÀÖ½À´Ï´Ù.

¸ğ¹ÙÀÏ È¯°æ¿¡¼­´Â ÀåÄ¡ ºĞ½Ç À§ÇèÀÌ ³ô±â ¶§¹®¿¡ ¾ÏÈ£ °ü¸®°¡ Æ¯È÷ Áß¿äÇÕ´Ï´Ù.
¿¹Á¦ 2: ´ÙÀ½ ÄÚµå´Â Android WebView ÀúÀå¼Ò¿¡¼­ »ç¿ëÀÚ ÀÌ¸§°ú ¾ÏÈ£¸¦ ÀĞÀº ´ÙÀ½ º¸È£µÈ ÆäÀÌÁö¸¦ º¸±â À§ÇÑ ÀÎÁõÀ» ¼³Á¤ÇÏ´Â µ¥ »ç¿ëÇÕ´Ï´Ù.

...
webview.setWebViewClient(new WebViewClient() {
  public void onReceivedHttpAuthRequest(WebView view,
        HttpAuthHandler handler, String host, String realm) {
    String[] credentials = view.getHttpAuthUsernamePassword(host, realm);
    String username = credentials[0];
    String password = credentials[1];
    handler.proceed(username, password);
  }
});
...


WebView ÀÚ°İ Áõ¸íÀº ±âº»ÀûÀ¸·Î ÀÏ¹İ ÅØ½ºÆ®·Î ÀúÀåµÇ°í ÇØ½ÃµÇÁö ¾Ê½À´Ï´Ù. µû¶ó¼­ »ç¿ëÀÚ°¡ ·çÆÃµÈ ÀåÄ¡³ª ¿¡¹Ä·¹ÀÌÅÍ¸¦ »ç¿ëÇÏ´Â °æ¿ì ÁöÁ¤µÈ »çÀÌÆ®¿¡ ÀúÀåµÈ ¾ÏÈ£¸¦ ÀĞÀ» ¼ö ÀÖ½À´Ï´Ù.,¾ÏÈ£¸¦ ÀÏ¹İ ÅØ½ºÆ®·Î ÀúÀåÇØ¼­´Â ¾È µË´Ï´Ù. ½Ã½ºÅÛÀÌ ½ÃÀÛµÉ ¶§ °ü¸®ÀÚ¿¡°Ô ¾ÏÈ£¸¦ ÀÔ·ÂÇÏµµ·Ï ¿ä±¸ÇØ¾ß ÇÕ´Ï´Ù. ÀÌ ¹æ¹ıÀ» »ç¿ëÇÒ ¼ö ¾øÀ» ¶§ ¾ÈÀü¼ºÀº ¶³¾îÁöÁö¸¸ ºñ±³Àû Å¸´çÇÑ ¼Ö·ç¼ÇÀº ¾ÏÈ£¸¦ ³­µ¶ Ã³¸®ÇÏ°í ½Ã½ºÅÛ¿¡ ³­µ¶ Ã³¸® ÇØÁ¦ ¿ä¼Ò¸¦ ºĞ»ê½ÃÄÑ °ø°İÀÚ°¡ ¿©·¯ ½Ã½ºÅÛ ¸®¼Ò½º¸¦ È®º¸ÇÏ¿© Á¤È®ÇÏ°Ô Á¶ÇÕÇØ¾ß¸¸ ¾ÏÈ£¸¦ ÇØµ¶ÇÒ ¼ö ÀÖ°Ô ¸¸µå´Â °ÍÀÔ´Ï´Ù. ÃÖ¼ÒÇÑ ¾ÏÈ£¸¦ ÀúÀåÇÏ±â Àü¿¡ ÇØ½ÃÇØ¾ß ÇÕ´Ï´Ù.

ÀÏºÎ Å¸»ç Á¦Ç°Àº ¾ÏÈ£¸¦ ¾ÈÀüÇÏ°Ô °ü¸®ÇÒ ¼ö ÀÖ´Ù°í ÁÖÀåÇÕ´Ï´Ù. ¿¹¸¦ µé¸é, WebSphere Application Server 4.x´Â °£´ÜÇÑ XOR ¾ÏÈ£È­ ¾Ë°í¸®ÁòÀ» »ç¿ëÇÏ¿© °ªÀ» ³­µ¶ Ã³¸®ÇÏÁö¸¸ ±× ±â´ÉÀ» ½Å·ÚÇÏ±â ¾î·Æ½À´Ï´Ù. WebSphere ¹× ±âÅ¸ ÀÀ¿ë ÇÁ·Î±×·¥ ¼­¹ö´Â º¸¾È¿¡ ¹Î°¨ÇÑ È¯°æ¿¡´Â ºÒÃæºĞÇÑ ¿À·¡µÇ°í ºñ±³Àû ¾àÇÑ ¾ÏÈ£È­ ¸ŞÄ¿´ÏÁòÀ» Á¦°øÇÕ´Ï´Ù. ÇöÀç ÀÏ¹İ º¸¾È ¼Ö·ç¼Ç¿¡ ´ëÇÑ ÃÖ¼±ÀÇ ¹æ¹ıÀº Á÷Á¢ µ¶Á¡ ¸ŞÄ¿´ÏÁòÀ» »ı¼ºÇÏ´Â °ÍÀÔ´Ï´Ù.

AndroidÀÇ °æ¿ì SQLite µ¥ÀÌÅÍº£ÀÌ½º¸¦ »ç¿ëÇÏ´Â ´Ù¸¥ ÇÃ·§Æû°ú ¸¶Âù°¡Áö·Î SQLCipher¸¦ ´ë½Å »ç¿ëÇÏ´Â °ÍÀÌ ÁÁ½À´Ï´Ù. SQLCipher´Â SQLite µ¥ÀÌÅÍº£ÀÌ½º¿¡ ´ëÇÑ È®ÀåÀ¸·Î, µ¥ÀÌÅÍº£ÀÌ½º ÆÄÀÏÀÇ Åõ¸íÇÑ 256ºñÆ® AES ¾ÏÈ£È­¸¦ Á¦°øÇÕ´Ï´Ù. µû¶ó¼­ ¾ÏÈ£È­µÈ µ¥ÀÌÅÍº£ÀÌ½º¿¡ ÀÚ°İ Áõ¸íÀ» ÀúÀåÇÒ ¼ö ÀÖ½À´Ï´Ù.

¿¹Á¦ 3: ´ÙÀ½ ÄÚµå´Â ÇÊ¿äÇÑ ¹ÙÀÌ³Ê¸®¸¦ ´Ù¿î·ÎµåÇÑ ÈÄ SQLCipher¸¦ Android ÀÀ¿ë ÇÁ·Î±×·¥¿¡ ÅëÇÕÇÏ°í ÀÚ°İ Áõ¸íÀ» µ¥ÀÌÅÍº£ÀÌ½º ÆÄÀÏ¿¡ ÀúÀåÇÏ´Â ¹æ¹ıÀ» º¸¿©Áİ´Ï´Ù.

import net.sqlcipher.database.SQLiteDatabase;
...
  SQLiteDatabase.loadLibs(this);
  File dbFile = getDatabasePath("credentials.db");
  dbFile.mkdirs();
  dbFile.delete();
  SQLiteDatabase db = SQLiteDatabase.openOrCreateDatabase(dbFile, "credentials", null);
  db.execSQL("create table credentials(u, p)");
  db.execSQL("insert into credentials(u, p) values(?, ?)", new Object[]{username, password});
...


android.database.sqlite.SQLiteDatabase °ü·Ã ÂüÁ¶´Â net.sqlcipher.database.SQLiteDatabase °ü·Ã ÂüÁ¶·Î ´ëÃ¼µË´Ï´Ù.

WebView ÀúÀå¼Ò¿¡¼­ ¾ÏÈ£È­¸¦ È°¼ºÈ­ÇÏ·Á¸é sqlcipher.so ¶óÀÌºê·¯¸®¸¦ »ç¿ëÇÏ¿© WebKit¸¦ ´Ù½Ã ÄÄÆÄÀÏÇØ¾ß ÇÕ´Ï´Ù.,1. Fortify Secure Coding Rulepacks´Â ¾ÏÈ£¸¦ ÀÎ¼ö·Î »ç¿ëÇÏ´Â °ÍÀ¸·Î ¾Ë·ÁÁø ÇÔ¼ö¸¦ Ã£¾Æ ¾ÏÈ£ °ü¸® ÀÌ½´¸¦ ½Äº°ÇÕ´Ï´Ù. ¾ÏÈ£°¡ ÇÁ·Î±×·¥ ¿ÜºÎ¿¡¼­ Á¦°øµÇ¸ç ½Äº°µÈ ³­µ¶ Ã³¸® ÇØÁ¦ ·çÆ¾À» Åë°úÇÏÁö ¾Ê°í »ç¿ëµÇ´Â °æ¿ì Fortify Static Code Analyzer´Â ¾ÏÈ£ °ü¸® ÀÌ½´ ÇÃ·¡±×¸¦ ÁöÁ¤ÇÕ´Ï´Ù.

Password Management ÀÌ½´¸¦ °¨»çÇÏ·Á¸é ¾ÏÈ£°¡ ½Ã½ºÅÛ¿¡ ÀÔ·ÂµÇ´Â ÁöÁ¡ºÎÅÍ ¾ÏÈ£¸¦ »ç¿ëÇÏ´Â ÁöÁ¡±îÁö ÇÁ·Î±×·¥À» ÃßÀûÇÕ´Ï´Ù. ³­µ¶ Ã³¸® ÇØÁ¦¸¦ ¼öÇàÇÏ´Â ÄÚµå¸¦ Ã£½À´Ï´Ù. ³­µ¶ Ã³¸® ÇØÁ¦ ÄÚµå°¡ ¾øÀ¸¸é ÀÌ ÀÌ½´´Â ÇØ°áµÇÁö ¾ÊÀº °ÍÀÔ´Ï´Ù. ¾ÏÈ£°¡ ³­µ¶ Ã³¸® ÇØÁ¦ ÇÔ¼ö¸¦ Åë°úÇÏ´Â °æ¿ì ¾ÏÈ£¸¦ º¸È£ÇÏ´Â µ¥ »ç¿ëÇÏ´Â ¾Ë°í¸®ÁòÀÌ °ß°íÇÑÁö È®ÀÎÇÕ´Ï´Ù.

¾ÏÈ£°¡ Á¦´ë·Î º¸È£µÈ´Ù°í È®½ÅÇÏ¸é ¾ÏÈ£°¡ ³­µ¶ Ã³¸®·Î º¸È£µÇ°í ÀÖÀ½À» ³ªÅ¸³»´Â ³­µ¶ Ã³¸® ÇØÁ¦ ·çÆ¾¿¡ ´ëÇÑ »ç¿ëÀÚ ÁöÁ¤ Åë°ú ±ÔÄ¢(pass-through rule)À» ÀÛ¼ºÇÕ´Ï´Ù. ÀÌ ±ÔÄ¢À» ÇâÈÄ ÀÀ¿ë ÇÁ·Î±×·¥ ºĞ¼®¿¡ Æ÷ÇÔ½ÃÅ°¸é ½Äº°µÈ ³­µ¶ Ã³¸® ÇØÁ¦ ·çÆ¾À» Åë°úÇÑ ¾ÏÈ£´Â ´õ ÀÌ»ó Password Management Ãë¾àÁ¡À» ÀÏÀ¸Å°Áö ¾Ê½À´Ï´Ù.

2. ¸¹Àº ÃÖ½Å À¥ ÇÁ·¹ÀÓ¿öÅ©´Â »ç¿ëÀÚ ÀÔ·ÂÀÇ °ËÁõÀ» ¼öÇàÇÏ±â À§ÇÑ ¸ŞÄ¿´ÏÁòÀ» Á¦°øÇÕ´Ï´Ù(Struts ¹× Struts 2 Æ÷ÇÔ). È®ÀÎµÇÁö ¾ÊÀº ÀÔ·ÂÀÇ ¼Ò½º¸¦ °­Á¶ÇÏ±â À§ÇØ, Fortify º¸¾È ÄÚµù ±ÔÄ¢ ÆÑÀº ¾Ç¿ë °¡´É¼ºÀ» ³·Ãß°í ÇÁ·¹ÀÓ¿öÅ© °ËÁõ ¸ŞÄ¿´ÏÁòÀÌ »ç¿ë ÁßÀÏ ¶§¸¶´Ù Áö¿øÇÏ´Â Áõ°Å¿¡ Æ÷ÀÎÅÍ¸¦ Á¦°øÇÏ¿© Fortify Static Code Analyzer¿¡¼­ º¸°íÇÑ ¹®Á¦ÀÇ ¿ì¼± ¼øÀ§¸¦ µ¿ÀûÀ¸·Î ÀçÁöÁ¤ÇÕ´Ï´Ù. ÀÌ ±â´ÉÀ» Context-Sensitive Ranking(ÄÁÅØ½ºÆ® °¨Áö ¼øÀ§)ÀÌ¶ó°í ºÎ¸¨´Ï´Ù. Fortify »ç¿ëÀÚÀÇ °¨»ç ÇÁ·Î¼¼½º¸¦ Áö¿øÇÏ±â À§ÇØ, Fortify Software Security Research GroupÀº ÀÔ·Â ¼Ò½º¿¡ Àû¿ëµÈ °ËÁõ ¸ŞÄ¿´ÏÁò¿¡ µû¶ó ¹®Á¦¸¦ Æú´õ·Î ±×·ìÈ­ÇÏ´Â µ¥ÀÌÅÍ À¯È¿¼º ÇÁ·ÎÁ§Æ® ÅÛÇÃ¸´À» »ç¿ë °¡´ÉÇÏ°Ô ¸¸µì´Ï´Ù.,88F5DB5C1FEF4C0BCA0EDC265177D3F9,E05C0DB1-F798-4A77-9A6A-42ACEBA215E6,,,,2024-02-13,
Low,Low,Errors,Poor Error Handling: Overly Broad Catch,src/adrui/MyContextListener.java,MyContextListener.java,,		String url = sc.getInitParameter("url");
		String user = sc.getInitParameter("user");
		String pass = sc.getInitParameter("pass");
		try{
			Class.forName(driver);//?Š è½½é©±?Š¨ç¨‹åºç±?, é«˜ç‰ˆ?œ¬jdbc?¯ä»¥çœ?», ?›¸?…³?¯?‡ªè¡Œç™¾åº?,javax.servlet.ServletContext.getInitParameter(),src/adrui/MyContextListener.java,MyContextListener.java,,			System.out.println("Connect Succeed!");
		}
		catch(Exception e){
			e.printStackTrace();
		},CatchBlock(),MyContextListener.java ÁÙ 32ÀÇ Catch ºí·ÏÀº ±¤¹üÀ§ÇÑ ¿¹¿Ü »çÇ×À» Ã³¸®ÇÏ±â ¶§¹®¿¡ ÇÁ·Î±×·¥ÀÇ ÀÌ ½ÃÁ¡¿¡¼­ ´Ù·ç¾î¼­´Â ¾È µÇ´Â »óÀÌÇÑ »ç¾ÈÀÌ³ª ¹®Á¦¸¦ Æ÷ÂøÇÒ ¼ö ÀÖ½À´Ï´Ù.,MyContextListener.java ÁÙ 32ÀÇ Catch ºí·ÏÀº ±¤¹üÀ§ÇÑ ¿¹¿Ü »çÇ×À» Ã³¸®ÇÏ±â ¶§¹®¿¡ ÇÁ·Î±×·¥ÀÇ ÀÌ ½ÃÁ¡¿¡¼­ ´Ù·ç¾î¼­´Â ¾È µÇ´Â »óÀÌÇÑ »ç¾ÈÀÌ³ª ¹®Á¦¸¦ Æ÷ÂøÇÒ ¼ö ÀÖ½À´Ï´Ù.,¿©·¯ catch ºí·ÏÀº ¹İº¹ÀûÀÌÁö¸¸ Exception °°Àº ³ôÀº ¼öÁØÀÇ Å¬·¡½º¸¦ catchÇÏ¿© catch ºí·ÏÀ» "¾ĞÃà"ÇÏ¸é Æ¯¼ö Ã³¸®°¡ ÇÊ¿äÇÏ°Å³ª ÇÁ·Î±×·¥ÀÇ ÀÌ ½ÃÁ¡¿¡¼­ catchµÇÁö ¾Ê¾Æ¾ß ÇÏ´Â ¿¹¿Ü »çÇ×À» ¼û±æ ¼ö ÀÖ½À´Ï´Ù. Áö³ªÄ¡°Ô ±¤¹üÀ§ÇÑ ¿¹¿Ü »çÇ×À» catchÇÏ¸é JavaÀÇ Çü½ÄÈ­µÈ ¿¹¿Ü »çÇ×À» »ç¿ëÇÏ´Â ÀÇ¹Ì°¡ »ç¶óÁö°í Æ¯È÷ ÇÁ·Î±×·¥ÀÌ Ä¿Á®¼­ »õ·Î¿î Çü½ÄÀÇ ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÏ±â ½ÃÀÛÇÏ¸é À§ÇèÇØÁú ¼ö ÀÖ½À´Ï´Ù. »õ ¿¹¿Ü Çü½Ä¿¡´Â ÁÖÀÇ¸¦ ±â¿ïÀÌÁö ¾Ê±â ¶§¹®ÀÔ´Ï´Ù.

¿¹Á¦: ´ÙÀ½ ¹ßÃéµÈ ÄÚµå´Â ¼¼ °¡Áö Çü½ÄÀÇ ¿¹¿Ü »çÇ×À» µ¿ÀÏÇÑ ¹æ½ÄÀ¸·Î Ã³¸®ÇÕ´Ï´Ù.


  try {
    doExchange();
  }
  catch (IOException e) {
    logger.error("doExchange failed", e);
  }
  catch (InvocationTargetException e) {
    logger.error("doExchange failed", e);
  }
  catch (SQLException e) {
    logger.error("doExchange failed", e);
  }


¾ğ¶æ º¸±â¿¡ ´ÙÀ½°ú °°ÀÌ ¿¹¿Ü »çÇ×À» ÇÏ³ªÀÇ catch ºí·ÏÀ¸·Î Ã³¸®ÇÏ´Â °ÍÀÌ ¹Ù¶÷Á÷ÇÑ °ÍÃ³·³ º¸ÀÔ´Ï´Ù.


  try {
    doExchange();
  }
  catch (Exception e) {
    logger.error("doExchange failed", e);
  }


ÇÏÁö¸¸ doExchange()°¡ ¼öÁ¤µÇ¾î ´Ù¸¥ ¹æ½ÄÀ¸·Î Ã³¸®ÇØ¾ß ÇÏ´Â »õ·Î¿î Çü½ÄÀÇ ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÏ¸é ±¤¹üÀ§ÇÑ catch ºí·Ï ¶§¹®¿¡ ÄÄÆÄÀÏ·¯°¡ ¹®Á¦¸¦ ÁöÀûÇÒ ¼ö ¾ø½À´Ï´Ù. »Ó¸¸ ¾Æ´Ï¶ó, »õ catch ºí·ÏÀº ClassCastException ¹× NullPointerException°ú °°ÀÌ RuntimeException¿¡¼­ ÆÄ»ıµÈ ¿¹¿Ü »çÇ×µµ Ã³¸®ÇÏ´Âµ¥ ÀÌ´Â ÇÁ·Î±×·¡¸ÓÀÇ ÀÇµµ¿Í ¹İ´ëµÇ´Â °ÍÀÔ´Ï´Ù.,¾ÆÁÖ ³ôÀº ¼öÁØÀÇ ÇÁ·Î±×·¥ÀÌ³ª ½º·¹µå¸¦ Á¦¿ÜÇÏ°í´Â Exception, Throwable, Error ¶Ç´Â RuntimeException °°Àº ±¤¹üÀ§ÇÑ ¿¹¿Ü Å¬·¡½º¸¦ catchÇÏÁö ¸¶½Ê½Ã¿À.,1. Fortify Secure Coding Rulepacks´Â ÇØ´ç catch ºí·ÏÀÌ Áï½Ã »õ ¿¹¿Ü »çÇ×À» ¹ß»ı½ÃÅ°¸é overly broad catch ºí·Ï¿¡ ÇÃ·¡±×¸¦ ÁöÁ¤ÇÏÁö ¾Ê½À´Ï´Ù.,C6BA8172A73EC89C2162EBDC5635A3D0,85E603E0-2933-4F38-851F-341604F75CB9,,,,2024-02-13,
Low,Low,Encapsulation,Trust Boundary Violation,src/adrui/LoginModel.java,LoginModel.java,,	public String check(Connection conn, String user, String pass) throws SQLException{
		state = conn.createStatement();
		rs = state.executeQuery(sql);
		while(rs.next()){
			if(rs.getString(2).equals(user)){,java.sql.Statement.executeQuery(),src/adrui/LoginServlet.java,LoginServlet.java,,		try{
			String res = obj.check(conn, user, pass);
			request.setAttribute("res", res);
		//	request.setAttribute("Sno", sno);
			RequestDispatcher view = request.getRequestDispatcher("login.jsp");,javax.servlet.ServletRequest.setAttribute(),LoginServlet.javaÀÇ doPost() ¸Ş¼­µå´Â °°Àº µ¥ÀÌÅÍ ±¸Á¶Ã¼¿¡ ½Å·ÚÇÒ ¼ö ÀÖ´Â µ¥ÀÌÅÍ¿Í ½Å·ÚÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍ¸¦ È¥ÇÕÇÕ´Ï´Ù. ÇÁ·Î±×·¡¸Ó°¡ ½Ç¼ö·Î È®ÀÎµÇÁö ¾ÊÀº µ¥ÀÌÅÍ¸¦ ½Å·ÚÇÏ´Â ÀÏÀÌ ¹ß»ıÇÕ´Ï´Ù.,LoginServlet.javaÀÇ doPost() ¸Ş¼­µå´Â °°Àº µ¥ÀÌÅÍ ±¸Á¶Ã¼¿¡ ½Å·ÚÇÒ ¼ö ÀÖ´Â µ¥ÀÌÅÍ¿Í ½Å·ÚÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍ¸¦ È¥ÇÕÇÕ´Ï´Ù. ÇÁ·Î±×·¡¸Ó°¡ ½Ç¼ö·Î È®ÀÎµÇÁö ¾ÊÀº µ¥ÀÌÅÍ¸¦ ½Å·ÚÇÏ´Â ÀÏÀÌ ¹ß»ıÇÕ´Ï´Ù.,½Å·ÚÀÇ °æ°è´Â ÇÁ·Î±×·¥À¸·Î ±×¾î ³õÀº ¼±À¸·Î »ı°¢ÇÒ ¼ö ÀÖ½À´Ï´Ù. ¼±ÀÇ ÀÌÂÊ¿¡¼­´Â µ¥ÀÌÅÍ¸¦ ½Å·ÚÇÏÁö ¾Ê½À´Ï´Ù. ¼±ÀÇ ¹İ´ëÆí¿¡¼­´Â µ¥ÀÌÅÍ¸¦ ½Å·ÚÇÒ ¼ö ÀÖ´Ù°í °£ÁÖÇÕ´Ï´Ù. °ËÁõ ·ÎÁ÷À» »ç¿ëÇÏ´Â ¸ñÀûÀº µ¥ÀÌÅÍ°¡ ½Å·ÚÀÇ °æ°è¸¦ ¾ÈÀüÇÏ°Ô °Ç³Ê´Â °Í Áï, ½Å·ÚÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍ¿¡¼­ ½Å·ÚÇÒ ¼ö ÀÖ´Â µ¥ÀÌÅÍ·Î ÀÌµ¿ÇÏ´Â °ÍÀ» Çã¿ëÇÏ±â À§ÇØ¼­ÀÔ´Ï´Ù.

Trust boundary violationÀº ½Å·ÚÇÒ ¼ö ÀÖ´Â °Í°ú ½Å·ÚÇÒ ¼ö ¾ø´Â °Í »çÀÌÀÇ °æ°è¸¦ ÇÁ·Î±×·¥ÀÌ Èå¸± ¶§ ¹ß»ıÇÕ´Ï´Ù. ÀÌ·± ½Ç¼ö¸¦ ¹üÇÏ´Â °¡Àå ÈçÇÑ ¹æ½ÄÀº ½Å·ÚÇÒ ¼ö ÀÖ´Â µ¥ÀÌÅÍ¿Í ½Å·ÚÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍ¸¦ °°Àº µ¥ÀÌÅÍ ±¸Á¶Ã¼¿¡ È¥ÇÕÇÏ´Â °ÍÀÔ´Ï´Ù. 



¿¹Á¦: ´ÙÀ½ Java ÄÚµå´Â HTTP ¿äÃ»À» ¹Ş¾Æ »ç¿ëÀÚ°¡ ÀÎÁõµÇ¾ú´ÂÁö È®ÀÎÇÏ±â Àü¿¡ usrname ¸Å°³ º¯¼ö¸¦ HTTP ¼¼¼Ç °³Ã¼¿¡ ÀúÀåÇÕ´Ï´Ù.


usrname = request.getParameter("usrname");
if (session.getAttribute(ATTR_USR) != null) {
    session.setAttribute(ATTR_USR, usrname);
}


Àß ¼³°èµÇ°í À¯Áö °ü¸®µÇ´Â ½Å·Ú °æ°è°¡ ¾øÀ¸¸é ÇÁ·Î±×·¡¸Ó´Â ¾î¶² µ¥ÀÌÅÍ°¡ È®ÀÎ ÀÛ¾÷À» °ÅÄ¡°í °ÅÄ¡Áö ¾Ê¾Ò´ÂÁö¿¡ ´ëÇÑ ÃßÀûÀ» ³õÄ¥ ¼ö¹Û¿¡ ¾ø½À´Ï´Ù. ÀÌ·± È¥¶õÀº °á±¹ ÀÏºÎ µ¥ÀÌÅÍ¸¦ È®ÀÎÇÏÁö ¾Ê°í »ç¿ëÇÏ´Â ½Ç¼ö·Î ÀÌ¾îÁı´Ï´Ù.,ÀÀ¿ë ÇÁ·Î±×·¥¿¡ ºĞ¸íÇÑ ½Å·Ú °æ°è¸¦ Á¤ÀÇÇÏ½Ê½Ã¿À. °°Àº µ¥ÀÌÅÍ ±¸Á¶Ã¼¸¦ »ç¿ëÇÏ¿© ½Å·ÚÇÒ ¼ö ÀÖ´Â µ¥ÀÌÅÍ¸¦ ÇÑ ÄÁÅØ½ºÆ®¿¡, ½Å·ÚÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍ¸¦ ´Ù¸¥ ÄÁÅØ½ºÆ®¿¡ º¸°üÇØ¼­´Â ¾È µË´Ï´Ù. µ¥ÀÌÅÍ°¡ ½Å·ÚÀÇ °æ°è¸¦ ÀÌµ¿ÇÒ ¼ö ÀÖ´Â ¹æ¹ıÀÇ ¼ö¸¦ ÃÖ¼ÒÈ­ÇÕ´Ï´Ù.

Trust boundary violationÀº Ã³¸®ÇÏ±â Àü¿¡ ÀÏ·ÃÀÇ »ç¿ëÀÚ »óÈ£ ÀÛ¿ëÀ» °ÅÃÄ ÀÔ·ÂÀ» »ı¼ºÇØ¾ß ÇÏ´Â °æ¿ì¿¡ ¹ß»ıÇÕ´Ï´Ù. ¸ğµç µ¥ÀÌÅÍ°¡ µµÂøÇÒ ¶§±îÁö´Â ÀÔ·Â°ª °ËÁõÀ» ¿Ï·áÇÒ ¼ö ¾ø½À´Ï´Ù. ÀÌ·± °æ¿ì, ½Å·Ú °æ°è¸¦ À¯ÁöÇÏ´Â °ÍÀÌ Áß¿äÇÕ´Ï´Ù. ½Å·ÚÇÒ ¼ö ¾ø´Â ´ÜÀÏ µ¥ÀÌÅÍ ±¸Á¶Ã¼¿¡ ½Å·ÚÇÒ ¼ö ¾ø´Â µ¥ÀÌÅÍ¸¦ º¸°üÇÏ¿© È®ÀÎÇÑ ´ÙÀ½ ½Å·ÚÇÒ ¼ö ÀÖ´Â À§Ä¡·Î ÀÌµ¿ÇØ¾ß ÇÕ´Ï´Ù.,1. È®ÀÎµÇÁö ¾ÊÀº µ¥ÀÌÅÍ¸¦ ½Å·ÚÇÒ ¼ö ÀÖ´Â °ÍÀ¸·Î °¡Á¤ÇÏ´Â "Áõ°Å°¡ ¸í¹éÇÑ" »óÈ²À» Ã£À» ÇÊ¿ä°¡ ¾ø½À´Ï´Ù. ½Å·Ú °æ°è¸¦ ºĞ¸íÇÏ°Ô ±ß°í ÁöÅ°Áö ¾ÊÀ¸¸é °ËÁõ ¿À·ù¸¦ ÇÇÇÒ ¼ö ¾ø½À´Ï´Ù. ÀÍ½ºÇÃ·ÎÀÌÆ® ½Ã³ª¸®¿À¸¦ °Ë»öÇÏ´Â µ¥ ½Ã°£À» ÇãºñÇÏ±âº¸´Ù ÇÁ·Î±×·¡¸Ó¿¡°Ô ¸íÈ®ÇÑ ½Å·Ú °æ°è¸¦ ÀÛ¼ºÇÏµµ·Ï °¡¸£Ä¡´Â µ¥ ÁıÁßÇØ¾ß ÇÕ´Ï´Ù.

2. ´ëºÎºĞÀÇ ÇÁ·Î±×·¥¿¡´Â ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ ÀÇ¹Ì·Î Á¤ÀÇµÇ´Â ½Å·Ú °æ°è°¡ ÀÖ½À´Ï´Ù. »ç¿ëÀÚ ÀÔ·ÂÀÌ ½Å·Ú °æ°è¸¦ ³Ñ´Â ´Ù¸¥ °æ¿ì¸¦ °Ë»çÇÏ±â À§ÇØ »ç¿ëÀÚ ÁöÁ¤ ±ÔÄ¢À» ÀÛ¼ºÇÏ´Â °Íµµ °í·ÁÇØ¾ß ÇÕ´Ï´Ù.

3. ¸¹Àº ÃÖ½Å À¥ ÇÁ·¹ÀÓ¿öÅ©´Â »ç¿ëÀÚ ÀÔ·ÂÀÇ °ËÁõÀ» ¼öÇàÇÏ±â À§ÇÑ ¸ŞÄ¿´ÏÁòÀ» Á¦°øÇÕ´Ï´Ù(Struts ¹× Spring MVC Æ÷ÇÔ). È®ÀÎµÇÁö ¾ÊÀº ÀÔ·ÂÀÇ ¼Ò½º¸¦ °­Á¶ÇÏ±â À§ÇØ, Fortify º¸¾È ÄÚµù ±ÔÄ¢ ÆÑÀº ¾Ç¿ë °¡´É¼ºÀ» ³·Ãß°í ÇÁ·¹ÀÓ¿öÅ© °ËÁõ ¸ŞÄ¿´ÏÁòÀÌ »ç¿ë ÁßÀÏ ¶§¸¶´Ù Áö¿øÇÏ´Â Áõ°Å¿¡ Æ÷ÀÎÅÍ¸¦ Á¦°øÇÏ¿© Fortify Static Code Analyzer¿¡¼­ º¸°íÇÑ ¹®Á¦ÀÇ ¿ì¼± ¼øÀ§¸¦ µ¿ÀûÀ¸·Î ÀçÁöÁ¤ÇÕ´Ï´Ù. ÀÌ ±â´ÉÀ» Context-Sensitive Ranking(ÄÁÅØ½ºÆ® °¨Áö ¼øÀ§)ÀÌ¶ó°í ºÎ¸¨´Ï´Ù. Fortify »ç¿ëÀÚÀÇ °¨»ç ÇÁ·Î¼¼½º¸¦ Áö¿øÇÏ±â À§ÇØ, Fortify Software Security Research GroupÀº ÀÔ·Â ¼Ò½º¿¡ Àû¿ëµÈ °ËÁõ ¸ŞÄ¿´ÏÁò¿¡ µû¶ó ¹®Á¦¸¦ Æú´õ·Î ±×·ìÈ­ÇÏ´Â µ¥ÀÌÅÍ À¯È¿¼º ÇÁ·ÎÁ§Æ® ÅÛÇÃ¸´À» »ç¿ë °¡´ÉÇÏ°Ô ¸¸µì´Ï´Ù.,EC5C8978193E476E43268D652AE9A30E,CBDB6290-DF73-42E1-8D9E-3B5C4B629761,,,,2024-02-13,
High,High,Code Quality,Unreleased Resource: Database,src/adrui/LoginModel.java,LoginModel.java,,	public String check(Connection conn, String user, String pass) throws SQLException{
		state = conn.createStatement();
		rs = state.executeQuery(sql);
		while(rs.next()){
			if(rs.getString(2).equals(user)){,java.sql.Statement.executeQuery(),src/adrui/MyContextListener.java,MyContextListener.java,,		try{
			Class.forName(driver);//?Š è½½é©±?Š¨ç¨‹åºç±?, é«˜ç‰ˆ?œ¬jdbc?¯ä»¥çœ?», ?›¸?…³?¯?‡ªè¡Œç™¾åº?
			Connection conn = DriverManager.getConnection(url, user, pass);
			sc.setAttribute("conn", conn);
			System.out.println("Connect Succeed!");,conn = getConnection(...),MyContextListener.javaÀÇ contextInitialized() ÇÔ¼ö´Â 28 ÁÙÀÇ getConnection()¿¡ ÀÇÇØ ÇÒ´çµÈ µ¥ÀÌÅÍº£ÀÌ½º ¸®¼Ò½º¸¦ ÇØÁ¦ÇÏÁö ¸øÇÒ ¼öµµ ÀÖ½À´Ï´Ù.,MyContextListener.javaÀÇ contextInitialized() ÇÔ¼ö´Â 28 ÁÙÀÇ getConnection()¿¡ ÀÇÇØ ÇÒ´çµÈ µ¥ÀÌÅÍº£ÀÌ½º ¸®¼Ò½º¸¦ ÇØÁ¦ÇÏÁö ¸øÇÒ ¼öµµ ÀÖ½À´Ï´Ù.,¸®¼Ò½º ´©ÃâÀº ÃÖ¼ÒÇÑ µÎ °¡Áö °øÅë ¿øÀÎÀÌ ÀÖ½À´Ï´Ù.

- ¿À·ù Á¶°Ç ¹× ±âÅ¸ ¿¹¿Ü »óÈ².

- ÇÁ·Î±×·¥ÀÇ ¾î¶² ºÎºĞÀÌ ¸®¼Ò½º ÇØÁ¦¸¦ ´ã´çÇÏ°í ÀÖ´ÂÁö¿¡ ´ëÇÑ È¥¶õ

´ëºÎºĞÀÇ °ø°³µÇÁö ¾ÊÀº ¸®¼Ò½º ¹®Á¦´Â ÀÏ¹İÀûÀÎ ¼ÒÇÁÆ®¿ş¾î ¾ÈÁ¤¼º ¹®Á¦¸¦ ÀÏÀ¸Åµ´Ï´Ù. ÇÏÁö¸¸ °ø°İÀÚ°¡ ÀÇµµÀûÀ¸·Î ¸®¼Ò½º ´©ÃâÀ» ÀÏÀ¸Å³ ¼ö ÀÖ´Â °æ¿ì °ø°İÀÚ°¡ ¸®¼Ò½º Ç®À» °í°¥½ÃÄÑ DoS(Denial of Service) °ø°İÀ» ½ÇÇàÇÒ ¼öµµ ÀÖ½À´Ï´Ù.

¿¹Á¦: ÀÏ¹İÀûÀÎ Á¶°Ç¿¡¼­ ´ÙÀ½ ÄÚµå´Â µ¥ÀÌÅÍº£ÀÌ½º Äõ¸®¸¦ ½ÇÇàÇÏ°í µ¥ÀÌÅÍº£ÀÌ½º°¡ ¹İÈ¯ÇÑ °á°ú¸¦ Ã³¸®ÇÑ ´ÙÀ½ ÇÒ´çµÈ statement °³Ã¼¸¦ ´İ½À´Ï´Ù. ÇÏÁö¸¸ SQLÀ» ½ÇÇàÇÏ°Å³ª °á°ú¸¦ Ã³¸®ÇÏ´Â µ¿¾È ¿¹¿Ü »çÇ×ÀÌ ¹ß»ıÇÏ¸é statement °³Ã¼´Â ´İÈ÷Áö ¾Ê½À´Ï´Ù. ÀÌ·± ÀÏÀÌ ÀÚÁÖ ¹ß»ıÇÏ¸é µ¥ÀÌÅÍº£ÀÌ½º¿¡ »ç¿ë °¡´ÉÇÑ Ä¿¼­°¡ ºÎÁ·ÇÏ°Ô µÇ¾î SQL Äõ¸®¸¦ ´õ ÀÌ»ó ½ÇÇàÇÒ ¼ö ¾ø½À´Ï´Ù.

  Statement stmt = conn.createStatement();
  ResultSet rs = stmt.executeQuery(CXN_SQL);
  harvestResults(rs);
  stmt.close();

,1. ¸®¼Ò½º¸¦ ´Ù½Ã È®º¸ÇÏ´Â µ¥ finalize()¸¦ »ç¿ëÇÏÁö ¸¶½Ê½Ã¿À. °³Ã¼ÀÇ finalize() ¸Ş¼­µå¸¦ È£ÃâÇÏ·Á¸é °¡ºñÁö ¼öÁı±â(garbage collector)´Â °³Ã¼°¡ °¡ºñÁö ¼öÁı ´ë»óÀÎÁö ÆÇ´ÜÇØ¾ß ÇÕ´Ï´Ù. °¡ºñÁö ¼öÁı±â(garbage collector)´Â JVMÀÌ ¸Ş¸ğ¸®°¡ ºÎÁ·ÇÑ °æ¿ì¸¦ Á¦¿ÜÇÏ°í´Â ½ÇÇàÇÒ ÇÊ¿ä°¡ ¾ø±â ¶§¹®¿¡ finalize() ¸Ş¼­µå°¡ ÇÊ¿äÇÒ ¶§ ¿øÇÏ´Â ´ë·Î È£ÃâµÈ´Ù´Â º¸ÀåÀÌ ¾ø½À´Ï´Ù. ¶ÇÇÑ °á±¹ °¡ºñÁö ¼öÁı±â(garbage collector)°¡ ½ÇÇàµÇ´õ¶óµµ ÂªÀº ½Ã°£¿¡ ¹æ´ëÇÑ ¸®¼Ò½º¸¦ ´Ù½Ã È®º¸ÇÏ±â ¶§¹®¿¡ ¼º´ÉÀÌ "°í¸£Áö ¸øÇÏ°í" Àü¹İÀûÀÎ ½Ã½ºÅÛ Ã³¸®·®ÀÌ ³·¾ÆÁú ¼ö ÀÖ½À´Ï´Ù. ÀÌ·± È¿°ú´Â ½Ã½ºÅÛÀÇ ºÎÇÏ°¡ Áõ°¡ÇÒ¼ö·Ï ´õ¿í µÎµå·¯Áı´Ï´Ù.

¸¶Áö¸·À¸·Î ¸®¼Ò½º È®º¸ ÀÛ¾÷ÀÌ ÀÀ´äÇÏÁö ¾Êµµ·Ï ÇÒ ¼ö ÀÖÀ¸¸é(¿¹: ³×Æ®¿öÅ©·Î µ¥ÀÌÅÍº£ÀÌ½º¿Í Åë½ÅÇØ¾ß ÇÏ´Â °æ¿ì), finalize() ¸Ş¼­µå¸¦ ½ÇÇàÇÏ°í ÀÖ´Â ½º·¹µåµµ ÀÀ´äÇÏÁö ¾Ê½À´Ï´Ù.

2. finally ºí·ÏÀÇ ¸®¼Ò½º¸¦ ÇØÁ¦ÇÏ½Ê½Ã¿À. ¿¹Á¦ ÄÚµå´Â ´ÙÀ½°ú °°ÀÌ ´Ù½Ã ÀÛ¼ºÇØ¾ß ÇÕ´Ï´Ù.


  public void execCxnSql(Connection conn) {
    Statement stmt;
    try {
      stmt = conn.createStatement();
      ResultSet rs = stmt.executeQuery(CXN_SQL);
      ...
    }
    finally {
      if (stmt != null) {
        safeClose(stmt);
      }
    }
}

public static void safeClose(Statement stmt) {
  if (stmt != null) {
    try {
      stmt.close();
    } catch (SQLException e) {
      log(e);
    }
  }
}


ÀÌ ÇØ°áÃ¥Àº µµ¿ì¹Ì ÇÔ¼ö¸¦ »ç¿ëÇÏ¿© statement¸¦ ´İÀ¸·Á ÇÒ ¶§ ¹ß»ıÇÒ ¼ö ÀÖ´Â ¿¹¿Ü¸¦ ±â·ÏÇÕ´Ï´Ù. µµ¿ì¹Ì ÇÔ¼ö´Â statement¸¦ ´İÀ» ¶§¸¶´Ù Àç»ç¿ëµÉ °ÍÀÔ´Ï´Ù.

¶ÇÇÑ execCxnSql ¸Ş¼­µå´Â stmt °³Ã¼¸¦ null·Î ÃÊ±âÈ­ÇÏÁö ¾Ê½À´Ï´Ù. ´ë½Å safeClose()¸¦ È£ÃâÇÏ±â Àü¿¡ stmt°¡ nullÀÌ ¾Æ´ÑÁö °Ë»çÇÕ´Ï´Ù. null °Ë»ç¸¦ ÇÏÁö ¾ÊÀ¸¸é Java ÄÄÆÄÀÏ·¯´Â stmt°¡ ÃÊ±âÈ­µÇÁö ¾Ê¾Ò´Ù°í º¸°íÇÕ´Ï´Ù. ÀÌ ¹æ¹ıÀº uninitialized variableÀ» ¹ß°ßÇÏ´Â Java ±â´ÉÀ» ÀÌ¿ëÇÑ °ÍÀÔ´Ï´Ù. stmt¸¦ ´õ º¹ÀâÇÑ ¹æ¹ıÀ» »ç¿ëÇÏ¿© null·Î ÃÊ±âÈ­ÇÏ¸é ÃÊ±âÈ­ÇÏÁö ¾Ê°í stmt¸¦ »ç¿ëÇÏ´Â °æ¿ì¸¦ ÄÄÆÄÀÏ·¯°¡ ¹ß°ßÇÒ ¼ö ¾ø½À´Ï´Ù.,1. µ¥ÀÌÅÍº£ÀÌ½º ¿¬°áÀ» ´İÀ¸¸é ¿¬°á °³Ã¼¿Í ¿¬°üµÈ ´Ù¸¥ ¸®¼Ò½º°¡ ÀÚµ¿À¸·Î ÇØÁ¦µÉ ¼öµµ ÀÖ°í ±×·¸Áö ¾ÊÀ» ¼öµµ ÀÖ½À´Ï´Ù. ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ¿¬°á Ç®¸µÀ» »ç¿ëÇÏ´Â °æ¿ì¿¡´Â ¿¬°áÀ» ´İÀº ÈÄ¿¡ ´Ù¸¥ ¸®¼Ò½º¸¦ ¸í½ÃÀûÀ¸·Î ´İ´Â °ÍÀÌ ÁÁ½À´Ï´Ù. ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ¿¬°á Ç®¸µÀ» »ç¿ëÇÏÁö ¾ÊÀ» °æ¿ì¿¡´Â µ¥ÀÌÅÍº£ÀÌ½º ¿¬°áÀ» ´İÀ¸¸é ´Ù¸¥ ¸®¼Ò½ºµµ ÀÚµ¿À¸·Î ´İÈü´Ï´Ù. ÀÌ·¯ÇÑ °æ¿ì, ÀÌ Ãë¾àÁ¡Àº À¯È¿ÇÏÁö ¾Ê½À´Ï´Ù.,92023524C89EC71DA935E356D0E8C099,B7DFF4A8-9817-4418-A35B-E70D10DC825E,,,,2024-02-13,
Low,Low,Input Validation and Representation,Unsafe Reflection,src/adrui/MyContextListener.java,MyContextListener.java,,		// TODO Auto-generated method stub
		ServletContext sc = event.getServletContext();
		String driver = sc.getInitParameter("driver");
		String url = sc.getInitParameter("url");
		String user = sc.getInitParameter("user");,javax.servlet.ServletContext.getInitParameter(),src/adrui/MyContextListener.java,MyContextListener.java,,		String pass = sc.getInitParameter("pass");
		try{
			Class.forName(driver);//?Š è½½é©±?Š¨ç¨‹åºç±?, é«˜ç‰ˆ?œ¬jdbc?¯ä»¥çœ?», ?›¸?…³?¯?‡ªè¡Œç™¾åº?
			Connection conn = DriverManager.getConnection(url, user, pass);
			sc.setAttribute("conn", conn);,java.lang.Class.forName(),°ø°İÀÚ°¡ MyContextListener.javaÀÇ 27 ÁÙ¿¡¼­ forName() ¸®ÇÃ·º¼Ç ¸Ş¼­µåÀÇ ÀÎ¼ö¸¦ Á¦¾îÇÒ ¼ö ÀÖ½À´Ï´Ù. ÀÌ·Î ÀÎÇØ ÀÀ¿ë ÇÁ·Î±×·¥À» ÅëÇØ ¿¹±âÄ¡ ¸øÇÑ Á¦¾î Èå¸§ °æ·Î¸¦ ¸¸µé¾î º¸¾È °Ë»ç¸¦ ¹«½ÃÇÒ ¼ö ÀÖ½À´Ï´Ù.,°ø°İÀÚ°¡ MyContextListener.javaÀÇ 27 ÁÙ¿¡¼­ forName() ¸®ÇÃ·º¼Ç ¸Ş¼­µåÀÇ ÀÎ¼ö¸¦ Á¦¾îÇÒ ¼ö ÀÖ½À´Ï´Ù. ÀÌ·Î ÀÎÇØ ÀÀ¿ë ÇÁ·Î±×·¥À» ÅëÇØ ¿¹±âÄ¡ ¸øÇÑ Á¦¾î Èå¸§ °æ·Î¸¦ ¸¸µé¾î º¸¾È °Ë»ç¸¦ ¹«½ÃÇÒ ¼ö ÀÖ½À´Ï´Ù.,°ø°İÀÚ°¡ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ÀÎ½ºÅÏ½ºÈ­ÇÒ Å¬·¡½º ¶Ç´Â È£ÃâÇÒ ¸Ş¼­µå¸¦ °áÁ¤ÇÏ´Â µ¥ »ç¿ëÇÒ °ªÀ» Á¦°øÇÏ°Ô µÇ¸é ÀÀ¿ë ÇÁ·Î±×·¥À» ÅëÇØ ÀÀ¿ë ÇÁ·Î±×·¥ °³¹ßÀÚ°¡ ÀÇµµÇÏÁö ¾ÊÀº Á¦¾î Èå¸§ °æ·Î¸¦ ¸¸µé °¡´É¼ºÀÌ ÀÖ½À´Ï´Ù. ÀÌ °ø°İÀº °ø°İÀÚ°¡ authentication ¶Ç´Â access control °Ë»ç¸¦ ¹«½ÃÇÏ°Å³ª ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ¿ÀÀÛµ¿À» ÀÏÀ¸Å°µµ·Ï ÇÕ´Ï´Ù. ÀÓÀÇÀÇ ¸Ş¼­µå³ª »ı¼ºÀÚ¿¡°Ô Àü´ŞµÇ´Â ÀÎ¼ö¸¦ Á¦¾îÇÏ´Â ±â´Éµµ ±³È°ÇÑ °ø°İÀÚ¿¡°Ô °ø°İÀ» ¼º°ø½ÃÅ°´Â µ¥ ÇÊ¿äÇÑ À¯¸®ÇÑ Á¶°ÇÀ» Á¦°øÇÒ ¼ö ÀÖ½À´Ï´Ù. 

ÀÌ·± »óÈ²Àº °ø°İÀÚ°¡ ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ classpath¿¡ ÀÖ´Â À§Ä¡¿¡ ÆÄÀÏÀ» ¾÷·ÎµåÇÏ°Å³ª ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ classpath¿¡ »õ Ç×¸ñÀ» Ãß°¡ÇÏ°Ô µÇ¸é ÃÖ¾ÇÀÇ ½Ã³ª¸®¿À°¡ µË´Ï´Ù. ¾î´À ÂÊÀÌµç °ø°İÀÚ´Â ¸®ÇÃ·º¼ÇÀ» »ç¿ëÇÏ¿© ÀÀ¿ë ÇÁ·Î±×·¥¿¡ »õ·Î¿î ¾ÇÀÇÀûÀÎ µ¿ÀÛÀ» ÁÖÀÔÇÒ ¼ö ÀÖ½À´Ï´Ù.

¿¹Á¦: ÇÁ·Î±×·¡¸Ó°¡ ¸®ÇÃ·º¼Ç API¸¦ »ç¿ëÇÏ´Â °øÅëµÈ ÀÌÀ¯´Â ÀÚ½Å¸¸ÀÇ ¸í·É µğ½ºÆĞÃ³¸¦ ±¸ÇöÇÏ±â À§ÇØ¼­ÀÔ´Ï´Ù. ´ÙÀ½ ¿¹Á¦´Â ¸®ÇÃ·º¼ÇÀ» »ç¿ëÇÏÁö ¾Ê´Â ¸í·É µğ½ºÆĞÃ³¸¦ º¸¿©Áİ´Ï´Ù.


String ctl = request.getParameter("ctl");
Worker ao = null;
if (ctl.equals("Add")) {
  ao = new AddCommand();
} else if (ctl.equals("Modify")) {
  ao = new ModifyCommand();
} else {
  throw new UnknownActionError();
}
ao.doAction(request);


ÇÁ·Î±×·¡¸Ó°¡ ÀÌ ÄÚµå¸¦ ´ÙÀ½°ú °°ÀÌ ¸®ÇÃ·º¼ÇÀ» »ç¿ëÇÏµµ·Ï ¸®ÆÑÅÍ¸µÇÒ ¼ö ÀÖ½À´Ï´Ù.


    String ctl = request.getParameter("ctl");
    Class cmdClass = Class.forName(ctl + "Command");
    Worker ao = (Worker) cmdClass.newInstance();
    ao.doAction(request);


¸®ÆÑÅÍ¸µÀº Ã³À½¿¡´Â ¸¹Àº ÀåÁ¡ÀÌ ÀÖ´Â °ÍÃ³·³ º¸ÀÔ´Ï´Ù. ÄÚµå ÁÙÀÌ ÁÙ°í if/else ºí·Ï ÀüÃ¼°¡ »ç¶óÁú »Ó ¾Æ´Ï¶ó ÀÌÁ¦´Â ¸í·É µğ½ºÆĞÃ³¸¦ ¼öÁ¤ÇÏÁö ¾Ê°í »õ ¸í·É À¯ÇüÀ» Ãß°¡ÇÏ´Â °Íµµ °¡´ÉÇÕ´Ï´Ù.

ÇÏÁö¸¸ ¸®ÆÑÅÍ¸µÀº °ø°İÀÚ°¡ Worker ÀÎÅÍÆäÀÌ½º¸¦ ±¸ÇöÇÏ´Â °³Ã¼¸¦ ÀÎ½ºÅÏ½ºÈ­ÇÒ ¼ö ÀÖ½À´Ï´Ù. ¸í·É µğ½ºÆĞÃ³°¡ access controlÀ» °è¼Ó ´ã´çÇÏ´Â °æ¿ì, ÇÁ·Î±×·¡¸Ó´Â Worker ÀÎÅÍÆäÀÌ½º¸¦ ±¸ÇöÇÏ´Â »õ Å¬·¡½º¸¦ ¸¸µé ¶§¸¶´Ù µğ½ºÆĞÃ³ÀÇ access control ÄÚµå¸¦ ¼öÁ¤ÇØ¾ß ÇÕ´Ï´Ù. access control ÄÚµå¸¦ ¼öÁ¤ÇÏÁö ¾ÊÀ¸¸é ÀÏºÎ Worker Å¬·¡½º´Â access controlÀ» °®Áö ¸øÇÕ´Ï´Ù.

¾×¼¼½º Á¦¾î ¹®Á¦¸¦ ÇØ°áÇÏ´Â ÇÑ °¡Áö ¹æ¹ıÀº Worker °³Ã¼°¡ ¾×¼¼½º Á¦¾î °Ë»ç ¼öÇàÀ» ´ã´çÇÏ°Ô ¸¸µå´Â °ÍÀÔ´Ï´Ù. ¸®ÆÑÅÍ¸µµÈ ÄÚµåÀÇ ¿¹Á¦´Â ´ÙÀ½°ú °°½À´Ï´Ù.


String ctl = request.getParameter("ctl");
Class cmdClass = Class.forName(ctl + "Command");
Worker ao = (Worker) cmdClass.newInstance();
ao.checkAccessControl(request);
ao.doAction(request);


ÀÌ ÄÚµå´Â º¸´Ù °³¼±µÇ±ä ÇßÁö¸¸ ºĞ»êµÈ ¹æ½ÄÀ¸·Î access controlÀ» ´Ù·ç±â ¶§¹®¿¡ ÇÁ·Î±×·¡¸Ó°¡ access control ½Ç¼ö¸¦ ÀúÁö¸£±â°¡ ´õ ½±½À´Ï´Ù.

¶ÇÇÑ ÀÌ ÄÚµå´Â ¸®ÇÃ·º¼ÇÀ» »ç¿ëÇÏ¿© ¸í·É µğ½ºÆĞÃ³¸¦ ÀÛ¼ºÇÏ´Â µ¥¼­ ¶Ç ´Ù¸¥ º¸¾È ¹®Á¦¸¦ ¾ß±âÇÕ´Ï´Ù. °ø°İÀÚ°¡ ¸ğµç Á¾·ùÀÇ °³Ã¼¿¡ ´ëÇØ ±âº» »ı¼ºÀÚ¸¦ È£ÃâÇÒ ¼ö ÀÖ½À´Ï´Ù. ½ÇÁ¦·Î °ø°İÀÚ´Â Worker ÀÎÅÍÆäÀÌ½º¸¦ ±¸ÇöÇÏ´Â °³Ã¼¿¡¸¸ ±¹ÇÑµÇ¾î ÀÖ´Â °ÍÀº ¾Æ´Õ´Ï´Ù. ½Ã½ºÅÛÀÇ ¸ğµç °³Ã¼ÀÇ ±âº» »ı¼ºÀÚ¸¦ È£ÃâÇÒ ¼ö ÀÖ½À´Ï´Ù. °³Ã¼°¡ Worker ÀÎÅÍÆäÀÌ½º¸¦ ±¸ÇöÇÏÁö ¾Ê´Â °æ¿ì ClassCastExceptionÀÌ ao¿¡ ÇÒ´çµÇ±â Àü¿¡ ¹ß»ıÇÏÁö¸¸ »ı¼ºÀÚ°¡ °ø°İÀÚ¿¡°Ô À¯¸®ÇÑ ÀÛ¾÷À» ¼öÇàÇÏ´Â °æ¿ì ÀÌ¹Ì ÇÇÇØ¸¦ ÀÔÀº °ÍÀÔ´Ï´Ù. ÀÌ ½Ã³ª¸®¿À´Â °£´ÜÇÑ ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­´Â ºñ±³Àû ÇÇÇØ Á¤µµ°¡ ¾àÇÏÁö¸¸ ¾ÆÁÖ º¹ÀâÇÑ Å« ÀÀ¿ë ÇÁ·Î±×·¥¿¡¼­´Â °ø°İÀÚ°¡ ¾ó¸¶µçÁö »ı¼ºÀÚ¸¦ Ã£¾Æ °ø°İ µµ±¸·Î ÀÌ¿ëÇÒ ¼ö ÀÖ½À´Ï´Ù.

Áï°¢ÀûÀÎ È£ÃâÀÚÀÇ Å¬·¡½º ·Î´õ °Ë»ç »ç¿ë ÀÛ¾÷À» ¼öÇàÇÏ´Â Æ¯Á¤ Java API°¡ ¸®ÇÃ·º¼Ç È£Ãâ·Î ÀÎÇØ ¹İÈ¯µÈ ½Å·ÚÇÒ ¼ö ¾ø´Â °³Ã¼¿¡¼­ È£ÃâµÇ´Â °æ¿ì Á¢±Ù °Ë»ç°¡ ÄÚµå ½ÇÇà Ã¼ÀÎÀ» ´õ¿í ¼Õ»ó½ÃÅ³¼öµµ ÀÖ½À´Ï´Ù. ÀÌ·¯ÇÑ Java API´Â ½ÇÇà Ã¼ÀÎÀÇ ¸ğµç È£ÃâÀÚ°¡ ÇÊ¿äÇÑ º¸¾È ±ÇÇÑÀ» °®µµ·Ï º¸ÀåÇÏ´Â SecurityManager °Ë»ç¸¦ ¹«½ÃÇÕ´Ï´Ù. ¸®ÇÃ·º¼Ç¿¡ ÀÇÇØ ¹İÈ¯µÈ ½Å·ÚÇÒ ¼ö ¾ø´Â °³Ã¼¿¡¼­ API°¡ È£ÃâµÇÁö ¾Êµµ·Ï ÁÖÀÇÇØ¾ß ÇÕ´Ï´Ù. ÀÌ·¯ÇÑ API´Â º¸¾È Á¢±Ù °Ë»ç¸¦ ¹«½ÃÇÏ°í ½Ã½ºÅÛÀÌ ¿ø°İ °ø°İ¿¡ Ãë¾àÇØÁöµµ·Ï ÇÒ ¼ö ÀÖ±â ¶§¹®ÀÔ´Ï´Ù. ÀÌ·¯ÇÑ Java API¿¡ ´ëÇÑ ÀÚ¼¼ÇÑ ³»¿ëÀº Secure Coding Guidelines for the Java Programming LanguageÀÇ Guideline 9¸¦ ÂüÁ¶ÇÏ½Ê½Ã¿À.,Unsafe reflectionÀ» ¿¹¹æÇÏ´Â ÃÖ¼±ÀÇ ¹æ¹ıÀº ´ÙÀ½ °£Á¢ ÂüÁ¶¸¦ »ç¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. Áï, »ç¿ëÀÚ°¡ ÁöÁ¤ÇÒ ¼ö ÀÖ´Â ¿Ã¹Ù¸¥ ÀÌ¸§ ¸ñ·ÏÀ» ¸¸µé¾î »ç¿ëÀÚ°¡ ¸ñ·Ï¿¡¼­ ¼±ÅÃÇÏ´Â °Í¸¸ Çã¿ëÇÏ´Â °ÍÀÔ´Ï´Ù. ÀÌ Á¢±Ù ¹æ½Ä¿¡¼­´Â »ç¿ëÀÚ°¡ Á¦°øÇÏ´Â ÀÔ·ÂÀ» ¸®ÇÃ·º¼Ç API¿¡ Àü´ŞµÇ´Â ÀÌ¸§À» ÁöÁ¤ÇÏ´Â µ¥ Á÷Á¢ »ç¿ëÇÏÁö ¾Ê½À´Ï´Ù.

¸®ÇÃ·º¼ÇÀº »ç¿ëÀÚ ÁöÁ¤ µ¥ÀÌÅÍ ±â¹İ ¾ÆÅ°ÅØÃ³¸¦ ¸¸µå´Â µ¥ »ç¿ëÇÒ ¼öµµ ÀÖ½À´Ï´Ù. ÀÌ ¾ÆÅ°ÅØÃ³´Â ±¸¼º ÆÄÀÏÀÌ ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ »ç¿ëÇÏ´Â °³Ã¼ÀÇ Çü½Ä°ú Á¶ÇÕÀ» °áÁ¤ÇÏ´Â ¼ö´ÜÀÌ µË´Ï´Ù. ÀÌ·± ÇÁ·Î±×·¡¹Ö ¹æ½ÄÀº ´ÙÀ½°ú °°Àº º¸¾È ¹®Á¦¸¦ ¾È°í ÀÖ½À´Ï´Ù.

- ÇÁ·Î±×·¥À» Á¦¾îÇÏ´Â ±¸¼º ÆÄÀÏÀº ÇÁ·Î±×·¥ ¼Ò½º ÄÚµåÀÇ ÇÊ¼öÀûÀÎ ºÎºĞÀÌ¹Ç·Î º¸È£ÇÏ°í °ËÅäÇØ¾ß ÇÕ´Ï´Ù.

- ±¸¼º ÆÄÀÏÀÌ ÀÀ¿ë ÇÁ·Î±×·¥¸¶´Ù °íÀ¯ÇÏ±â ¶§¹®¿¡ µğÀÚÀÎÀÇ º¸¾È¼ºÀ» Æò°¡ÇÏ·Á¸é °íÀ¯ÇÑ ÀÛ¾÷À» ¼öÇàÇØ¾ß ÇÕ´Ï´Ù.

- ÀÀ¿ë ÇÁ·Î±×·¥ÀÇ ÀÇ¹Ì¸¦ »ç¿ëÀÚ ÁöÁ¤ Çü½ÄÀÇ ±¸¼º ÆÄÀÏÀÌ Á¤ÀÇÇÏ±â ¶§¹®¿¡ ÃÖÀûÀÇ Á¤Àû ºĞ¼® °á°ú¸¦ ¾òÀ¸·Á¸é »ç¿ëÀÚ ÁöÁ¤ ±ÔÄ¢ÀÌ ÀÖ¾î¾ß ÇÕ´Ï´Ù.

ÀÌ·± ÀÌÀ¯·Î ÆÀ¿¡¼­ º¸¾È Æò°¡¿¡ ¾öÃ»³­ ³ë·ÂÀ» ÅõÀÔÇÒ ¼ö ÀÖ´Â »óÈ²ÀÌ ¾Æ´Ï¸é ÀÌ·± Çü½ÄÀÇ µğÀÚÀÎÀº ÇÇÇÏ´Â °ÍÀÌ ÁÁ½À´Ï´Ù.,1. ¸®ÇÃ·º¼Ç ¸Ş¼­µå È£ÃâÀÇ ÀÏºÎ·Î »ç¿ëÀÚ ÀÔ·ÂÀ» »ç¿ëÇÏ±â Àü¿¡ ¹İµå½Ã È®ÀÎÇØ¾ß ÇÕ´Ï´Ù. ÀÀ¿ë ÇÁ·Î±×·¥ÀÌ ¿î¿µ Ã¼Á¦, file system ¶Ç´Â ±âÅ¸ ½Ã½ºÅÛ ±¸¼º ¿ä¼Òº¸´Ù ºü¸¥ ¼Óµµ·Î ¹ßÀüÇÏ±â ¶§¹®¿¡ »ç¿ëÀÚ ÀÔ·Â°ª °ËÁõ¿¡ ÇÊ¿äÇÑ ÀÛ¾÷Àº »ç¿ëÀÚ µ¥ÀÌÅÍ¸¦ ´Ù¸¥ ½Ã½ºÅÛ ±¸¼º ¿ä¼Ò¿¡ º¸³»´Â µ¥ ÇÊ¿äÇÑ ÀÔ·Â È®ÀÎº¸´Ù ÈÎ¾À ºü¸£°Ô ¹ßÀüÇØ¾ß ÇÕ´Ï´Ù. ÇöÀç´Â °ËÁõÀÌ ¿Ã¹Ù·Î µ¿ÀÛÇÏ´õ¶óµµ ¾ÕÀ¸·Î´Â Á¤È®ÇÏÁö ¾ÊÀ» ¼ö ÀÖ½À´Ï´Ù.

2. ¸¹Àº ÃÖ½Å À¥ ÇÁ·¹ÀÓ¿öÅ©´Â »ç¿ëÀÚ ÀÔ·ÂÀÇ °ËÁõÀ» ¼öÇàÇÏ±â À§ÇÑ ¸ŞÄ¿´ÏÁòÀ» Á¦°øÇÕ´Ï´Ù(Struts ¹× Spring MVC Æ÷ÇÔ). È®ÀÎµÇÁö ¾ÊÀº ÀÔ·ÂÀÇ ¼Ò½º¸¦ °­Á¶ÇÏ±â À§ÇØ, Fortify º¸¾È ÄÚµù ±ÔÄ¢ ÆÑÀº ¾Ç¿ë °¡´É¼ºÀ» ³·Ãß°í ÇÁ·¹ÀÓ¿öÅ© °ËÁõ ¸ŞÄ¿´ÏÁòÀÌ »ç¿ë ÁßÀÏ ¶§¸¶´Ù Áö¿øÇÏ´Â Áõ°Å¿¡ Æ÷ÀÎÅÍ¸¦ Á¦°øÇÏ¿© Fortify Static Code Analyzer¿¡¼­ º¸°íÇÑ ¹®Á¦ÀÇ ¿ì¼± ¼øÀ§¸¦ µ¿ÀûÀ¸·Î ÀçÁöÁ¤ÇÕ´Ï´Ù. ÀÌ ±â´ÉÀ» Context-Sensitive Ranking(ÄÁÅØ½ºÆ® °¨Áö ¼øÀ§)ÀÌ¶ó°í ºÎ¸¨´Ï´Ù. Fortify »ç¿ëÀÚÀÇ °¨»ç ÇÁ·Î¼¼½º¸¦ Áö¿øÇÏ±â À§ÇØ, Fortify Software Security Research GroupÀº ÀÔ·Â ¼Ò½º¿¡ Àû¿ëµÈ °ËÁõ ¸ŞÄ¿´ÏÁò¿¡ µû¶ó ¹®Á¦¸¦ Æú´õ·Î ±×·ìÈ­ÇÏ´Â µ¥ÀÌÅÍ À¯È¿¼º ÇÁ·ÎÁ§Æ® ÅÛÇÃ¸´À» »ç¿ë °¡´ÉÇÏ°Ô ¸¸µì´Ï´Ù.,5BA1400984294C9BF4B7411857C65201,E1B32227-C0BD-4A57-9C34-6794D9089A21,,,,2024-02-13,
